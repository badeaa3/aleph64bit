      SUBROUTINE MBAPOL(NSLOT,ISUBC,LAYER,XX,YY,RHO,THETA,PHI)
C------------------------------------------------------------------
C! muon barrel : convert local XX,YY to polar coordinates
C!
C!   F.Bossi/G.Capon/D.Kuhn             861107
C!
C------------------------------------------------------------------
      SAVE
      PARAMETER (NSUBCO=3,NLAYRS=2,NSLBAR=24,NSLMDA=38,NSLEND=16)
      PARAMETER (NSLBSM=16)
      COMMON/MBG1DA/WIDTHB(NSLBAR),ZWIDTB(NSLBAR),CENDVB(NSLBAR), RINTEB
     +(NSLBAR),INPHIB(NSLBAR),THICKB
      COMMON/MRDDAT/XPITCH,YPITCH,XXOFFS(NSUBCO,NLAYRS), YYOFFS(NSUBCO,
     +NLAYRS),ZZOFFS(NSUBCO,NLAYRS),WDEIMU,WD16MU(NSUBCO),OFTBMU
C! define universal constants
      REAL PI, TWOPI, PIBY2, PIBY3, PIBY4, PIBY6, PIBY8, PIBY12
      REAL RADEG, DEGRA
      REAL CLGHT, ALDEDX
      PARAMETER (PI=3.141592653589)
      PARAMETER (RADEG=180./PI, DEGRA=PI/180.)
      PARAMETER (TWOPI = 2.*PI , PIBY2 = PI/2., PIBY4 = PI/4.)
      PARAMETER (PIBY6 = PI/6. , PIBY8 = PI/8.)
      PARAMETER (PIBY12= PI/12., PIBY3 = PI/3.)
      PARAMETER (CLGHT = 29.9792458, ALDEDX = 0.000307)
C
      XCS=WIDTHB(NSLOT)/2.
      DXCC=XX-XCS+CENDVB(NSLOT)
      RINT=RINTEB(NSLOT)+0.5*THICKB+ZZOFFS(ISUBC,LAYER)
      DFI=ATAN2(DXCC,RINT)
      PHI=PI/6.*FLOAT(INPHIB(NSLOT)-1)
      PHI=PHI+DFI
      RR=RINT/COS(DFI)
      DHEMS=YY-ZWIDTB(NSLOT)/2.
      RHO = SQRT(RR*RR + DHEMS*DHEMS)
      THETA=ACOS(DHEMS/RHO)
C
      RETURN
      END
