head	1.3;
access;
symbols
	alpha126_22:1.3
	alpha122_22:1.3
	alpha126_21:1.3
	alpha126_20:1.3
	alpha126_19:1.3
	alpha126_18:1.3
	alpha126_17:1.3
	alpha126_16:1.3
	alpha126_15:1.3
	alpha126_14:1.3
	alpha126_13:1.3
	alpha126_12:1.3
	alpha126_11:1.3
	alpha126_10:1.3
	alpha126_09:1.3
	alpha126_08:1.3
	alpha126_07:1.3
	alpha126_06:1.3
	alpha126_05:1.3
	alpha126_04:1.3
	alpha126_03:1.2
	alpha126_02:1.2
	alpha126_1:1.2
	alpha125_17:1.2
	alpha125_16:1.2
	alpha125_15:1.2
	alpha125_14:1.2
	alpha125_13:1.2
	alpha125_12:1.2
	alpha125_11:1.2
	alpha125_10:1.2
	alpha125_09:1.2
	alpha125_08:1.2
	alpha125_07:1.2
	alpha125_06:1.2
	alpha125_05:1.2
	alpha125_04:1.2
	alpha125_03:1.2
	alpha125_02:1.2
	alpha125_01:1.2
	alpha124_19:1.2
	alpha125:1.2
	alpha124_18:1.1
	alpha124_17:1.1
	alpha124_16:1.1
	alpha124_15:1.1
	alpha124_14:1.1
	alpha124_13:1.1
	alpha124_12:1.1
	alpha124_11:1.1
	alpha124_10:1.1
	alpha124_09:1.1
	alpha124_08:1.1
	alpha124_07:1.1
	alpha124_7:1.1
	alpha124_06:1.1
	alpha124_05:1.1
	alpha124_04:1.1
	alpha124_03:1.1
	alpha124_02:1.1
	alpha124_01:1.1;
locks; strict;
comment	@c @;


1.3
date	2001.02.06.07.58.03;	author boucrot;	state Exp;
branches;
next	1.2;

1.2
date	99.12.08.09.02.26;	author flr;	state Exp;
branches;
next	1.1;

1.1
date	99.03.22.14.07.23;	author boucrot;	state Exp;
branches;
next	;


desc
@@


1.3
log
@*** empty log message ***
@
text
@      SUBROUTINE MINSUM(MODE,LRUN,SUMRY)
C-----------------------------------------------------------------------
C! Write summary file for the Mini-DST.
CKEY MDST /INTERNAL
C
C     Author: Stephen Haywood         08-May-90
C     Modify: Agnieszka Jacholkowska  18-May-95
C
C     Input  : MODE   = -1 for initialisation of job
C                     = +1 for run termination, then run initialisation
C                     = +2 for run termination only
C              LRUN   = last run number
C              SUMRY  = summary array
C-----------------------------------------------------------------------
#ifndef DOC
C
      REAL SUMRY(*)

#include "bcs.h"
      PARAMETER (JRLELE=1)
      PARAMETER (JRHAPV=5)
      PARAMETER (JASIYM=1)
      LOGICAL PRESNT
      CHARACTER*120 STRING
      CHARACTER*16  FLNAM
      CHARACTER*8  DATE,TIME
      CHARACTER*80 C1
      INTEGER SYSTEM
      EXTERNAL SYSTEM
      INTEGER NCHARS,NLINES,IRC,IOVFL, LUN
      DIMENSION ERR(2)
#include "bmacro.h"
c --------------------------------------------------------------------
C
      FLNAM = 'MINITEMP.SUMMARY'
      LUN   = 66
C
      CALL DATIMH(DATE,TIME)

      IF(MODE.eq.-1) THEN
C
C --- start of job

       INQUIRE(FILE=FLNAM,EXIST=PRESNT,IOSTAT=IOS) 
       IF (PRESNT) THEN
          OPEN(LUN,FILE=FLNAM,STATUS='old')
C        position at the end of file
   20     READ(LUN,'(A)',END=30) C1
          GOTO 20
   30     BACKSPACE LUN
       ELSE
          OPEN(LUN,FILE=FLNAM,STATUS='new')
       ENDIF
C
C++   At the start of job, make an initial entry in summary file.
C
       WRITE(LUN,'('' Start job '',2A10)') DATE,TIME

C -----------------

      ELSE IF(MODE.ge.+1) THEN
C
C --- MODE=1 end of run followed by start of next run
C     MODE=2 job termination

C++   Replace initial entry in summary file by summary information.
C
       BACKSPACE LUN
       IF(LRUN.GE.0) THEN
C
C++   Obtain LEP energy.
C
         KRLEP = IW(NAMIND('RLEP'))
         IF(KRLEP.GT.0) THEN
          ROOTS = 2. / 1000. * FLOAT(ITABL(KRLEP,1,JRLELE))
         ELSE
          ROOTS = 0.
         ENDIF
C
C++   Investigate whether errors have occurred; reset them if so.
C
         NERR = 0
C
         CALL TIMEX(T)
C
C++   Fill string.
C
         STRING = ' '
         WRITE(STRING(  1:  6),'(I6)') LRUN
         WRITE(STRING(  7: 12),'(I6)') NINT(SUMRY(1))
         WRITE(STRING( 13: 18),'(F6.1)') ROOTS
         STRING( 19: 21) = ' '
         WRITE(STRING( 22: 25),'(I4)') MINVSN(DUM)
         WRITE(STRING( 26: 34),'(A9)') DATE
         WRITE(STRING( 35: 43),'(A9)') TIME
         WRITE(STRING( 44: 49),'(I6)') NINT(T)
         STRING( 50: 52) = ' '
         WRITE(STRING( 53: 58),'(I6)') NINT(SUMRY(2))
         WRITE(STRING( 59: 63),'(F5.2)') SUMRY(3)
         WRITE(STRING( 64: 69),'(I6)') NINT(SUMRY(4))
         STRING( 70: 72) = ' '
         WRITE(STRING( 73: 81),'(I9)') NINT(SUMRY(5))
         WRITE(STRING( 82: 86),'(F5.2)') SUMRY(6)
         WRITE(STRING( 87: 94),'(I8)') NINT(SUMRY(7))
         STRING( 95: 97) = ' '
         WRITE(STRING( 98:120),'(I7)') NERR
C
C++   If this is MC data, save generator code, Julia vsn and year.
C
         IF (LRUN.LE.2000) THEN
           MCGEN = 0
           MCJUL = 0
           IYEAR = 0
           KRHAH = IW(NAMIND('RHAH'))
           IF (KRHAH.GT.0) THEN
            MCGEN = ITABL(KRHAH,1,JRHAPV)
            MCJUL = ITABL(KRHAH,3,JRHAPV)
           ENDIF
           KASIM = IW(NAMIND('ASIM'))
           IF (KASIM.GT.0) THEN
            IYEAR = ITABL(KASIM,1,JASIYM)
           ENDIF
           WRITE(STRING( 73: 81),'(I9)') MCGEN
           WRITE(STRING( 82: 86),'(I5)') MCJUL
           WRITE(STRING( 87: 94),'(I8)') IYEAR
         ENDIF
C
C++   Write summary information.
C
         WRITE( IW(6),'('' >>'',A120)') STRING
         WRITE(LUN,'(A120)') STRING
       ENDIF
C
C++   Make an initial entry in summary file.
C++   The deletion of this entry indicates the successful completion
C++   of the program.
C
       IF(MODE.EQ.+1) THEN
        CALL ABRUEV(IRUN,IEVT)
        WRITE(LUN,'('' Start run '',I10,2A10)') IRUN,DATE,TIME
       ELSE
C++ MODE=2 Close the summary file.
        CLOSE(LUN)
       ENDIF
C
      ENDIF
C ---------------------------
C
      CALL MINCHK(MODE,LRUN,SUMRY)
C
      RETURN
      END
#endif
@


1.2
log
@alpha125 - Y2K compliant
@
text
@d102 5
a106 5
         WRITE(STRING( 73: 78),'(I6)') NINT(SUMRY(5))
         WRITE(STRING( 79: 83),'(F5.2)') SUMRY(6)
         WRITE(STRING( 84: 91),'(I8)') NINT(SUMRY(7))
         STRING( 92: 94) = ' '
         WRITE(STRING( 95:120),'(I7)') NERR
d123 3
a125 3
           WRITE(STRING( 73: 78),'(I6)') MCGEN
           WRITE(STRING( 79: 83),'(I5)') MCJUL
           WRITE(STRING( 84: 91),'(I8)') IYEAR
a153 9









@


1.1
log
@*** empty log message ***
@
text
@d24 1
a24 1
      CHARACTER*117 STRING
d104 3
a106 3
         WRITE(STRING( 84: 89),'(I6)') NINT(SUMRY(7))
         STRING( 90: 92) = ' '
         WRITE(STRING( 93:117),'(I6)') NERR
d125 1
a125 1
           WRITE(STRING( 84: 89),'(I6)') IYEAR
d130 2
a131 2
         WRITE( IW(6),'('' >>'',A117)') STRING
         WRITE(LUN,'(A117)') STRING
d154 7
@

