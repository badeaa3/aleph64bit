head	1.1;
branch	1.1.1;
access;
symbols
	alpha126_22:1.1.1.1
	alpha126_21:1.1.1.1
	alpha126_20:1.1.1.1
	alpha126_19:1.1.1.1
	alpha126_18:1.1.1.1
	alpha126_17:1.1.1.1
	alpha126_16:1.1.1.1
	alpha126_15:1.1.1.1
	alpha126_14:1.1.1.1
	alpha126_13:1.1.1.1
	alpha126_12:1.1.1.1
	alpha126_11:1.1.1.1
	alpha126_10:1.1.1.1
	alpha126_09:1.1.1.1
	alpha126_08:1.1.1.1
	alpha126_07:1.1.1.1
	alpha126_06:1.1.1.1
	alpha126_05:1.1.1.1
	alpha126_04:1.1.1.1
	alpha126_03:1.1.1.1
	alpha126_02:1.1.1.1
	alpha126_1:1.1.1.1
	alpha125_17:1.1.1.1
	alpha125_16:1.1.1.1
	alpha125_15:1.1.1.1
	alpha125_14:1.1.1.1
	alpha125_13:1.1.1.1
	alpha125_12:1.1.1.1
	alpha125_11:1.1.1.1
	alpha125_10:1.1.1.1
	alpha125_09:1.1.1.1
	alpha125_08:1.1.1.1
	alpha125_07:1.1.1.1
	alpha125_06:1.1.1.1
	alpha125_05:1.1.1.1
	alpha125_04:1.1.1.1
	alpha125_03:1.1.1.1
	alpha125_02:1.1.1.1
	alpha125_01:1.1.1.1
	alpha124_19:1.1.1.1
	alpha125:1.1.1.1
	alpha124_18:1.1.1.1
	alpha124_17:1.1.1.1
	alpha124_16:1.1.1.1
	alpha124_15:1.1.1.1
	alpha124_14:1.1.1.1
	alpha124_13:1.1.1.1
	alpha124_12:1.1.1.1
	alpha124_11:1.1.1.1
	alpha124_10:1.1.1.1
	alpha124_09:1.1.1.1
	alpha124_08:1.1.1.1
	alpha124_07:1.1.1.1
	alpha124_7:1.1.1.1
	alpha124_06:1.1.1.1
	alpha124_05:1.1.1.1
	alpha124_04:1.1.1.1
	alpha124_03:1.1.1.1
	alpha124_02:1.1.1.1
	alpha124_01:1.1.1.1
	alpha124:1.1.1.1
	alpha123_12:1.1.1.1
	alpha123_11:1.1.1.1
	alpha123_10:1.1.1.1
	alpha123_9:1.1.1.1
	alpha123_8:1.1.1.1
	alpha123_7:1.1.1.1
	alpha123_6:1.1.1.1
	alpha123_5:1.1.1.1
	alpha123_4:1.1.1.1
	alpha123_3:1.1.1.1
	alpha123_2:1.1.1.1
	alpha123:1.1.1.1
	alpha122_48:1.1.1.1
	alpha122_47:1.1.1.1
	alpha122_46:1.1.1.1
	alpha122_45:1.1.1.1
	alpha122_44:1.1.1.1
	alpha122_43:1.1.1.1
	alpha122_42:1.1.1.1
	alpha122_41:1.1.1.1
	alpha122_40:1.1.1.1
	alpha122_39:1.1.1.1
	alpha122_38:1.1.1.1
	alpha122_37:1.1.1.1
	alpha122_36:1.1.1.1
	alpha122_35:1.1.1.1
	alpha122_34:1.1.1.1
	alpha122_33:1.1.1.1
	alpha122_32:1.1.1.1
	alpha122_31:1.1.1.1
	alpha122_30:1.1.1.1
	alpha122_29:1.1.1.1
	alpha122_28:1.1.1.1
	alpha122_27:1.1.1.1
	alpha122_26:1.1.1.1
	alpha122_25:1.1.1.1
	alpha122_24:1.1.1.1
	alpha122_23:1.1.1.1
	alpha122_22:1.1.1.1
	alpha122_21:1.1.1.1
	alpha122_20:1.1.1.1
	alpha122_19:1.1.1.1
	alpha122_18:1.1.1.1
	alpha122_17:1.1.1.1
	alpha122_16:1.1.1.1
	alpha122_15:1.1.1.1
	alpha122_14:1.1.1.1
	alpha122_13:1.1.1.1
	alpha122_12:1.1.1.1
	alpha122_11:1.1.1.1
	alpha122_10:1.1.1.1
	alpha122_9:1.1.1.1
	alpha122_8:1.1.1.1
	alpha122_6:1.1.1.1
	alpha122_5:1.1.1.1
	alpha122:1.1.1.1
	alpha212:1.1.1.1
	ALPHA212:1.1.1;
locks; strict;
comment	@c @;


1.1
date	96.03.14.12.41.43;	author flr;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	96.03.14.12.41.44;	author flr;	state Exp;
branches;
next	;


desc
@@



1.1
log
@Initial revision
@
text
@      SUBROUTINE QFMCST
CKEY FILL MC /INTERNAL
C-----------------------------------------------------------------------
C! Fill stability code for MC particles
C!                                                  H.Albrecht 18.10.88
C!called from QFILMC
C-----------------------------------------------------------------------
#ifndef DOC
      PARAMETER (RITC=28.8,ZITC=100.,RTPC=180.,ZTPC=200.)
#include "qcdesh.h"
      DIMENSION MT(30),MD(30),MF(30)
C
      JQVEC(I,N) = KOQVEC + I * KCQVEC + N
      IQVEC(I,N) = IW (KOQVEC + I * KCQVEC + N)
      RQVEC(I,N) = RW (KOQVEC + I * KCQVEC + N)
      IDAUG(I,N) = IW (KOQLIN + IQVEC(I,JQVEDL) + N)
      VR2(I) = RW(KOQVRT+I*KCQVRT+JQVRVX)**2 +
     &         RW(KOQVRT+I*KCQVRT+JQVRVY)**2
      VZA(I) = ABS (RW(KOQVRT+I*KCQVRT+JQVRVZ))
C-----------------------------------------------------------------------
C
      DO 60 ITK=KFMCT,KLMCT
        IF (IQVEC(ITK,JQVENO) .NE. 0)  GO TO 60
C
        NF = 0
        NG = 0
        NT = ITK
C
   10   NG = NG + 1
        IF (NG .GT. 30)  THEN
          CALL QWMESE ('_QFMCST_ more than 30 generations')
          GO TO 60
        ENDIF
C
        IEND = IQVEC(NT,JQVEEV)
C not decaying ...
        IF (IEND .EQ. 0)  THEN
          IW(JQVEC(NT,JQVESC)) = 1
          IF (NF .NE. 0)  IW(JQVEC(NT,JQVESC)) = 3
          GO TO 50
        ENDIF
C
C treat charged and neutral particles in a different way :
        IF (RQVEC(NT,JQVECH) .NE. 0.)  THEN
C charged particle decaying outside ITC
          IF (VZA(IEND) .GT. ZITC .OR. VR2(IEND) .GT. RITC**2)
     &      GO TO 40
        ELSE
C neutral particle decaying outside TPC
          IF (VZA(IEND) .GT. ZTPC .OR. VR2(IEND) .GT. RTPC**2)
     &      GO TO 40
        ENDIF
C
        ND = 1
C unstable particle : -1 = resonance; -2 = finite decay length
        IW(JQVEC(NT,JQVESC)) = -1
C decaying at origin vertex :
        IF (IEND .EQ. IQVEC(NT,JQVEOV))  GO TO 30
        IW(JQVEC(NT,JQVESC)) = -2
C check energy conservation
        E = 0.
        DO 20 ID = 1, IQVEC(NT,JQVEND)
   20   E = E + RQVEC (IDAUG(NT,ID),JQVEQE)
C tolerance 20 MeV :
        IF (ABS (E - RQVEC(NT,JQVEQE)) .GT. 0.020)  THEN
          IF (NF .EQ. 0)  IW(JQVEC(NT,JQVESC)) = -3
          NF = 1
        ENDIF
C
   30   IF (ND .GT. IQVEC(NT,JQVEND))  GO TO 50
        MF(NG) = NF
        MT(NG) = NT
        MD(NG) = ND
        NT = IDAUG(NT,ND)
        GO TO 10
C
   40   IW(JQVEC(NT,JQVESC)) = 2
        IF (NF .NE. 0)  IW(JQVEC(NT,JQVESC)) = 3
C
   50   IF (NG .EQ. 1)  GO TO 60
        NG = NG - 1
        NF = MF(NG)
        NT = MT(NG)
        ND = MD(NG) + 1
        GO TO 30
C
   60 CONTINUE
C
      END
#endif
@


1.1.1.1
log
@import alpha122 from alws
@
text
@@
