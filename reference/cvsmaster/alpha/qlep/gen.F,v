head	1.3;
access;
symbols
	alpha126_22:1.3
	alpha126_21:1.3
	alpha126_20:1.3
	alpha126_19:1.3
	alpha126_18:1.3
	alpha126_17:1.3
	alpha126_16:1.3
	alpha126_15:1.3
	alpha126_14:1.3
	alpha126_13:1.3
	alpha126_12:1.3
	alpha126_11:1.3
	alpha126_10:1.3
	alpha126_09:1.3
	alpha126_08:1.3
	alpha126_07:1.3
	alpha126_06:1.3
	alpha126_05:1.3
	alpha126_04:1.3
	alpha126_03:1.3
	alpha126_02:1.3
	alpha126_1:1.3
	alpha125_17:1.3
	alpha125_16:1.3
	alpha125_15:1.3
	alpha125_14:1.3
	alpha125_13:1.3
	alpha125_12:1.3
	alpha125_11:1.3
	alpha125_10:1.3
	alpha125_09:1.3
	alpha125_08:1.3
	alpha125_07:1.3
	alpha125_06:1.3
	alpha125_05:1.3
	alpha125_04:1.3
	alpha125_03:1.3
	alpha125_02:1.3
	alpha125_01:1.3
	alpha124_19:1.3
	alpha125:1.3
	alpha124_18:1.3
	alpha124_17:1.3
	alpha124_16:1.3
	alpha124_15:1.3
	alpha124_14:1.3
	alpha124_13:1.3
	alpha124_12:1.3
	alpha124_11:1.3
	alpha124_10:1.3
	alpha124_09:1.3
	alpha124_08:1.3
	alpha124_07:1.3
	alpha124_7:1.3
	alpha124_06:1.3
	alpha124_05:1.3
	alpha124_04:1.3
	alpha124_03:1.3
	alpha124_02:1.3
	alpha124_01:1.3
	alpha124:1.3
	alpha123_12:1.3
	alpha123_11:1.3
	alpha123_10:1.3
	alpha123_9:1.3
	alpha123_8:1.3
	alpha123_7:1.3
	alpha123_6:1.3
	alpha123_5:1.3
	alpha123_4:1.3
	alpha123_3:1.3
	alpha123_2:1.3
	alpha123:1.3
	alpha122_48:1.3
	alpha122_47:1.3
	alpha122_46:1.3
	alpha122_45:1.3
	alpha122_44:1.3
	alpha122_43:1.3
	alpha122_42:1.3
	alpha122_41:1.3
	alpha122_40:1.3
	alpha122_39:1.3
	alpha122_38:1.3
	alpha122_37:1.3
	alpha122_36:1.3
	alpha122_35:1.3
	alpha122_34:1.3
	alpha122_33:1.3
	alpha122_32:1.3
	alpha122_31:1.3
	alpha122_30:1.3
	alpha122_29:1.3
	alpha122_28:1.3
	alpha122_27:1.3
	alpha122_26:1.3
	alpha122_25:1.3
	alpha122_24:1.3
	alpha122_23:1.3
	alpha122_22:1.3
	alpha122_21:1.3
	alpha122_20:1.3
	alpha122_19:1.3
	alpha122_18:1.3
	alpha122_17:1.3
	alpha122_16:1.3
	alpha122_15:1.3
	alpha122_14:1.3
	alpha122_13:1.3
	alpha122_12:1.3
	alpha122_11:1.3
	alpha122_10:1.3
	alpha122_9:1.1.1.1
	alpha122_8:1.1.1.1
	alpha122_6:1.1.1.1
	alpha122_5:1.1.1.1
	alpha122:1.1.1.1
	alpha212:1.1.1.1
	ALPHA212:1.1.1;
locks; strict;
comment	@c @;


1.3
date	96.08.28.13.59.49;	author boucrot;	state Exp;
branches;
next	1.2;

1.2
date	96.08.27.14.47.38;	author boucrot;	state Exp;
branches;
next	1.1;

1.1
date	96.03.14.12.42.51;	author flr;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	96.03.14.12.42.52;	author flr;	state Exp;
branches;
next	;


desc
@@


1.3
log
@*** empty log message ***
@
text
@      SUBROUTINE GEN(MTRA,IPROC,IBMES)
CKEY  QTRUTH/INTERNAL
C ...............................................................
C! Determines the production process and decaying b in QTRUTH
C  Authors  D. Abbaneo , F. Ligabue 27/07/94  from FINLEP / UPHY
C  Called from QTRUTH
C .                                                             .
C . Input                                                       .
C .   MTRA   / I   Alpha index of the MC track which is the     .
C .                daughter of the string or of the last        .
C .                H.F. hadron                                  .
C .                                                             .
C . Output                                                      .
C .   IPROC  / I   Production process                           .
C .                 1    b -> c X                               .
C .                 2    b -> u X                               .
C .                 3    b -> cbar c ; cbar -> X                .
C .                 4    b -> cbar u ; cbar -> X                .
C .                 5    b -> c -> X                            .
C .                 6    c -> X                                 .
C .                 7    fragmentation or uds                   .
C .                                                             .
C .   IBMES  / I   Identity of the decaying b particle (if any) .
C .                -2   "oscillated" Bs                         .
C .                -1   "oscillated" Bd                         .
C .                 0   b baryon or non b particle              .
C .                 1   Bd                                      .
C .                 2   Bs                                      .
C .                 3   B+                                      .
C .                                                             .
C ...............................................................
#ifndef DOC
      IMPLICIT NONE
#include "qdecl.h"
#include "qcde.h"
C
C - functions
      LOGICAL FHVFL,BTOU,FBHAD,FBQUA,FBBAR,FCQUA,FCBAR,ENDCH
C
C - variables
      INTEGER MTRA,IPROC,NON,IBMES,IBFUNC,MGM
C
C - macros
#include "qmacro.h"
C----------------------------------------------------------------------
      IBMES=0
C
C - fragmentation or uds
      IPROC = 7
      NON = KMOTH(MTRA,1)
      IF (.NOT.FHVFL(NON)) RETURN
      IF (FBHAD(NON)) THEN
C
C - b->l
        IPROC=1
C
C - charmless b->l
        IF (BTOU(MTRA)) IPROC=2
        IBMES=IBFUNC(NON)
      ELSE
89      MGM=KMOTH(NON,1)
        IF (ENDCH(MGM)) THEN
C
C - c->l
          IPROC=6
        ELSEIF(FBHAD(MGM)) THEN
          IBMES=IBFUNC(MGM)
          IF ((FBQUA(MGM).AND.FCQUA(NON)).OR.
     @@       (FBBAR(MGM).AND.FCBAR(NON))) THEN
C
C - b->c->l
            IPROC=5
          ELSE
C
C - b->cbar c
            IPROC=3
C
C - b->cbar u
            IF (BTOU(NON)) IPROC=4
          ENDIF
        ELSE
          NON=MGM
          GOTO 89
        ENDIF
      ENDIF
      RETURN
      END
#endif
@


1.2
log
@*** empty log message ***
@
text
@d88 1
a88 1
#endif@


1.1
log
@Initial revision
@
text
@d32 1
d88 1
@


1.1.1.1
log
@import alpha122 from alws
@
text
@@
