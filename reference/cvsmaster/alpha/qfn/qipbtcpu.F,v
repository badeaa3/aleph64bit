head	1.1;
branch	1.1.1;
access;
symbols
	alpha126_22:1.1.1.1
	alpha126_21:1.1.1.1
	alpha126_20:1.1.1.1
	alpha126_19:1.1.1.1
	alpha126_18:1.1.1.1
	alpha126_17:1.1.1.1
	alpha126_16:1.1.1.1
	alpha126_15:1.1.1.1
	alpha126_14:1.1.1.1
	alpha126_13:1.1.1.1
	alpha126_12:1.1.1.1
	alpha126_11:1.1.1.1
	alpha126_10:1.1.1.1
	alpha126_09:1.1.1.1
	alpha126_08:1.1.1.1
	alpha126_07:1.1.1.1
	alpha126_06:1.1.1.1
	alpha126_05:1.1.1.1
	alpha126_04:1.1.1.1
	alpha126_03:1.1.1.1
	alpha126_02:1.1.1.1
	alpha126_1:1.1.1.1
	alpha125_17:1.1.1.1
	alpha125_16:1.1.1.1
	alpha125_15:1.1.1.1
	alpha125_14:1.1.1.1
	alpha125_13:1.1.1.1
	alpha125_12:1.1.1.1
	alpha125_11:1.1.1.1
	alpha125_10:1.1.1.1
	alpha125_09:1.1.1.1
	alpha125_08:1.1.1.1
	alpha125_07:1.1.1.1
	alpha125_06:1.1.1.1
	alpha125_05:1.1.1.1
	alpha125_04:1.1.1.1
	alpha125_03:1.1.1.1
	alpha125_02:1.1.1.1
	alpha125_01:1.1.1.1
	alpha124_19:1.1.1.1
	alpha125:1.1.1.1
	alpha124_18:1.1.1.1
	alpha124_17:1.1.1.1
	alpha124_16:1.1.1.1
	alpha124_15:1.1.1.1
	alpha124_14:1.1.1.1
	alpha124_13:1.1.1.1
	alpha124_12:1.1.1.1
	alpha124_11:1.1.1.1
	alpha124_10:1.1.1.1
	alpha124_09:1.1.1.1
	alpha124_08:1.1.1.1
	alpha124_07:1.1.1.1
	alpha124_7:1.1.1.1
	alpha124_06:1.1.1.1
	alpha124_05:1.1.1.1
	alpha124_04:1.1.1.1
	alpha124_03:1.1.1.1
	alpha124_02:1.1.1.1
	alpha124_01:1.1.1.1
	alpha124:1.1.1.1
	alpha123_12:1.1.1.1
	alpha123_11:1.1.1.1
	alpha123_10:1.1.1.1
	alpha123_9:1.1.1.1
	alpha123_8:1.1.1.1
	alpha123_7:1.1.1.1
	alpha123_6:1.1.1.1
	alpha123_5:1.1.1.1
	alpha123_4:1.1.1.1
	alpha123_3:1.1.1.1
	alpha123_2:1.1.1.1
	alpha123:1.1.1.1
	alpha122_48:1.1.1.1
	alpha122_47:1.1.1.1
	alpha122_46:1.1.1.1
	alpha122_45:1.1.1.1
	alpha122_44:1.1.1.1
	alpha122_43:1.1.1.1
	alpha122_42:1.1.1.1
	alpha122_41:1.1.1.1
	alpha122_40:1.1.1.1
	alpha122_39:1.1.1.1
	alpha122_38:1.1.1.1
	alpha122_37:1.1.1.1
	alpha122_36:1.1.1.1
	alpha122_35:1.1.1.1
	alpha122_34:1.1.1.1
	alpha122_33:1.1.1.1
	alpha122_32:1.1.1.1
	alpha122_31:1.1.1.1
	alpha122_30:1.1.1.1
	alpha122_29:1.1.1.1
	alpha122_28:1.1.1.1
	alpha122_27:1.1.1.1
	alpha122_26:1.1.1.1
	alpha122_25:1.1.1.1
	alpha122_24:1.1.1.1
	alpha122_23:1.1.1.1
	alpha122_22:1.1.1.1
	alpha122_21:1.1.1.1
	alpha122_20:1.1.1.1
	alpha122_19:1.1.1.1
	alpha122_18:1.1.1.1
	alpha122_17:1.1.1.1
	alpha122_16:1.1.1.1
	alpha122_15:1.1.1.1
	alpha122_14:1.1.1.1
	alpha122_13:1.1.1.1
	alpha122_12:1.1.1.1
	alpha122_11:1.1.1.1
	alpha122_10:1.1.1.1
	alpha122_9:1.1.1.1
	alpha122_8:1.1.1.1
	alpha122_6:1.1.1.1
	alpha122_5:1.1.1.1
	alpha122:1.1.1.1
	alpha212:1.1.1.1
	ALPHA212:1.1.1;
locks; strict;
comment	@c @;


1.1
date	96.03.14.12.42.37;	author flr;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	96.03.14.12.42.38;	author flr;	state Exp;
branches;
next	;


desc
@@



1.1
log
@Initial revision
@
text
@      SUBROUTINE QIPBTCPU(CHSUB,IFLAG)
CKEY   QIPBTAG / INTERNAL
C-----------------------------------------------------------------------
C!    Determine CPU time usage for QIPBTAG subroutines
C  Called from QIPBTAG
C     Author  S.Schael      09-May-1995
C-----------------------------------------------------------------------
#ifndef DOC
      SAVE
#include "bcs.h"
      CHARACTER*(*) CHSUB
      INTEGER       IFLAG
      INTEGER       NSUBS, MSUBS
      PARAMETER     (MSUBS = 50)
      CHARACTER*20  CHSUBS(50)
      REAL          TIMING(50)
      COMMON / QIPBCPUT / NSUBS, TIMING, CHSUBS
      LOGICAL       LOT0, FIRST
      DATA          LOT0/.FALSE./, FIRST/.TRUE./
C-----------------------------------------------------------------------
      IF (FIRST) THEN
         NSUBS     = 1
         CHSUBS(1) = 'BETWEEN SUBS'
         FIRST     = .FALSE.
         CALL VZERO(TIMING,MSUBS)
         IQITI=IW(NAMIND('QITI'))
      ENDIF
C
C The routine is executed only if the user provided a 'QITI' data card :
      IF (IQITI.EQ.0) GO TO 9999
      IF (IFLAG.EQ.0 .OR. IFLAG.EQ.1) THEN
         IL = LENOCC(CHSUB)
         DO I = 2,NSUBS
            IF (CHSUBS(I)(1:IL).EQ.CHSUB(1:IL)) GOTO 200
         ENDDO
         NSUBS         = NSUBS + 1
         IF (NSUBS .GT. MSUBS) THEN
            WRITE (IW(6),*) 'QIPBTCPU: TOO MANY SUBROUTINES !'
            GOTO 9999
         ENDIF
         CHSUBS(NSUBS) = CHSUB
         I             = NSUBS
C
  200    CONTINUE
         IF (IFLAG .EQ. 0) THEN
            CALL TIMED(T0)
            TIMING(1) = TIMING(1) + T0
            LOT0      = .TRUE.
            GOTO 9999
         ENDIF
         IF (IFLAG .EQ. 1) THEN
            IF (.NOT. LOT0) THEN
               WRITE (IW(6),*) 'QIPBTCPU: WRONG ORDER OF CPU-TIME CALLS'
               GOTO 9999
            ENDIF
            CALL TIMED(DT)
            TIMING(I) = TIMING(I) + DT
            LOT0      = .FALSE.
         ENDIF
C
      ELSEIF (IFLAG .EQ. 2) THEN
C
C------- PRINT CPU-TIMEING
         TTOT = VSUM(TIMING,NSUBS)
         WRITE (IW(6),*)
         WRITE (IW(6),10600) 'Q I P B T A G :     C P U   -  T I M E'//
     .                  '  U S A G E'
         WRITE (IW(6),10700) 'SUBROUTINE','CPU TIME(%)','CPU TIME (S)'
         WRITE (IW(6),10000)
         DO I = 1,NSUBS
            WRITE (IW(6),'(1X,A20,2(F9.4,3X))') CHSUBS(I),
     .                                     TIMING(I)/TTOT*100,
     .                                     TIMING(I)
         ENDDO
         WRITE (IW(6),10000)
         WRITE (IW(6),*) 'TOTAL CPU TIME (S): ',TTOT
         WRITE (IW(6),*)
         GOTO 9999
      ELSE
         WRITE (IW(6),*) 'QIPBTCPU: INVALID FLAG=',IFLAG
      ENDIF
C
 9999 RETURN
C
10000 FORMAT (1X,80('-'))
10600 FORMAT (1X,10('*'),2X,A,2X,10('*'))
10700 FORMAT (1X,A,2(10X,A))
      END
#endif
@


1.1.1.1
log
@import alpha122 from alws
@
text
@@
