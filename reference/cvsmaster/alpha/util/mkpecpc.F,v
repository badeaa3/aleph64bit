head	1.1;
access;
symbols
	alpha126_22:1.1
	alpha122_22:1.1
	alpha126_21:1.1
	alpha126_20:1.1
	alpha126_19:1.1
	alpha126_18:1.1
	alpha126_17:1.1
	alpha126_16:1.1
	alpha126_15:1.1
	alpha126_14:1.1
	alpha126_13:1.1
	alpha126_12:1.1
	alpha126_11:1.1
	alpha126_10:1.1
	alpha126_09:1.1
	alpha126_08:1.1
	alpha126_07:1.1
	alpha126_06:1.1
	alpha126_05:1.1
	alpha126_04:1.1
	alpha126_03:1.1
	alpha126_02:1.1
	alpha126_1:1.1
	alpha125_17:1.1
	alpha125_16:1.1
	alpha125_15:1.1
	alpha125_14:1.1
	alpha125_13:1.1
	alpha125_12:1.1
	alpha125_11:1.1
	alpha125_10:1.1
	alpha125_09:1.1
	alpha125_08:1.1;
locks; strict;
comment	@c @;


1.1
date	2000.07.16.13.57.36;	author boucrot;	state Exp;
branches;
next	;


desc
@@


1.1
log
@*** empty log message ***
@
text
@      INTEGER FUNCTION MINI_KPECPC(IECAL)
C
C
C     Input: IECAL (I) : ALPHA track number of the ECAL (PECO) object
C
C     Output: (I): PCOB object number
C
C     error code : -1 = invalid IECAL
C                  -2 = IECAL is NOT a PECO object
C                  -3 = cannot find PECO Julia number
C                  -4 = cannot find PCRL
C-------------------------------------------------------------------------
      IMPLICIT NONE
C
#include "qdecl.h"
#include "qcde.h"
#include "qhac.h"
C
      INTEGER IECAL,IPECO,KPCRL
      INTEGER ICOB
C
#include "qmacro.h"
C
      MINI_KPECPC=0
C
C...check if this is an ECAL object
C
      IF(IECAL.LE.0) THEN
        MINI_KPECPC=-1
        GOTO 999
      ELSEIF(.NOT.(XPEC(IECAL))) THEN
        MINI_KPECPC=-2
        GOTO 999      
      ENDIF
C
C...Look for the PECO row number
C
      IPECO=KTN(IECAL)
      IF(IPECO.LE.0) THEN
        MINI_KPECPC=-3
        GOTO 999
      ENDIF
C
C...Loop on PCRL to find the corresponding calobject number
C
      KPCRL=IW(NAPCRL)
      IF(KPCRL.LE.0) THEN
        MINI_KPECPC=-4
        GOTO 999
      ENDIF
      DO ICOB=1,LROWS(KPCRL)
        IF(IPECO.EQ.ITABL(KPCRL,ICOB,JPCRPE)) THEN
          MINI_KPECPC=ITABL(KPCRL,ICOB,JPCRPC)
          GOTO 999
        ENDIF
      ENDDO
C
 999  CONTINUE
      RETURN
      END
C 
@
