head	1.2;
access;
symbols
	alpha126_22:1.2
	alpha122_22:1.2
	alpha126_21:1.2
	alpha126_20:1.2
	alpha126_19:1.2
	alpha126_18:1.2
	alpha126_17:1.2
	alpha126_16:1.2
	alpha126_15:1.2
	alpha126_14:1.2
	alpha126_13:1.2
	alpha126_12:1.2
	alpha126_11:1.2
	alpha126_10:1.2
	alpha126_09:1.2
	alpha126_08:1.2
	alpha126_07:1.2
	alpha126_06:1.2
	alpha126_05:1.1
	alpha126_04:1.1
	alpha126_03:1.1
	alpha126_02:1.1
	alpha126_1:1.1
	alpha125_17:1.1
	alpha125_16:1.1
	alpha125_15:1.1
	alpha125_14:1.1
	alpha125_13:1.1
	alpha125_12:1.1
	alpha125_11:1.1;
locks; strict;
comment	@c @;


1.2
date	2001.03.05.10.45.44;	author boucrot;	state Exp;
branches;
next	1.1;

1.1
date	2000.10.17.13.01.32;	author boucrot;	state Exp;
branches;
next	;


desc
@@


1.2
log
@*** empty log message ***
@
text
@      integer function ndigh_e14(Ihco)
C======================================================================
C For PHCO row number IHCO how many distinct layers of digital hits
C are associated to it
C Auxiliary to QFE14
C Author G. Taylor Oct 1997
C======================================================================
      SAVE
#include "qcde.h"
#include "phstjj.h"
      parameter ( nhsmi = 0 , nhsmx = 190 )
      integer ifired(3,24,23)
      integer imodh(100),isch(100)
      LOGICAL FIRST
      DATA FIRST/.TRUE./
#include "bmacro.h"
C----------------------------------------------------------------------
      ndigh_e14=0
C
      IF (FIRST) THEN
        FIRST=.FALSE.
        NAPHST=NAMIND('PHST')
      ENDIF
C
      IF (IW(NAPHST).LE.0) return
      NHSTO=LROWS (IW(NAPHST))
      IF (NHSTO.LE.0) return
C
C
      KPHST=IW(NAPHST)
      nmod=0
      DO 100 IST=1,NHSTO
C?           get module #, subcomp #
        ITETHS=ITABL(KPHST,IST,JPHSTI)
        ISTKHS=1
        IF (ITETHS.GT.128) THEN
          ITETHS=ITETHS-128
          ISTKHS=2
        ENDIF
        if (iteths.le.nhsmi.or.iteths.gt.nhsmx) go to 100
        IPHIHS=ITABL(KPHST,IST,JPHSPI)
        CALL HFNDMD(ITETHS,IPHIHS,ISTKHS,ISUBHS,IMODHS,IOVRHS)
        if (ITABL(KPHST,IST,JPHSPH).eq.ihco) then
         nmod=nmod+1
         imodh(nmod)=imodhs
         isch(nmod)=isubhs
        endif 
C
 100  continue  
C
      nhtub=0
      khtub=iw(namind('HTUB'))
      call vzero(ifired(1,1,1),23*3*24)
      if (khtub.gt.0) then
       nhtub=lrows(khtub)
       do i=1,lrows(khtub)
        isc=itabl(khtub,i,1)
        imod=itabl(khtub,i,2)
        ilay=itabl(khtub,i,3)
        ifired(isc,imod,ilay)=ifired(isc,imod,ilay)+1
       enddo
       do ilay=1,23
        iuse=0
        do isc=1,3
         do imod=1,24
          if (ifired(isc,imod,ilay).ne.0) then
           do i=1,nmod
            if (isc.eq.isch(i).and.imod.eq.imodh(i)) iuse=1
           enddo
          endif
         enddo
        enddo
        if (iuse.eq.1) ndigh_e14=ndigh_e14+1
       enddo
      endif
      return
      END
@


1.1
log
@*** empty log message ***
@
text
@a0 2


d11 1
d32 1
a32 1
      DO IST=1,NHSTO
d40 1
d49 2
a50 1
      enddo
@

