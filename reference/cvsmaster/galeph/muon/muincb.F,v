head	1.2;
access;
symbols
	gal309_3:1.2
	gal309_2:1.2
	gal309_1:1.2
	gal309:1.2
	gal308_2:1.2
	gal308_1:1.2
	gal308:1.2
	gal307_2:1.2
	gal307_1:1.2
	gal307:1.2
	gal306_3:1.2
	gal306_2:1.2
	gal306_1:1.2
	gal306:1.2
	gal305_3:1.2
	gal305_2:1.2
	gal305_1:1.2
	gal305:1.2
	gal304_11:1.2
	gal304_10:1.2
	gal304_9:1.2
	gal304_8:1.1.1.1
	gal304_7:1.1.1.1
	gal304_6:1.1.1.1
	gal304_5:1.1.1.1
	gal304_4:1.1.1.1
	gal304_3:1.1.1.1
	gal304_2:1.1.1.1
	gal304_1:1.1.1.1
	gal304:1.1.1.1
	gal303_3:1.1.1.1
	gal303_2:1.1.1.1
	gal303_1:1.1.1.1
	v-303:1.1.1.1
	gal302_2:1.1.1.1
	flr:1.1.1;
locks; strict;
comment	@c @;


1.2
date	96.08.22.14.10.56;	author flr;	state Exp;
branches;
next	1.1;

1.1
date	94.12.07.14.02.41;	author flr;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	94.12.07.14.02.42;	author flr;	state Exp;
branches;
next	;


desc
@@


1.2
log
@add #ifndef where it was missing and remove dummy routines
@
text
@*DK muincb
      SUBROUTINE MUINCB(ISLOT,IPLANE,NSTRPF,NAST,NBUS,NSTRPB,IFLAG)
C-----------------------------------------------------------
C!  Transforms barrel slot and strip nb. to astros and bus nb.
C
C  Author :   A. Antonelli, F. Bossi 1 July 89
C.  -Called by MUDGTZ                  from this .HLB
C.  -Calls none
C.
C-----------------------------------------------------------
#ifndef DOC
#include "bcs.h"
#include "munamc.h"
#include "mug1pr.h"
#include "mjjpar.h"
C
      SAVE
      PARAMETER (NROW=34,NCOL=3,NROW1=26,NCOL1=16)
C
#include "bmacro.h"
#include "muiwna.h"
C
C........ Read astros type and astros number
        NTPAS= ITABL(JMBSG,ISLOT,JMBSTA)
        NAST = ITABL(JMBSG,ISLOT,JMBSNA)
C.......     Bus type      1= X1 =1    Nb. in MUHT
C                          2= Y1 =2
C                          3= X2 =4
C                          4= Y2 =3
C                          5= X3 =1
C                          6= Y3 =2
C                          7= X4 =4
C                          8= Y4 =3
C.......
        NBUSTY= IPLANE+4
        IF(ISLOT.LE.17) NBUSTY= IPLANE
        IF(IPLANE.EQ.3) NBUSTY = NBUSTY + 1
        IF(IPLANE.EQ.4) NBUSTY = NBUSTY - 1
C
        IREM=MOD(NBUSTY,2)
        JMPK2 = ITABL(JMBSG,ISLOT,JMBSK2)
C
        IF(IREM.GT.0) THEN
C
C       The readout direction for x strip is not always the same
C
             IF(ISLOT.GT.17) THEN
                 MSLOT = ISLOT-17
             ELSE
                 MSLOT=ISLOT
             ENDIF
             IF(MSLOT.EQ.12.OR.MSLOT.EQ.16) GO TO 2
             IF(MSLOT.EQ.1.OR.MSLOT.GE.8) THEN
                NMAX = ITABL(JMBTG,JMPK2,JMBTNX)
                NSTRPF = -(NSTRPF-NMAX)-1
             ENDIF
 2           CONTINUE
        ELSE
C
C       The readout direction for x strip is not always the same
C
             IF(ISLOT.GE.12.AND.ISLOT.LE.14) THEN
                 IF(NBUSTY.EQ.4.OR.NBUSTY.EQ.8) THEN
                   NMAX = ITABL(JMBTG,JMPK2,JMBTY1)
                   NSTRPF = -(NSTRPF-NMAX)-1
                 ENDIF
              ELSE
                 IF(NBUSTY.EQ.2.OR.NBUSTY.EQ.6) THEN
                    NMAX = ITABL(JMBTG,JMPK2,JMBTY1)
                    NSTRPF = -(NSTRPF-NMAX)-1
                 ENDIF
              ENDIF
        ENDIF
C
C       Astros type and astros number for slot 4D
C
        IF(NAST.NE.0) GO TO 100
        IF(NBUSTY.EQ.2.OR.NBUSTY.EQ.4) THEN
            NTPAS=3
            NAST = 126
        ELSE
            NTPAS=4
             NAST = 128
        END IF
100     CONTINUE
C
        KK=0
        NBUS=0
        NSTRPB=0
        IFLAG = 0
        INAS = 3*(NTPAS-1)
        DO 1 J=1,NROW1
        IFIND = ITABL(JMBBG,J,JMBBB1+INAS)
        IF(IFIND.NE.NBUSTY) GO TO 1
C.                 Bus x or type 2
        IF(IREM.GT.0.OR.NTPAS.EQ.2) THEN
                IPOIN=0
C.                 Type 4
                IF(NTPAS.EQ.4) THEN
                        IPTSLO = ITABL(JMBBG,J,JMBBP4)
                        IF(IPTSLO.NE.ISLOT) GO TO 1
                        NBUS=(J-1)/2
                 ELSE
C                   Slot 9, 11 A
                        IF(ISLOT.EQ.10.OR.ISLOT.EQ.14.OR.
     &                     ISLOT.EQ.27.OR.ISLOT.EQ.31) IPOIN=4
C                   Slot 9, 11 B
                        IF(ISLOT.EQ.12.OR.ISLOT.EQ.16.OR.
     &                     ISLOT.EQ.29.OR.ISLOT.EQ.33) IPOIN=8
                        MROW = J+IPOIN
                        NBUS = ITABL(JMBBG,MROW,JMBBID) - 1
                ENDIF
                LIN = ITABL(JMBBG,J+IPOIN,JMBBL1+INAS)
                LFIN= ITABL(JMBBG,J+IPOIN,JMBBU1+INAS)
                NDIFF=LFIN-LIN+1
                IF(NSTRPF.GT.NDIFF) GO TO 200
C
                NSTRPB= LIN+NSTRPF
                IFLAG = 1
                GO TO 200
C
        ELSE
C                   Bus Y
C                   Type 3 ,4
                IF(NTPAS.EQ.3) THEN
                      IPTSLO=ITABL(JMBBG,J,JMBBP3)
                      IF(IPTSLO.NE.ISLOT) GO TO 1
                END IF
                IF(NTPAS.EQ.4) THEN
                      IPTSLO=ITABL(JMBBG,J,JMBBP4)
                      IF(IPTSLO.NE.ISLOT) GO TO 1
                END IF
                KK=KK+1
                IF(KK.EQ.1)NSTPF1=NSTRPF+ITABL(JMBBG,J,JMBBL1+INAS)
                NFIN=ITABL(JMBBG,J,JMBBU1+INAS)
                IF(NSTPF1.GT.NFIN) GO TO 1
                NBUS=J-1
                IF(NTPAS.EQ.4) NBUS=J-3
                NSTRPB=NSTPF1-ITABL(JMBBG,J,JMBBL1+INAS)
                IF(KK.EQ.1) NSTRPB=NSTPF1
                IFLAG = 1
                GO TO 200
        END IF
1       CONTINUE
200     CONTINUE
        RETURN
        END
#endif
@


1.1
log
@Initial revision
@
text
@d11 1
d148 1
@


1.1.1.1
log
@import galeph 300
@
text
@@
