head	1.2;
access;
symbols
	gal309_3:1.2
	gal309_2:1.2
	gal309_1:1.2
	gal309:1.2
	gal308_2:1.2
	gal308_1:1.2
	gal308:1.2
	gal307_2:1.2
	gal307_1:1.2
	gal307:1.2
	gal306_3:1.2
	gal306_2:1.2
	gal306_1:1.2
	gal306:1.2
	gal305_3:1.2
	gal305_2:1.2
	gal305_1:1.2
	gal305:1.2
	gal304_11:1.2
	gal304_10:1.2
	gal304_9:1.2
	gal304_8:1.2
	gal304_7:1.2
	gal304_6:1.2
	gal304_5:1.2
	gal304_4:1.2
	gal304_3:1.2
	gal304_2:1.2
	gal304_1:1.2
	gal304:1.2
	gal303_3:1.2
	gal303_2:1.2
	gal303_1:1.2
	v-303:1.2
	gal302_2:1.2
	flr:1.1.1;
locks; strict;
comment	@c @;


1.2
date	95.06.29.16.12.50;	author flr;	state Exp;
branches;
next	1.1;

1.1
date	94.12.07.14.02.03;	author flr;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	94.12.07.14.02.04;	author flr;	state Exp;
branches;
next	;


desc
@@


1.2
log
@release galeph 302
 Modified files:
 gadoc.doc itdoc.doc
 adinit.F adrz.F adview.F adxy.F gaxeph.F
 ecasig.F ecbook.F ecdigi.F echit.F ecirun.F ecista.F ecnami.F
 ectrig.F ecwsum.F edfilh.F edinip.F edtadj.F edtain.F edtcor.F
 edtcut.F edtdig.F edtono.F edtrgi.F edtzsu.F edwbru.F edwdgt.F
 ehbari.F ehcutg.F eprimi.F
 Removed Files:
 guinti.F
@
text
@*DK ectrig
      SUBROUTINE ECTRIG
C-----------------------------------------------------------------
C    G.DEBOUARD     20-JAN-86
C! EC trigger anal. signals
C
C  -Called from ECDIGI                                  this .HLB
C. - calls  ECRWRG                                      this .HLB
C.          RANNOR                                      CERNLIB
C-----------------------------------------------------------------
#ifndef DOC
      SAVE
#include "jqcom.h"
#include "ecnamc.h"
#include "ecsize.h"
#include "ewtmco.h"
#include "ewtrjj.h"
#include "ettrjj.h"
#include "edpara.h"
      DIMENSION KTHEB(NTHSG)
      LOGICAL FIRST
      DATA FIRST / .TRUE. /
#include "bmacro.h"
C ----------------------------------------------------------------------
C  ===  initialize theta boundaries in array KTHEB
C
      IF(FIRST) THEN
        CALL EDTRGI(KTHEB)
        FIRST = .FALSE.
      ENDIF
C ----------------------------------------------------------
C
C === first , compute tower trigger signals
C
      CALL ALBOS( 'ETTR', 0, LMHLEN+3*NTHSG*NPHSG, KETTR, IGARB)
      IW( KETTR+LMHCOL) = 3
      IW( KETTR+LMHROW) = NTHSG*NPHSG
      CALL BLIST (IW,'E+','ETTR')
      JETTR = KETTR + LMHLEN + 1
C
      DO 20 K=1,NTHSG
        DO 10 J=1,NPHSG
          DO 5 I=1,3
            CALL RANNOR(SIG,SIH)
            IW(JETTR) = NINT(ETTNOI(K,I) * SIG)
            JETTR     = JETTR + 1
    5     CONTINUE
   10   CONTINUE
   20 CONTINUE
C
      KETHT = IW(NAETHT)
      IF( KETHT .EQ. 0 ) GOTO 55
      NETHT = LROWS( KETHT )
      LETHT = LCOLS (KETHT)
      JETHT = KETHT + LMHLEN + 1
C
C
      DO 50 N=1,NETHT
        IETIQ = IW(JETHT)
        JPHI  = IBITS(IETIQ,2,9)
        KTHE  = IBITS(IETIQ,16,8)
C
C === computation of trigger region number NUMTR
C
        NUMTR = 0
        NUTHE = 1
   35   IF(KTHE.GT.KTHEB(NUTHE)) THEN
          NUTHE = NUTHE + 1
          GO TO 35
        ENDIF
        CALL ECRWRG(KTHE,NUREG,MAXPH)
        NUPHI = INT((NPHSG*(JPHI-1))/MAXPH) + 1
        NUMTR = (NUTHE-1)*NPHSG + NUPHI
        IF(NUMTR.LE.0.OR.NUMTR.GT.NPHSG*NTHSG) GO TO 50
        KPTR = KROW (KETTR,NUMTR)
        DO 40 I=1,3
          SIGNA = ETSTWE(I) * FLOAT(IW(JETHT+I))
          IW(KPTR+I) = IW(KPTR+I) + NINT(SIGNA)
   40   CONTINUE
        JETHT = JETHT + LETHT
   50 CONTINUE
C
C === then , compute wire trigger signals
C
   55 CONTINUE
      CALL ALBOS( 'EWTR', 0, LMHLEN+2*LMODU*LCOMP, JEWTR, IGARB)
      IW( JEWTR+LMHCOL) = 2
      IW( JEWTR+LMHROW) = LMODU*LCOMP
      CALL BLIST (IW,'E+','EWTR')
      KEWTR = JEWTR + LMHLEN
      DO 70 I=1,LMODU*LCOMP
         DO 71 J=2,LWPLA+1
            KCONS=1
C  KCONS simulates the electronic gain in stack 3
            IF(J.GE.35)         KCONS=2
            IF(MOD(J,2).EQ.0)   THEN
               IW(KEWTR+1)=IW(KEWTR+1)+IWIRES(J,I)*KCONS
            ELSE
               IW(KEWTR+2)=IW(KEWTR+2)+IWIRES(J,I)*KCONS
            ENDIF
  71     CONTINUE
  70  KEWTR=KEWTR+LEWTRA
C
 980  RETURN
      END
#endif
@


1.1
log
@Initial revision
@
text
@d12 1
a12 1
      SAVE KTHEB
@


1.1.1.1
log
@import galeph 300
@
text
@@
