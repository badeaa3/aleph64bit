head	1.5;
access;
symbols
	gal309_3:1.5
	gal309_2:1.5
	gal309_1:1.5
	gal309:1.5
	gal308_2:1.5
	gal308_1:1.5
	gal308:1.5
	gal307_2:1.5
	gal307_1:1.5
	gal307:1.5
	gal306_3:1.4
	gal306_2:1.4
	gal306_1:1.4
	gal306:1.4
	gal305_3:1.4
	gal305_2:1.4
	gal305_1:1.4
	gal305:1.4
	gal304_11:1.4
	gal304_10:1.4
	gal304_9:1.4
	gal304_8:1.4
	gal304_7:1.3
	gal304_6:1.3
	gal304_5:1.3
	gal304_4:1.3
	gal304_3:1.3
	gal304_2:1.3
	gal304_1:1.3
	gal304:1.3
	gal303_3:1.3
	gal303_2:1.3
	gal303_1:1.3
	v-303:1.2
	gal302_2:1.2
	flr:1.1.1;
locks; strict;
comment	@c @;


1.5
date	98.07.03.14.47.31;	author flr;	state Exp;
branches;
next	1.4;

1.4
date	96.06.24.08.48.41;	author flr;	state Exp;
branches;
next	1.3;

1.3
date	96.01.25.13.42.18;	author flr;	state Exp;
branches;
next	1.2;

1.2
date	95.06.29.16.22.47;	author flr;	state Exp;
branches;
next	1.1;

1.1
date	94.12.07.14.02.21;	author flr;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	94.12.07.14.02.22;	author flr;	state Exp;
branches;
next	;


desc
@@


1.5
log
@gal307 look at galeph/news/news.h
@
text
@*DK hcshow
      SUBROUTINE HCSHOW
C---------------------------------------------------------------
C
C! Parametrize showers (Geantino mode)
C!
C!           Authors     :G.Catanesi 87/12/14
C!           Mod         :G.Catanesi 89/08/01
C!           Modified by :L.Silvestris 18/3/93
C!           Modified by :A.Venturi 98/07/01
C!       take into account the change in HCSTSE arguments
C!
C!       Called by :HCHIT                         from this .HLB
C!       Calls to :CAHMOD, CAHERB, HCPROJ, HCBACK from this .HLB
C!                 HCFITU,HCSTEN,HCSTSE
C!                 HCDEIT,HTDEAD                   from Alephlib
C!
C ---------------------------------------------------------------
#ifndef DOC
      SAVE
#include "alcons.h"
#include "jobcom.h"
#include "iocom.h"
#include "hcgega.h"
#include "hccong.h"
#include "hccoun.h"
#include "hcloc.h"
#include "capano.h"
#include "tmacrod.h"
      REAL POS(3),VIN(3),VTUB(3,1)
      LOGICAL HCDEIT,LDEAD
C --------------------------------------------------------------
#include "tmacrof.h"
C --------------------------------------------------------------
C?    Here it is a shower
      IF (FHCDB2)THEN
         WRITE (LOUTIO,*)' +++HCSHOW++ ITRKEL ',
     &   (ITRKEL(I),I=1,4),TRKVOL,(ITRKEL(I),I=6,11),FTRHAD
         WRITE (LOUTIO,'(1X,''TRKELE '',10F12.4)') TRKELE
         WRITE (LOUTIO,'(1X,''TRKNXT '',10F12.4)') TRKNXT
      ENDIF
C
C - fill bank HCVL,NR=track# and common /CAHTRA/
C   get the plane# IHPLN where interaction occurs
      CALL CAHMOD (IPAR,IHPLN)
      IF (FHCDB2) THEN
        WRITE(LOUTIO,*) ' after CAHMOD IHCPOR IHCMOD IHPLN',
     &                                 IHCPOR,IHCMOD,IHPLN
      ENDIF
C
C - IF initialization (IPAR=0) THEN  RETURN
      IF (IPAR . NE. 1) GO TO 30
C
      IEMG = 0
      CALL VZERO(POS,3)
      CALL CAHERB(EMGNRJ,IEMG,POS,NBEM)
      IF (IEMG.LT.1) GO TO 20
      IF(IHPLN.LT.1.OR.(IHPLN.GT.NHCPLA(IHCPOR))) GO TO 20
      IPOR = IHCPOR
      IMOD = IHCMOD
      IGO = SIGN(1.,HCPDIP)
      HCENMN = 0.
C
      IF (IEMG .EQ. 0) GO TO 20
C
      NEM = 0
C   LOOP ON E.M. SHOWER IN HCAL
   10 CONTINUE
      NBEM = 0
      IF (IEMG.EQ.0) GO TO 20
      CALL VZERO(POS,3)
      CALL CAHERB(EMGNRJ,IEMG,POS,NBEM)
      IF (NBEM .GT.0) NEM = NEM+1
      IF(NBEM.EQ.0) GO TO 10
C
C?....Search projection on sensible plane
C
      IF (FHCDB2) THEN
         WRITE(LOUTIO,*) ' before HCPROJ - POS ',POS
      ENDIF
      CALL HCPROJ(POS,IHPLN,IGO,KLEAV)
C..
C?....Transform back to the Aleph reference system
C..
      IF (FHCPRJ) THEN
         CALL HCBACK(POS,KLEAV,VIN,XX,YY)
C?        find tube number
         YY = ABS(YY)
         DY = 0.
         CALL HCFITU(IHCPOR,IHCIPL,YY,DY,ITUBF,NTUB,YPART,NTUSP,WSPAC)
C
C?        Store information in HCSE bank
         IF (NTUB.GT.0) THEN
            IHCIPL = IHPLN
C
C          if required kill not working tubes
            IF(ICHCJO(6).EQ.0)THEN
               LDEAD = HCDEIT(ITUBF,IHCIPL,IHCMOD,IHCPOR)
               IF(LDEAD)GOTO 40
            ENDIF
C
C - Kill tubes for inefficency if required
C
            IF(ICHCJO(5).EQ.0)THEN
               IF(RNDM(DUM).GE.HCTEFF(IHCPOR)) ITUBF = -ITUBF
               IF(ITUBF.LT.0) GOTO 40
            ENDIF
C
C          Take in account dead zones inside tubes
            IF(ICHCJO(3).EQ.0)THEN
               DXX = 0.
               CALL HTDEAD(XX,DXX,ITUBF,IDEAD)
               IF(IDEAD.EQ.1)GOTO 40
            ENDIF
C
C?          Take in account single streamer energy deposit fluctuation
            HCENOR = HCSTEN(1)
            IF (FHCDB2) THEN
              WRITE(LOUTIO,*)
     &       ' before HCSTSE VIN XX YY IHCPOR IHCIPL IHCMOD ITUBF= ',
     &                       VIN,XX,YY,IHCPOR,IHCIPL,IHCMOD,ITUBF
            ENDIF 
            VTUB(1,1)=VIN(1)
            VTUB(2,1)=VIN(2)
            VTUB(3,1)=VIN(3)
            CALL HCSTSE(VTUB,IHCPOR,IHCMOD,IHCIPL,YY,XX,HCENOR,ITUBF,1)
         ENDIF
 40      CONTINUE
      ENDIF
C?....End of loop
C
      IHCPOR = IPOR
      IHCMOD = IMOD
C.................................................
C?Check if shower enters a new module to change step
C
      IF (IEMG.NE.0) GO TO 10
C
   20 CONTINUE
C
      IF (IHPLN.EQ.NHCPLA(IHCPOR)) THEN
C-    STOP GEANTINO TRACKING
         ITRKEL (9) = NOMOR
      ENDIF
   30 CONTINUE
C
      END
#endif
@


1.4
log
@release corr.file no.8, bug in hcshow
@
text
@d10 2
d30 1
a30 1
      REAL POS(3),VIN(3)
d123 4
a126 1
            CALL HCSTSE(VIN,IHCPOR,IHCMOD,IHCIPL,YY,XX,HCENOR,ITUBF,1)
@


1.3
log
@put a ifndef DOC in gdray
modify WRITE statment to please fpp on alpha/vms
 Modified Files:
 	catino.F
 Modified Files:
	agchck.F
 Modified Files:
 	gdray.F
 Modified Files:
 	hchist.F hcshow.F hcstat.F hnewtk.F
@
text
@d3 1
a3 1
C------------------------------------------------------------
d16 1
a16 1
C ----------------------------------------
d30 1
a30 1
C =====================================================
d32 1
a32 1
C ------------------------------------------------------------
a42 2
C - initialization ihpln=99
      IHPLN = 99
d44 4
d56 3
a58 3
      ISS = IHPLN
      IF(ISS.LT.1.OR.(ISS.GT.NHCPLA(IHCPOR))) GO TO 20
      IPOR0 = IHCPOR
a60 1
      ILEAV = 999
d76 4
a79 1
      CALL HCPROJ(POS,ISS,IGO,KLEAV)
a91 1
            IMOD = IHCMOD
d116 6
a121 1
            CALL HCSTSE(VIN,IHCPOR,IMOD,IHCIPL,YY,XX,HCENOR,ITUBF,1)
d127 2
a128 1
      IHCPOR = IPOR0
@


1.2
log
@release galeph 302
 Modified files:
 gadoc.doc itdoc.doc
 adinit.F adrz.F adview.F adxy.F gaxeph.F
 ecasig.F ecbook.F ecdigi.F echit.F ecirun.F ecista.F ecnami.F
 ectrig.F ecwsum.F edfilh.F edinip.F edtadj.F edtain.F edtcor.F
 edtcut.F edtdig.F edtono.F edtrgi.F edtzsu.F edwbru.F edwdgt.F
 ehbari.F ehcutg.F eprimi.F
 galeph.F qnext.F
 agbeam.F agchck.F agcoil.F agecal.F agecpm.F ageome.F aggean.F
 aghcal.F agitch.F aglcal.F agmate.F agmedi.F agmuch.F agquad.F
 agscal.F agsmba.F agtpch.F
 gstmed.F guhadr.F guphad.F gustep.F gutrak.F
 Removed Files:
 guinti.F
 aggatt.F aggord.F
@
text
@d35 2
a36 3
         WRITE (LOUTIO,'(/1X,''+++HCSHOW++ ITRKEL '',4I5,1X,A4,
     &                   6I5,L4)')
     &     (ITRKEL(I),I=1,4),TRKVOL,(ITRKEL(I),I=6,11),FTRHAD
@


1.1
log
@Initial revision
@
text
@d15 2
a16 1
C ---------------------------------------------------------
d30 1
@


1.1.1.1
log
@import galeph 300
@
text
@@
