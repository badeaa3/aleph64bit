head	1.2;
access;
symbols
	gal309_3:1.2
	gal309_2:1.2
	gal309_1:1.2
	gal309:1.2
	gal308_2:1.2
	gal308_1:1.2
	gal308:1.2
	gal307_2:1.2
	gal307_1:1.2
	gal307:1.2
	gal306_3:1.2
	gal306_2:1.2
	gal306_1:1.2
	gal306:1.2
	gal305_3:1.2
	gal305_2:1.2
	gal305_1:1.2
	gal305:1.2
	gal304_11:1.2
	gal304_10:1.2
	gal304_9:1.2
	gal304_8:1.2
	gal304_7:1.2
	gal304_6:1.2
	gal304_5:1.2
	gal304_4:1.2
	gal304_3:1.2
	gal304_2:1.2
	gal304_1:1.2
	gal304:1.2
	gal303_3:1.2
	gal303_2:1.2
	gal303_1:1.2
	v-303:1.2
	gal302_2:1.2
	flr:1.1.1;
locks; strict;
comment	@c @;


1.2
date	95.06.29.16.22.16;	author flr;	state Exp;
branches;
next	1.1;

1.1
date	94.12.07.14.02.18;	author flr;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	94.12.07.14.02.19;	author flr;	state Exp;
branches;
next	;


desc
@@


1.2
log
@release galeph 302
 Modified files:
 gadoc.doc itdoc.doc
 adinit.F adrz.F adview.F adxy.F gaxeph.F
 ecasig.F ecbook.F ecdigi.F echit.F ecirun.F ecista.F ecnami.F
 ectrig.F ecwsum.F edfilh.F edinip.F edtadj.F edtain.F edtcor.F
 edtcut.F edtdig.F edtono.F edtrgi.F edtzsu.F edwbru.F edwdgt.F
 ehbari.F ehcutg.F eprimi.F
 galeph.F qnext.F
 agbeam.F agchck.F agcoil.F agecal.F agecpm.F ageome.F aggean.F
 aghcal.F agitch.F aglcal.F agmate.F agmedi.F agmuch.F agquad.F
 agscal.F agsmba.F agtpch.F
 gstmed.F guhadr.F guphad.F gustep.F gutrak.F
 Removed Files:
 guinti.F
 aggatt.F aggord.F
@
text
@*DK hchise
      SUBROUTINE HCHISE
C --------------------------------------------------------------
C - F.RANJARD - 860619            modified - 890801
C! order HTHT in increasing order of storey address
C  modify HCSE accordingly
C - Called by   HCASIG                                from this .HLB
C --------------------------------------------------------
#ifndef DOC
      SAVE
#include "jobcom.h"
#include "iocom.h"
#include "bcs.h"
#include "hccoun.h"
#include "hcnamc.h"
#include "hthtjj.h"
#include "hcsejj.h"
      INTEGER JDCKEY
      DATA JDCKEY /0/
#include "bmacro.h"
C -------------------------------------------------------------------
      JHTHT = IW(NAHTHT)
      IF (JHTHT.EQ.0) GOTO 999
      NHTHT = LROWS(JHTHT)
      IF (NHTHT.EQ.0) GOTO 999
      IF (FHCDB1) THEN
         KHCSE = JDHCSE + LMHLEN
         WRITE (IW(6),802) (IW(K+JHCSFS),K=KHCSE,KHCSE+LROWS(JDHCSE)*
     &                      LHCSEA-1,LHCSEA)
      ENDIF
C
C - get the positions in HTHT of storey addresses
      CALL WBANK (IW,JDCKEY,NHTHT,*998)
      DO 1 I=1,NHTHT
         IW(JDCKEY+I) = (I-1)*LHTHTA + JHTHSA
 1    CONTINUE
C
C - get the position in HTHT of storey addresses when they are in
C   increasing order
      CALL SORTZV (IW(JHTHT+LMHLEN+1),IW(JDCKEY+1),NHTHT,-1,0,1)
C
C - get the new row # instead of the new position
      DO 2 I=1,NHTHT
         IW(JDCKEY+I) = (IW(JDCKEY+I) - JHTHSA)/LHTHTA + 1
 2    CONTINUE
C
C - update HCSE
      KHCSE = JDHCSE + LMHLEN
      NHCSE = LROWS(JDHCSE)
      DO 3 I=1,LROWS(JDHCSE)
         IF (IW(KHCSE+JHCSFS).EQ.0) GOTO 3
         IW(KHCSE+JHCSFS) = IUCOMP(IW(KHCSE+JHCSFS),IW(JDCKEY+1),NHTHT)
 3    KHCSE = KHCSE + LHCSEA
      KHCSE = JDHCSE + LMHLEN
C
C - reoder HTHT in increasing order of storey address
      CALL SORTIQ (IW(JHTHT+LMHLEN+1),LHTHTA,NHTHT,JHTHSA)
C
C - debug
      IF (FHCDB1) THEN
         WRITE (IW(6),'(/1X,''+++HCHISE+++ HTHT in increasing order'')')
         KHTHT = JHTHT + LMHLEN
         WRITE (IW(6),801) ((IW(K+I),I=1,3),RW(K+4),K=KHTHT,KHTHT+
     &                      NHTHT*LHTHTA-1,LHTHTA)
         KHCSE = JDHCSE + LMHLEN
         WRITE (IW(6),802) (IW(K+JHCSFS),K=KHCSE,KHCSE+LROWS(JDHCSE)*
     &                      LHCSEA-1,LHCSEA)
      ENDIF
 999  CONTINUE
      CALL WDROP (IW,JDCKEY)
      RETURN
 801  FORMAT (3(I10,I4,I4,F10.5,5X))
 802  FORMAT (/1X,'+++HCHISE+++ HCSE word(15): HTHT row n0.'/(5X,25I4))
C - NOT enough space to enlarge work bank
 998  CALL WDROP (IW,JDCKEY)
      CALL ALTELL ('HCHISE: BOS array too small',1,'NEXT')
      END
#endif
@


1.1
log
@Initial revision
@
text
@d8 1
a8 1
C --------------------------------------------------------------------
d10 1
@


1.1.1.1
log
@import galeph 300
@
text
@@
