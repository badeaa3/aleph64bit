head	1.3;
access;
symbols
	gal309_3:1.3
	gal309_2:1.3
	gal309_1:1.3
	gal309:1.3
	gal308_2:1.3
	gal308_1:1.3
	gal308:1.3
	gal307_2:1.3
	gal307_1:1.3
	gal307:1.3
	gal306_3:1.3
	gal306_2:1.3
	gal306_1:1.3
	gal306:1.3
	gal305_3:1.3
	gal305_2:1.3
	gal305_1:1.3
	gal305:1.3
	gal304_11:1.3
	gal304_10:1.3
	gal304_9:1.3
	gal304_8:1.3
	gal304_7:1.3
	gal304_6:1.3
	gal304_5:1.3
	gal304_4:1.3
	gal304_3:1.3
	gal304_2:1.3
	gal304_1:1.3
	gal304:1.3
	gal303_3:1.3
	gal303_2:1.3
	gal303_1:1.3
	v-303:1.2
	gal302_2:1.2
	flr:1.1.1;
locks; strict;
comment	@c @;


1.3
date	96.01.25.13.42.22;	author flr;	state Exp;
branches;
next	1.2;

1.2
date	95.06.29.16.22.49;	author flr;	state Exp;
branches;
next	1.1;

1.1
date	94.12.07.14.02.21;	author flr;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	94.12.07.14.02.22;	author flr;	state Exp;
branches;
next	;


desc
@@


1.3
log
@put a ifndef DOC in gdray
modify WRITE statment to please fpp on alpha/vms
 Modified Files:
 	catino.F
 Modified Files:
	agchck.F
 Modified Files:
 	gdray.F
 Modified Files:
 	hchist.F hcshow.F hcstat.F hnewtk.F
@
text
@*DK hcstat
      SUBROUTINE HCSTAT
C --------------------------------------------
C
C! Statistics on single event
C!
C!        Author    :G.Catanesi  87/07/10
C!
C!   -Called by : HCASIG
C!   -Calls     : HCVRTX
C ---------------------------------------------------
#ifndef DOC
      SAVE
#include "jqcom.h"
#include "jobcom.h"
#include "hccoun.h"
#include "iocom.h"
#include "hcnamc.h"
      CHARACTER*4 TVOLU,CHAINT,CTABL
      LOGICAL FMUON,FNUNO,FEGAM,FHADR
      FMUON(IJKL) = IJKL.EQ.5 .OR. IJKL.EQ.6
      FEGAM(IJKL) = IJKL.LE.3
      FNUNO(IJKL) = IJKL.EQ.4
      FHADR(IJKL) = IJKL.GT.6
#include "bmacro.h"
#include "kmacro.h"
      CTABL (ID,NRBOS,L) = CHAINT(ITABL(ID,NRBOS,L))
C ------------------------------------------------------------------
C
      NHCSE = LROWS(JDHCSE)
      NHCHI = LROWS(JDHCHI)
      KHCHI = JDHCHI + LMHLEN
      NSTRM = 0
      DO 10 I=1,NHCHI
         NSTRM = NSTRM + IW(KHCHI+4)
   10 KHCHI = KHCHI + LCOLS(JDHCHI)
      JHTHT = IW(NAHTHT)
      NHTHT = LROWS (JHTHT)
      ETOT = 0.
      KHTHT = JHTHT + LMHLEN
      DO 20 I=1,NHTHT
         ETOT = ETOT + RW(KHTHT+4)
   20 KHTHT = KHTHT + LCOLS(JHTHT)
      JHWHT = IW(NAHWHT)
      NHWHT = LROWS (JHWHT)
C
      NHCC02 = NHCC02+NHCSE
      NHCC03 = NHCC03+NHWHT
      NHCC04 = NHCC04+NHTHT
      NHCC05 = NHCC05+1
      HCEAVE = HCEAVE + ETOT
      HCANST = HCANST + FLOAT(NSTRM)
C
C? this option is active only in the debug case
C
      IF(FHCDB2) THEN
C
         NHCTH = LROWS(JDHCTH)
         JKVOL = IW(NAKVOL)
C
C? select entering particles from the total sample of tracks in HCAL
C
         DO 60 J=1,NHCTH
C
            NKINE = ITABL(JDHCTH,J,1)
   30       JKINE = NLINK ('KINE',NKINE)
            NVERT = INPVRT (JKINE)
            TVOLU = CHAINT (ITABL(JKVOL,NVERT,1))
            IF (TVOLU(1:1) .EQ. 'H') THEN
               JVERT = NLINK ('VERT',NVERT)
               NKINE = INPTRK(JVERT)
               GOTO 30
            ELSE
               DO 40 JROW = 1,LROWS(JDHCTH)
                  IF (NKINE .EQ. ITABL(JDHCTH,JROW,1)) THEN
                     KHCTH = KROW (JDHCTH,JROW)
                     GOTO 50
                  ENDIF
   40          CONTINUE
C?                add track# NKINE in JDHCTH
               IF (LFRROW(JDHCTH) .EQ. 0) THEN
                  CALL WBANK (IW,JDHCTH,IW(JDHCTH)*2,*90)
               ENDIF
               JROW = LROWS(JDHCTH) + 1
               KHCTH = KNEXT(JDHCTH)
               IW(KHCTH+1) = NKINE
               IW(JDHCTH+LMHROW) = JROW
C                 update the energy deposited
   50          CONTINUE
               IW(KHCTH+2) = KINTYP (JKINE)
               RW(KHCTH+4) = ENERVK (JKINE)
               IF (J .NE. JROW) RW(KHCTH+5) = RW(KHCTH+5) + RTABL
     +         (JDHCTH,J,5)
               IW(KHCTH+6) = 1
            ENDIF
   60    CONTINUE
C
C? Write statistical informations about this event
C
         WRITE(LOUTIO,500)
         WRITE(LOUTIO,510)NEVTJO
         WRITE(LOUTIO,520)NHCSE,NHWHT,NHTHT,NSTRM,ETOT
         WRITE(LOUTIO,530)(HCEPOR(J) ,J=1,3)
C
         NHCET = 0
         DO 70 I = 1,LROWS (JDHCTH)
            NHCET = NHCET + ITABL(JDHCTH,I,6)
   70    CONTINUE
         WRITE(LOUTIO,540)NHCET
         WRITE(LOUTIO,550)
C
C?  Loop on HCAL entering particles
C
         ETOT = 0.
         VETOT = 0.
         NEGAM = 0
         NNEUT = 0
         NMUON = 0
         NHADC = 0
         NHADN = 0
         EGAM = 0.
         ENEU = 0.
         EMUON = 0.
         EHADC = 0.
         EHADN = 0.
         VEGAM = 0.
         VENEU = 0.
         VMUON = 0.
         VHADC = 0.
         VHADN = 0.
         KHCTH = JDHCTH + LMHLEN
         DO 80 J=1,NHCTH
            IF (IW(KHCTH+6) .EQ. 0) GOTO 80
C
C? founds the particle type
C
            ITYPE = IW(KHCTH+2)
C
C?  Groups together similar kind of particles
C
            IF(FMUON(ITYPE) .AND. RW(KHCTH+4).GT.2.) THEN
               VETOT = VETOT + 4.
            ELSE
               VETOT = VETOT + RW(KHCTH+4) + PARMAS(ITYPE)* HPANTP
     +         (ITYPE)
            ENDIF
C
            ETOT = ETOT + RW(KHCTH+4)
C
            IF (FEGAM(ITYPE)) THEN
               NEGAM = NEGAM + 1
               EGAM = EGAM + RW(KHCTH+4)
               VEGAM = VEGAM + RW(KHCTH+5)
            ELSEIF(FNUNO(ITYPE))THEN
               NNEUT = NNEUT + 1
               ENEU = ENEU + RW(KHCTH+4)
               VENEU = VENEU + RW(KHCTH+5)
            ELSEIF(FMUON(ITYPE))THEN
               NMUON = NMUON + 1
               EMUON = EMUON + RW(KHCTH+4)
               VMUON = VMUON + RW(KHCTH+5)
            ELSEIF(FHADR(ITYPE))THEN
               IF(CHARGE(ITYPE).NE.0.)THEN
                  NHADC = NHADC + 1
                  EHADC = EHADC + RW(KHCTH+4)
                  VHADC = VHADC + RW(KHCTH+5)
               ELSE
                  NHADN = NHADN + 1
                  EHADN = EHADN + RW(KHCTH+4)
                  VHADN = VHADN + RW(KHCTH+5)
               ENDIF
            ENDIF
C
C print particle entering list if the level 1 of the printout in on
C
            IF(ICHCJO(1).GT.0)THEN
               JPART = IW(NAPART)
               WRITE(LOUTIO,560)J,IW(KHCTH+1),(RW(KHCTH+II),II=3,5) ,
     +         CTABL(JPART,ITYPE,2),CTABL(JPART,ITYPE,3),CTABL(JPART,
     +         ITYPE,4)
            ENDIF
C
            KHCTH = KHCTH + LCOLS(JDHCTH)
   80    CONTINUE
C
         VETOT = VETOT - ENEU
C
         WRITE(LOUTIO,570)ETOT,VETOT, EGAM,VEGAM,NEGAM, ENEU,VENEU,
     +   NNEUT, EMUON,VMUON,NMUON, EHADC,VHADC, NHADC, EHADN,VHADN,
     +   NHADN
C
      ENDIF
      GOTO 100
C
   90 CONTINUE
      WRITE (LOUTIO,*)' +++HCSTAT+++  not enough space for ',
     &                'JDHCTH : NO printout'
C
  100 CONTINUE
      CALL WDROP(IW,JDHCTH)
      RETURN
  500 FORMAT(3X,'  +++ HCSTAT +++ ')
  510 FORMAT(3X,'EVENT NUMBER ==>',I5)
  520 FORMAT(3X,'number of tube segments = ',I8/ 3X,
     +'number of fired tubes   = ',I8/ 3X,'number of fired storeys = ',
     +I8/ 3X,'number of streamers     = ',I8/ 3X,
     +'energy  seen in Had Cal = ',F10.2)
  530 FORMAT(3X,'End-Cap A ',5X,'  Barrel  ',5X, 'End-Cap B ',5X,  3
     +(F10.2,5X))
  540 FORMAT(3X,'Number of tracks entering in HC (',I6,')')
  550 FORMAT(3X,'         ',3X,' Track # ',3X,'E HC bord.', 4X,
     +'E at vertex',4X,'Energy meas.',3X, 'Particle type')
  560 FORMAT(1X,I9,3X,I9,5X,F9.4,4X,F9.4,4X,F9.4,9X,3A4)
  570 FORMAT(3X,'Total Energy of entering particles = ', F10. 2,
     +' GeV with ',F10.2,'GeV of visible energy '//, 3X,
     +' Energy    :        entering    measured  # of particles'/ 3X,
     +' e/gamma   :',7X,F10.2,4X,F10.2,4X,I8/ 3X,' neutrinos :',7X,F10.
     +2,4X,F10.2,4X,I8/ 3X,' muons     :',7X,F10.2,4X,F10.2,4X,I8/ 3X,
     +' Char. Hadr:',7X,F10.2,4X,F10.2,4X,I8/ 3X,' Neut. Hadr:',7X,F10.
     +2,4X,F10.2,4X,I8)
      END
#endif
@


1.2
log
@release galeph 302
 Modified files:
 gadoc.doc itdoc.doc
 adinit.F adrz.F adview.F adxy.F gaxeph.F
 ecasig.F ecbook.F ecdigi.F echit.F ecirun.F ecista.F ecnami.F
 ectrig.F ecwsum.F edfilh.F edinip.F edtadj.F edtain.F edtcor.F
 edtcut.F edtdig.F edtono.F edtrgi.F edtzsu.F edwbru.F edwdgt.F
 ehbari.F ehcutg.F eprimi.F
 galeph.F qnext.F
 agbeam.F agchck.F agcoil.F agecal.F agecpm.F ageome.F aggean.F
 aghcal.F agitch.F aglcal.F agmate.F agmedi.F agmuch.F agquad.F
 agscal.F agsmba.F agtpch.F
 gstmed.F guhadr.F guphad.F gustep.F gutrak.F
 Removed Files:
 guinti.F
 aggatt.F aggord.F
@
text
@d196 2
a197 2
      WRITE (LOUTIO,'(/1X,''+++HCSTAT+++  not enough space for '',
     +                    ''JDHCTH : NO printout'')')
@


1.1
log
@Initial revision
@
text
@d11 1
a11 1
C ------------------------------------------------------
@


1.1.1.1
log
@import galeph 300
@
text
@@
