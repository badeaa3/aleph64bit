head	1.2;
access;
symbols
	gal309_3:1.2
	gal309_2:1.2
	gal309_1:1.2
	gal309:1.2
	gal308_2:1.2
	gal308_1:1.2
	gal308:1.2
	gal307_2:1.2
	gal307_1:1.2
	gal307:1.2
	gal306_3:1.2
	gal306_2:1.2
	gal306_1:1.2
	gal306:1.2
	gal305_3:1.2
	gal305_2:1.2
	gal305_1:1.2
	gal305:1.2
	gal304_11:1.2
	gal304_10:1.2
	gal304_9:1.2
	gal304_8:1.2
	gal304_7:1.2
	gal304_6:1.2
	gal304_5:1.2
	gal304_4:1.2
	gal304_3:1.2
	gal304_2:1.2
	gal304_1:1.2
	gal304:1.2
	gal303_3:1.2
	gal303_2:1.2
	gal303_1:1.2
	v-303:1.2
	gal302_2:1.2
	flr:1.1.1;
locks; strict;
comment	@c @;


1.2
date	95.06.29.16.22.08;	author flr;	state Exp;
branches;
next	1.1;

1.1
date	94.12.07.14.02.17;	author flr;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	94.12.07.14.02.18;	author flr;	state Exp;
branches;
next	;


desc
@@


1.2
log
@release galeph 302
 Modified files:
 gadoc.doc itdoc.doc
 adinit.F adrz.F adview.F adxy.F gaxeph.F
 ecasig.F ecbook.F ecdigi.F echit.F ecirun.F ecista.F ecnami.F
 ectrig.F ecwsum.F edfilh.F edinip.F edtadj.F edtain.F edtcor.F
 edtcut.F edtdig.F edtono.F edtrgi.F edtzsu.F edwbru.F edwdgt.F
 ehbari.F ehcutg.F eprimi.F
 galeph.F qnext.F
 agbeam.F agchck.F agcoil.F agecal.F agecpm.F ageome.F aggean.F
 aghcal.F agitch.F aglcal.F agmate.F agmedi.F agmuch.F agquad.F
 agscal.F agsmba.F agtpch.F
 gstmed.F guhadr.F guphad.F gustep.F gutrak.F
 Removed Files:
 guinti.F
 aggatt.F aggord.F
@
text
@*DK hcfopl
      SUBROUTINE HCFOPL
C--------------------------------------------------------------------
C
C!  Implements the module FORMAT PLANE SIGNAL
C!
C!          Author : G.Catanesi 03/02/1989
C!
C!          Input bank : HPHT
C!          Output bank: HPDI
C!
C!
C!        -Called by : HCDIGI
C!        -Calls     : SORTIQ,MVBITS from CERNLIB
C ------------------------------------------
#ifndef DOC
      SAVE
#include "jobcom.h"
#include "bcs.h"
#include "iocom.h"
#include "hcnamc.h"
#include "hphtjj.h"
#include "hpdijj.h"
#include "hccoun.h"
#include "bmacro.h"
C ------------------------------------------------------------
C
      JHPHT = IW(NAHPHT)
      IF (JHPHT.EQ.0) RETURN
      NHPHT = LROWS (JHPHT)
      IF (NHPHT.EQ.0) RETURN
C
C      Loop on Planes
C
      KHPHT = JHPHT +LMHLEN
C
      CALL SORTIQ (IW(KHPHT+1),LHPHTA,NHPHT,1)
C
      JHPDI = IW(NAHPDI)
      KHPDI = JHPDI + LMHLEN
C
      NHPDI = 0
      IPL1 = 0
      IMO1 = 0
      DO 10 I = 1, NHPHT
         N = IW(KHPHT+1)
         IPL = MOD(N,100)
         N = N / 100
         IMO = MOD(N,100)
         N = N / 100
         IPO = N
         NED = INT(RW(KHPHT+2)*1000.)
         IF(IMO.NE.IMO1.OR.IPL.NE.IPL1) THEN
            IMO1 = IMO
            IPL1 = IPL
            NHPDI = NHPDI + 1
            KHPDI = KROW(JHPDI,NHPDI)
            IPLM = IPL
            CALL MVBITS(IPLM,0,8,IW(KHPDI+JHPDPA),0)
            IMOM = IMO
            CALL MVBITS(IMOM,0,8,IW(KHPDI+JHPDPA),8)
C
            CALL MVBITS(IPO,0,8,IW(KHPDI+JHPDPA),16)
         ENDIF
C
            IW(KHPDI+JHPDED) = NED
         KHPHT = KHPHT + LHPHTA
   10 CONTINUE
C
      IW(JHPDI+LMHROW) = NHPDI
C
      IF(FHCDEB)THEN
         WRITE(LOUTIO,500) NHPDI
         KHPDI = JHPDI + LMHLEN
         DO 20 I = 1, NHPDI
            IPL = IBITS(IW(KHPDI+JHPDPA),0,8)
            IMO = IBITS(IW(KHPDI+JHPDPA),8,8)
            IPO = IBITS(IW(KHPDI+JHPDPA),16,8)
            IEPLA = IW(KHPDI+JHPDED)
            WRITE(LOUTIO,510)I,IPL,IMO,IPO,IEPLA
            KHPDI = KHPDI + LHPDIA
   20    CONTINUE
      ENDIF
      RETURN
  500 FORMAT (/1X,'+++HCFOPL+++ HPDI McHcPlanesDigitising ',I5/
     +' Plan#  Pla  Mod  Por     Energy ')
  510 FORMAT(4I5,I10)
      END
#endif
@


1.1
log
@Initial revision
@
text
@d15 1
a15 1
C ------------------------------------------------------------
d17 1
@


1.1.1.1
log
@import galeph 300
@
text
@@
