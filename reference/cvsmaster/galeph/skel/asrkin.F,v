head	1.2;
access;
symbols
	gal309_3:1.2
	gal309_2:1.2
	gal309_1:1.2
	gal309:1.2
	gal308_2:1.2
	gal308_1:1.2
	gal308:1.2
	gal307_2:1.2
	gal307_1:1.2
	gal307:1.2
	gal306_3:1.2
	gal306_2:1.2
	gal306_1:1.2
	gal306:1.2
	gal305_3:1.2
	gal305_2:1.2
	gal305_1:1.2
	gal305:1.2
	gal304_11:1.2
	gal304_10:1.2
	gal304_9:1.2
	gal304_8:1.2
	gal304_7:1.2
	gal304_6:1.2
	gal304_5:1.2
	gal304_4:1.2
	gal304_3:1.2
	gal304_2:1.2
	gal304_1:1.2
	gal304:1.2
	gal303_3:1.2
	gal303_2:1.2
	gal303_1:1.2
	v-303:1.2
	gal302_2:1.2
	flr:1.1.1;
locks; strict;
comment	@c @;


1.2
date	95.06.30.07.13.43;	author flr;	state Exp;
branches;
next	1.1;

1.1
date	94.12.07.14.01.46;	author flr;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	94.12.07.14.01.47;	author flr;	state Exp;
branches;
next	;


desc
@@


1.2
log
@release galeph 302
 Modified files:
 gadoc.doc itdoc.doc
 adinit.F adrz.F adview.F adxy.F gaxeph.F
 ecasig.F ecbook.F ecdigi.F echit.F ecirun.F ecista.F ecnami.F
 ectrig.F ecwsum.F edfilh.F edinip.F edtadj.F edtain.F edtcor.F
 edtcut.F edtdig.F edtono.F edtrgi.F edtzsu.F edwbru.F edwdgt.F
 ehbari.F ehcutg.F eprimi.F
 galeph.F qnext.F
 agbeam.F agchck.F agcoil.F agecal.F agecpm.F ageome.F aggean.F
 aghcal.F agitch.F aglcal.F agmate.F agmedi.F agmuch.F agquad.F
 agscal.F agsmba.F agtpch.F
 gstmed.F guhadr.F guphad.F gustep.F gutrak.F
 cahtra.h gmacro.h lccomc.h lcnamc.h ljjpar.h siconst.h
 sigeco.h version.h
 itmsk1.F itmsk2.F itnois.F itres.F itxtlk.F
 lcadc.F lcamp.F lcasig.F lcbhab.F lcbkpr.F lcdigi.F lcfral.F
 lchit.F lcirun.F lcnami.F lcnois.F lcpad.F lcroc.F lcsamp.F
 lcsatu.F lcshow.F lcstrt.F lctrak.F lctrdi.F lctrht.F lcwire.F
 lcwsum.F lcwtri.F
 muasig.F mubook.F muirun.F muunoi.F muwsum.F
 trignews.h
 siasig.F sitrak.F siwsum.F
 asasig.F asbook.F ascjob.F ascrun.F asctra.F asevst.F asfxxx.F
 asieve.F asigea.F asijob.F asimod.F asinit.F asipac.F asirun.F
 askine.F asksin.F asktrk.F aspeve.F asprun.F asread.F asredc.F
 asreve.F asrkin.F asrtyp.F asrust.F astdeb.F astgea.F astrac.F
 astrig.F aswkin.F aswrtp.F aswsum.F
 Removed Files:
 guinti.F
 aggatt.F aggord.F
 xtrcom.h
 ecalnews.h geomnews.h lcalnews.h news.h skelnews.h vdetnews.h
@
text
@*DK asrkin
      SUBROUTINE ASRKIN
C ----------------------------------------------------------
C - F.Ranjard - 851023
C - Transfer contents of 'VERT' banks to Geant3 'VERT' banks
C   and do the same for 'KINE' banks
C - Drop 'VERT' and 'KINE' BOS banks
C   release space.
C - Called from    ASRETP                    from this .HLB
C - Calls          MZBOOK                    from ZEBRA.lib
C                  BDROP                     from BOS77.hlb
C ----------------------------------------------
#ifndef DOC
      SAVE
#include "jqcom.h"
#include "iocom.h"
#include "jobcom.h"
#include "gcbank.h"
#include "gcnum.h"
#include "kincom.h"
      DATA IFI /0/
#include "bmacro.h"
#include "kmacro.h"
C --------------------------------------------------------------
C
C - Get the ALEPHLIB version # used in KINGAL or GALEPH
      IF (IFI .EQ. 0) THEN
         IFI = 1
         CALL KIAVER (AVER,IPROG)
      ENDIF
C - Get PART bank index
      JPART = IW(NAPART)
C
C - Transfer 'VERT' banks
C
      CALL MZBOOK (IGXDIV,JGVERT,JGVERT,1,'VERT',NIVXKI,NIVXKI,1,2,0)
      IGB(JGVERT-5) = 0
      KV = NLINK ('VERT',1)
 6    CONTINUE
      IF (KV.NE.0) THEN
         NVX  = IW(KV-2)
         IF (NVX .GT. NIVXKI) GOTO 69
         KV1 = KPARVK(KV)
         KV2 = KLISVK(KV)
         CALL MZBOOK (IGXDIV,JV,JGVERT,-NVX,'VERT',0,0,IW(KV+3)+7,3,0)
         GB(JV+1) = RW(KV1+1)
         GB(JV+2) = RW(KV1+2)
         GB(JV+3) = RW(KV1+3)
         GB(JV+4) = RW(KV1+4)
         GB(JV+5) = IW(KV1+5)
         GB(JV+6) = 0.
         GB(JV+7) = NOFVK(KV)
         DO 61 N=1,NOFVK(KV)
            GB(JV+7+N) = IW(KV2+N)
 61      CONTINUE
         NGVERT = MAX (NVX,NGVERT)
         IGB(JGVERT+1) = NGVERT
         KV = IW(KV-1)
         GOTO 6
      ENDIF
 69   CONTINUE
C
C - Transfer 'KINE' banks
C
      CALL MZBOOK (IGXDIV,JGKINE,JGKINE,1,'KINE',NITRKI,NITRKI,1,2,0)
      IGB(JGKINE-5) = 0
      KK = NLINK ('KINE',1)
7     CONTINUE
      IF (KK.NE.0) THEN
         NKI  = IW(KK-2)
         IF (NKI .GT. NITRKI) GOTO 79
         KK1  = KPARVK(KK)
         KK2  = KLISVK(KK)
         CALL MZBOOK (IGXDIV,JK,JGKINE,-NKI,'KINE',0,0,IW(KK+3)+6,3,0)
         GB(JK+1) = RW(KK1+1)
         GB(JK+2) = RW(KK1+2)
         GB(JK+3) = RW(KK1+3)
C        In the ALEPHLIB 9.0 the KINE and FKIN banks have been modified
C        word(4) has been changed to contain mass instead of energy.
C        to be backward compatible the following test is necessary.
C        when files created with an ALEPHLIB earlier than 9.0 will have
C        disappeared only the statment GB(JK+4)=ENERVK(KK) will be necessary.
         IF (AVER .LT. 9.0) THEN
            GB(JK+4) = RW(KK1+4)
         ELSE
            GB(JK+4) = ENERVK(KK)
         ENDIF
         GB(JK+5) = ITABL (JPART,IW(KK2),1)
         GB(JK+6) = IW(KK2+1)
         GB(JK+7) = NOFVK(KK)-1
         DO 71 N=2,NOFVK(KK)
            GB(JK+6+N) = IW(KK2+N)
 71      CONTINUE
         NGTRAC = MAX (NKI,NGTRAC)
         IGB(JGKINE+1) = NGTRAC
         KK = IW(KK-1)
         GOTO 7
      ENDIF
 79   CONTINUE
C
C ----------- end -------------------------------------
 999  CONTINUE
      RETURN
      END
#endif
@


1.1
log
@Initial revision
@
text
@d12 1
a12 1
C ----------------------------------------------------------
d14 1
@


1.1.1.1
log
@import galeph 300
@
text
@@
