head	1.4;
access;
symbols
	gal309_3:1.4
	gal309_2:1.4
	gal309_1:1.4
	gal309:1.4
	gal308_2:1.3
	gal308_1:1.3
	gal308:1.3
	gal307_2:1.3
	gal307_1:1.3
	gal307:1.3
	gal306_3:1.3
	gal306_2:1.3
	gal306_1:1.3
	gal306:1.3
	gal305_3:1.3
	gal305_2:1.3
	gal305_1:1.3
	gal305:1.3
	gal304_11:1.3
	gal304_10:1.3
	gal304_9:1.3
	gal304_8:1.3
	gal304_7:1.3
	gal304_6:1.3
	gal304_5:1.3
	gal304_4:1.3
	gal304_3:1.3
	gal304_2:1.3
	gal304_1:1.3
	gal304:1.3
	gal303_3:1.3
	gal303_2:1.3
	gal303_1:1.3
	v-303:1.2
	gal302_2:1.2
	flr:1.1.1;
locks; strict;
comment	@c @;


1.4
date	99.12.03.14.10.57;	author flr;	state Exp;
branches;
next	1.3;

1.3
date	96.01.25.13.45.18;	author flr;	state Exp;
branches
	1.3.2.1;
next	1.2;

1.2
date	95.02.06.15.20.37;	author algal;	state Exp;
branches;
next	1.1;

1.1
date	94.12.07.14.01.47;	author flr;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	94.12.07.14.01.48;	author flr;	state Exp;
branches;
next	;

1.3.2.1
date	99.12.02.12.25.43;	author flr;	state Exp;
branches;
next	;


desc
@@


1.4
log
@gal309 - Y2K compliant
@
text
@*DK asrrun
      SUBROUTINE ASRRUN
C ------------------------------------------------------------------
C - F.Ranjard - 861013
C!  Decode contents of RUNH and ASRU
C - Called from   ASIJOB, ASPRUN                  from this .HLB
C ------------------------------------------------------------------
#ifndef DOC
#include "jobcom.h"
#include "iocom.h"
#include "alfgeo.h"
#include "kincom.h"
#include "jqcom.h"
#include "ajjpar.h"
#include "kgjjpar.h"
#include "rlepjj.h"
      PARAMETER (LNAM=4)
      CHARACTER*4 CHAINT,TNAME(LNAM)
      DATA TNAME /'LUND','SJET','PART','USER'/
#include "bmacro.h"
C ------------------------------------------------------------------
C
C - Decode RUNH bank
      KRUNH  = IW(NARUNH)
      KEVEH = IW(NAEVEH)
      IF (KRUNH .EQ. 0) KRUNH = KEVEH
      IF (KRUNH .GT. 0) THEN
        IEXPJO = IW(KRUNH+1)
        IRUNJO = IW(KRUNH+2)
        IPROKI = IW(KRUNH+3)
        MPRO   = IPROKI / LOFFMC
        IF (MPRO .EQ. 0) THEN
          CALL ALTELL ('ASRRUN: not a MonteCarlo runtype ',0,'STOP')
        ELSE
          MPRO = MIN (MPRO,LNAM)
          IF (KRUNH .NE. KEVEH) THEN
            WRITE (LOUTIO,810) IRUNJO,IW(KRUNH+3),TNAME(MPRO)
     &                     ,(IW(KRUNH+M),M=4,5)
  810       FORMAT (/1X,'+++ASRRUN+++ RUN # ',I6,3X,'run type = '
     &            ,I6,2X,A4,3X,'date and time ',I8,2X,I8/)
          ELSE
            WRITE (LOUTIO,820) IRUNJO,IW(KRUNH+3),TNAME(MPRO)
  820       FORMAT (/1X,'+++ASRRUN+++ RUN # ',I6,3X,'run type = '
     &                    ,I6,2X,A4)
          ENDIF
        ENDIF
      ENDIF
C
C - Decode RLEP bank
      JRLEP = IW(NAMIND('RLEP'))
      IF (JRLEP .NE. 0) THEN
        ALECMS = 2.*REAL(ITABL(JRLEP,1,JRLELE)) * .001
      ENDIF
C
C - Decode Axxx banks
      JATIT = IW(NAMIND('ATIT'))
      IF (JATIT .NE. 0) THEN
        NATIT = LROWS(JATIT)
        WRITE(LOUTIO,*)' +++ASRRUN+++ Galeph title: ',
     &                 (CHAINT(IW(JATIT+LMHLEN+J)),J=1,NATIT)
      ENDIF
C
      JAKIN = IW(NAMIND('AKIN'))
      IF (JAKIN .NE. 0) THEN
        KAKIN = JAKIN + LMHLEN
        TKINJO = CHAINT (IW(KAKIN+JAKIKT))
        LKIN = MIN (LKINP,LCOLS(JAKIN)-JAKIKP+1)
        CALL UCOPY (RW(KAKIN+JAKIKP),BKINJO(1),LKIN)
      ENDIF
C
      JAFID = IW(NAMIND('AFID'))
      IF (JAFID .NE. 0) THEN
        IF (IPROJO(2) .EQ. 0) THEN
          ALRMAX = RTABL(JAFID,1,JAFIAR)
          ALZMAX = RTABL(JAFID,1,JAFIAZ)
          ALFIEL = RTABL(JAFID,1,JAFIMF)
          ALECMS = RTABL(JAFID,1,JAFIBE)
        ENDIF
      ENDIF
C
C - Decode KRUN bank
      JKRUN = IW(NAKRUN)
      IF (JKRUN .NE. 0) THEN
        NOTRKI = ITABL (JKRUN,1,JKRUNO)
        IPROKI = ITABL (JKRUN,1,JKRUGI)
        WRITE (LOUTIO,*)' +++ASRRUN+++ Kine title: ',
     &    (CHAINT(IW(JKRUN+LMHLEN+I)),I=JKRURT,JKRUFS-1)
        WRITE (LOUTIO,*)
     &     '  - generator identifier: ',IPROXI,
     &     '  - NOtracking marker word: ',NOTRKI
      ENDIF
C
      RETURN
      END
#endif
@


1.3
log
@put a ifndef DOC in gdray
modify WRITE statment to please fpp on alpha/vms
 Modified Files:
 	catino.F
	agchck.F
 	gdray.F
 	hchist.F hcshow.F hcstat.F hnewtk.F
 	lcasig.F
	sabook.F sahist.F sahit.F sawsum.F
 	siasig.F sidfrt.F sishow.F sitrak.F
 	asfxxx.F asijob.F asread.F asrrun.F
@
text
@d40 1
a40 1
     &            ,I6,2X,A4,3X,'date and time ',I6,2X,I8/)
@


1.3.2.1
log
@gal308_2 Y2K fix in skel/ geom/ hcal/
@
text
@d40 1
a40 1
     &            ,I6,2X,A4,3X,'date and time ',I8,2X,I8/)
@


1.2
log
@je nesais plus
remove include BMACRO
equivalence (NAPART,NAPAR) to cope with KMACRO
je ne sais plus
@
text
@d59 2
a60 3
        WRITE(LOUTIO,'(/1X,''+++ASRRUN+++ Galeph title: '',
     &                   20A4)')
     &                   (CHAINT(IW(JATIT+LMHLEN+J)),J=1,NATIT)
d86 5
a90 4
        WRITE (LOUTIO,'(/1X,''+++ASRRUN+++ Kine title: '',12A4/
     &                       ''  - generator identifier: '',I10,3X,
     &                       ''  - NOtracking marker word: '',I6)')
     &    (CHAINT(IW(JKRUN+LMHLEN+I)),I=JKRURT,JKRUFS-1),IPROKI,NOTRKI
@


1.1
log
@Initial revision
@
text
@d90 1
a90 1
     &    (CHAINT(IW(JKRUN+LMHLEN+I)),I=JKRURT,LKRUNA),IPROKI,NOTRKI
@


1.1.1.1
log
@import galeph 300
@
text
@@
