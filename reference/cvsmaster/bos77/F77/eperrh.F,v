head	1.1;
access;
symbols
	bos3589:1.1;
locks; strict;
comment	@c @;


1.1
date	97.01.29.15.49.06;	author flr;	state Exp;
branches;
next	;


desc
@@


1.1
log
@release bos3589: new epio routines
@
text
@      SUBROUTINE EPERRH(LUNIT,IERR)
C. PRINTS ERROR MESSAGES, UPDATES ERROR COUNTS
C. INPUT
C. LUNIT      LOGICAL UNIT
C. IERR       ERROR NUMBER

      COMMON/EPCOMM/NMUNIT,NWUNIT,NCONT,ISTART,LASTUT,LREF,LIST(350)
      EQUIVALENCE (NOUTUT,LIST(8))

      IF(LIST(3).GE.LIST(2))  GOTO 77777
      IF(IERR.EQ.1)  GOTO 10
      IF(IERR.EQ.8.OR.IERR.EQ.9)  GOTO 20
      IF(IERR.EQ.13.OR.IERR.EQ.14)  GOTO 20
      IF(IERR.EQ.16.OR.IERR.EQ.17)  GOTO 20
      IF(IERR.EQ.25) GOTO 25
      IF(IERR.EQ.26) GOTO 26
      WRITE(NOUTUT,2002) IERR,LUNIT,LIST(ISTART+11),LIST(ISTART+12)
      GOTO 100
   10 WRITE(NOUTUT,2000) LUNIT,LIST(ISTART+11),LIST(ISTART+12)
      GOTO 100
   20 WRITE(NOUTUT,2001) IERR,LUNIT
      GOTO 100
   25 WRITE(NOUTUT,2025) IERR,LUNIT
      GOTO 100
   26 WRITE(NOUTUT,2026) IERR,LUNIT
      GOTO 100
  100 LIST(3)=LIST(3)+1
77777 RETURN
2000  FORMAT(/,' +++ EP I/O PACKAGE - END OF FILE READ  UNIT',
     1   I5,'  AFTER BLOCK ',I5,'  AND ',I8,'  RECORDS  +++')
2001  FORMAT(/,' +++ EP I/O PACKAGE ERROR NO.',I5,'  ON UNIT',
     1   I5,'  +++')
2002  FORMAT(/,' +++ EP I/O PACKAGE ERROR NO.',I5,'  ON UNIT',
     1   I5,'  AT BLOCK ',I5,'  RECORD ',I8,'  +++')
2025  FORMAT(/,' +++ EP I/O PACKAGE ERROR NO.',I5,'  ON UNIT',
     1   I5,'  CANNOT OPEN THE FILE IN WRITE MODE +++')
2026  FORMAT(/,' +++ EP I/O PACKAGE ERROR NO.',I5,'  ON UNIT',
     1   I5,'  CANNOT OPEN THE FILE IN READ MODE +++')
      END
@
