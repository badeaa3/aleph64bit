head	1.4;
access;
symbols
	bos3489-1:1.3.0.2
	bos3589:1.4
	bos3489:1.3
	bos3389:1.3
	bos3289:1.3
	bos3189:1.3
	bos3089:1.2
	v3089:1.1.1.1
	flr:1.1.1;
locks; strict;
comment	@c @;


1.4
date	97.01.29.15.49.07;	author flr;	state Exp;
branches;
next	1.3;

1.3
date	96.05.03.14.55.05;	author flr;	state Exp;
branches;
next	1.2;

1.2
date	96.03.11.12.52.56;	author flr;	state Exp;
branches;
next	1.1;

1.1
date	94.12.07.13.58.43;	author flr;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	94.12.07.13.58.44;	author flr;	state Exp;
branches;
next	;


desc
@@


1.4
log
@release bos3589: new epio routines
@
text
@      SUBROUTINE EPHEAD(IBUF,IERR)
C. ROUTINE TO PRESET A PHYSICAL HEADER FOR AN OUTPUT UNIT, PLUS THE
C. OUTPUT UNIT FLAG CONTROL WORD.
C. INPUT/OUTPUT
C. IBUF      UNIT BUFFER
C. FORMAT OF THE HEADER
C.   1       PHYS. BLOCK LENGTH (IN 16 BIT WORDS)
C.   2       PHYS. BLOCK HEADER LENGTH (IN 16 BIT WORDS)
C.   3       PHYS. BLOCK NUMBER
C.   4       POINTER TO FIRST LOG. RECORD START, OR ZERO IF NONE
C.   5       RUN NUMBER
C.   6       PHYS. BLOCK TYPE
C.   7       CONTAINS  29954 if 16 bit word p.h., 522144444 (hex 1F1F4ABC)
C.           if 32 bit p.h.
C.   8       CONTAINS  31280 if 16 word p.h., else as word 7
C.   9       NUMBER OF HEADERLESS BLOCKS FOLLOWING
C.  10       TAPE FORMAT VERSION NUMBER = 8012
C.  11       LOGICAL RECORD WORD LENGTH IN BITS (16 AND 32 SUPPORTED)
C.  12       LENGTH OF STANDARD PHYS. HEADER  (in 16 bit words !)
C. IERR      ERROR CODE
C.   0       OPEN is OK
C.   1       CANNOT OPEN FILE IN WRITE MODE
      COMMON/EPCOMM/NMUNIT,NWUNIT,NCONT,ISTART,LASTUT,LREF,LIST(350)
      EQUIVALENCE (NOUTUT,LIST(8))
      DIMENSION IBUF(20)
      K=LIST(6)
      IF(LIST(ISTART+29).EQ.0)  THEN
*--- 16 bit p.h.
         NSL=LIST(6)
         IBUF(K+1)=NSL
         IBUF(K+2)=NSL
         IBUF(K+3)=0
         IBUF(K+4)=0
         IBUF(K+5)=LIST(ISTART+4)
         IBUF(K+6)=LIST(ISTART+9)
         IBUF(K+7)=29954
         IBUF(K+8)=31280
         IBUF(K+9)=0
         IBUF(K+10)=8012
         IBUF(K+11)=LIST(ISTART+3)
         IBUF(K+12)=NSL
C--- BUNCH INTO HEADER PORTION
         CALL BUN16W(IBUF,K+1,IBUF,1,K)
      ELSE
*--- 32 bit p.h.
         NSL=2*LIST(6)
         IBUF(K+1)=NSL
         IBUF(K+2)=NSL
         IBUF(K+3)=0
         IBUF(K+4)=0
         IBUF(K+5)=LIST(ISTART+4)
         IBUF(K+6)=LIST(ISTART+9)
         IBUF(K+7)=522144444
         IBUF(K+8)=IBUF(K+7)
         IBUF(K+9)=0
         IBUF(K+10)=8012
         IBUF(K+11)=LIST(ISTART+3)
         IBUF(K+12)=NSL
C--- BUNCH INTO HEADER PORTION
         CALL CTOIBM(IBUF(K+1),K,2)
         CALL BUN32W(IBUF,K+1,IBUF,1,K)
      ENDIF
      IF(LIST(ISTART+7).EQ.0)  LIST(ISTART+7)=NSL
      LIST(ISTART+14)=NSL
C--- OUTPUT UNIT FLAG
      IF(LIST(ISTART+16).EQ.0) CALL EPOPEN(1,IERR)
      if(IERR.ne.0) CALL EPERRH(LIST(ISTART+10),IERR)
      
      LIST(ISTART+16)=1
      RETURN
      END
@


1.3
log
@replace ${VENDOR} by ALEPH_${VENDOR}
Modified Files:
  F77/ 	blo32w.F cfribm.F ctoibm.F epblin.F epdacr.F epdefu.F ephead.F
 	epinit.F epopen.F
@
text
@d1 1
a1 2
#if defined(ALEPH_DEC) &&  ! defined(UNIX)
      SUBROUTINE EPHEAD(IBUF)
d20 3
d67 2
a68 1
      if(IERR.ne.0)CALL EPERRH(LIST(ISTART+10),IERR)
a71 1
#endif
@


1.2
log
@import new version made for cvs on alws.
add eprwnd.F to test the descriptor before calling CFREW. Should be included
into the EPIO next release.
 Added Files:
 	eprwnd.F
@
text
@d1 1
a1 1
#if defined(DEC) &&  ! defined(UNIX)
@


1.1
log
@Initial revision
@
text
@a0 1
*DK ephead
@


1.1.1.1
log
@import bos77 3089
@
text
@@
