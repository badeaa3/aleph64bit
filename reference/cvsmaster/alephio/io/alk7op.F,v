head	1.1;
access;
symbols
	alio83:1.1
	alio82:1.1
	alio81:1.1
	alio80:1.1
	alio74:1.1
	alio73:1.1
	alio72:1.1
	alio71:1.1
	alio70:1.1
	alio68:1.1
	alio69:1.1
	alio67:1.1
	alio66:1.1
	alio65:1.1
	alio64:1.1
	alio63:1.1
	alio62:1.1
	alio61:1.1
	alio60:1.1;
locks; strict;
comment	@c @;


1.1
date	96.04.23.09.59.44;	author flr;	state Exp;
branches;
next	;


desc
@@


1.1
log
@move alph, dbas, a part of alef and a part of c to alephio
Modified Files:
 	version.h
 Added Files:
 	adbrow.F adbrpn.F adbrun.F adbswp.F adbver.F agetdb.F agtfil.F
	albos.F aldawr.F aldtyp.F aleveh.F alfind.F alfmt.F algtbk.F
 	algtdb.F algtlu.F algtro.F algtyp.F alinst.F alk7fil.F
 	alk7fru.F alk7op.F alk7tru.F alredb.F alrune.F alrunh.F
 	alrunr.F alseed.F alstho.F alstin.F alstri.F altabl.F alvsn.F
 	aopdbs.F aublis.F aubos.F aubprs.F bkcari.F bkinca.F bkrhab.F
 	bkrhal.F bkrhaw.F bktobk.F cafiht.F chahol.F dafrds.F gtdbas.F
 	gtstup.F igtfmt.F jhocha.F julrec.F junial.F junidb.F
 	kbytrec.F loctab.F nameru.F ubpack.F uclean.F uindxs.F usbos.F
 	usgtdb.F utcblk.F utccop.F utcofo.F utwocl.F utwoex.F
Removed Files:
	noibm.F
@
text
@      INTEGER FUNCTION ALK7OP (LURUK7)
C --------------------------------------------------------
C - F.Ranjard - 900627
C! Open RUNCARTSLIST   file and read it
CKEY ALEF TAPE  RUN / USER
C
C - Input     : LURUK7  / INTE  = open RUNCARTSLIST   on unit LURUK7
C
C - Output    :
C               ALK7OP    / INTE  = error code
C                                 = 0  OK
C                                 = 1  cannot open RUNCARTS file
C                                 = 2  file is empty
C                                 = 3  too many runs, increase ALK7COM
C - open RUNCARTSLIST which contains for each run the number
C   of the CERN cartridges in the order : RAW/POT/DST/MINI/NANO
C   on unit LURUK7
C ---------------------------------------------------------
#ifndef DOC
#include "bcs.h"
#include "alk7com.h"
      CHARACTER DUMMY*80
      SAVE NK7
      DATA IFI /0/
C
C ------------------------------------------------------------------
C
C - execute only once
      IER = 0
      IF (IFI.EQ.0) THEN
       IFI = 1
       NK7 = (LK7+3)/4          ! # of words to contain LK7 characters
       K7SEG = 0
       K7TYPE = 'RPDMN'
C       open the RUNCARTS.LIST file
       CALL AGTFIL ('FRK7','READ',LURUK7,IER)
       IF (IER.NE.0) THEN
          CALL AOPEN (LURUK7,'RUNCARTSLIST','CARDS','DISK',IER)
       ENDIF
       IF (IER.NE.0) THEN
          IER=1
          GOTO 999
       ENDIF
C
C       read the RUNCARTS.LIST file
       READ (LURUK7,'(A80)')DUMMY
       READ (LURUK7,'(A80)')DUMMY
       READ (LURUK7,'(A80)')DUMMY
       ISEG = 1
       K7LINE(ISEG) = 0
       LINE = 0
 1     CONTINUE
       IF (K7LINE(ISEG).GE.MXLRUN) THEN
          IF (ISEG.GE.MXSEG) THEN
             IER = 3
             CALL ALTELL ('ALK7OP:too many runs,increase ALK7COM',0,
     &                    'RETURN')
             GOTO 3
          ENDIF
          ISEG = ISEG + 1
          K7LINE(ISEG) = 0
       ENDIF
       K7LINE(ISEG) = K7LINE(ISEG)+1
       LINE = LINE+1
       LC = (K7LINE(ISEG)-1)*LK7 + 1
       LCE= LC+LK7-1
       READ (LURUK7,'(1X,I6,5(1X,A9),A23)',END=2)
     &         K7LRUN(K7LINE(ISEG),ISEG),
     &         K7CART(1,ISEG)(LC:LCE),K7CART(2,ISEG)(LC:LCE),
     &         K7CART(3,ISEG)(LC:LCE),
     &         K7CART(4,ISEG)(LC:LCE),K7CART(5,ISEG)(LC:LCE)
       GOTO 1
C - eof on RUNCARTS.LIST: decrement counters
 2     CONTINUE
       LINE = LINE-1
       K7LINE(ISEG) = K7LINE(ISEG)-1
 3     LC = LINE*LK7
       WRITE (IW(6),*)' *** ALK7OP*** RUNCARTS.LIST on unit ',LURUK7,
     &                   ' contains ',LINE,' runs'
C   Parity error or eof : no information on this file
       IF (LINE.LE.0) THEN
          IER = 2
          ISEG = 0
       ENDIF
       K7SEG  = ISEG
      ENDIF
C
 999   ALK7OP = IER
       END
#endif
@
