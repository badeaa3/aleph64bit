head	1.3;
access;
symbols
	alio83:1.3
	alio82:1.3
	alio81:1.3
	alio80:1.3
	alio74:1.3
	alio73:1.3
	alio72:1.3
	alio71:1.3
	alio70:1.3
	alio68:1.3
	alio69:1.3
	alio67:1.3
	alio66:1.3
	alio65:1.3
	alio64:1.3
	alio63:1.3
	alio62:1.3
	alio61:1.3
	alio60:1.3
	alephio53:1.3
	v4:1.1.1.1
	flr:1.1.1;
locks; strict;
comment	@c @;


1.3
date	96.03.13.15.00.01;	author flr;	state Exp;
branches;
next	1.2;

1.2
date	96.01.18.13.49.03;	author flr;	state Exp;
branches;
next	1.1;

1.1
date	94.12.07.13.52.35;	author flr;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	94.12.07.13.52.36;	author flr;	state Exp;
branches;
next	;


desc
@@


1.3
log
@import alephio 52 from historian. Modify aclose.F to NOT call brwnd twice
for the same file. update version.h to 5.3
@
text
@      SUBROUTINE AFILIN(FNAME,FTYPE,FDEVI,IRET)
C-----------------------------------------------------------------------
CKEY ALREAD RUNCARDS FILI
C - Author :    D.Schlatter                     AUG-88
C   modified by H.Albrecht             :        NOV-88
C   modified by D.Shlatter and M.Talby :        APR-89
C
C! get filename and alephtype from ALEPH input banks ( FILI )
C  as defined by AIOCAR
C  'filename' means 'fn ft fm' on IBM ,'fname.ext' on
C             VAX, APOLLO, and DECS
C  'filetype' means 'ft' on IBM ,'ext' on VAX, APOLLO, and DECS.
C
C     input:    runcard     FILI  'filename '
C                         if 'filetype' is not a standard alephtype then
C                           FILI  'filename | alephtype'
C                     e.g.  FILI 'ABC.NATIVE'
C                           FILI 'XYZ.DAT|NATIVE'
C
C     output:   FNAME      full filename
C               FTYPE      alephtype
C               FDEVI      device ('DISK'/ 'TAPE')
C               IRET       RETURN code from ACDARG
C                          = 0  bank found with correct filename
C                          = 6  file does not exist
C
C   Calls:   AIOCAR,ACDARG,AINQUI
C
C   ENTRY    AFILI0(ISTR,IND,NR)      RETURNs namind+nr for given stream
C-----------------------------------------------------------------------
#ifndef DOC
#include "bcs.h"
#include "alrcom.h"
      CHARACTER*(*) FTYPE(1),FNAME(1),FDEVI(1)
      CHARACTER*80  FT,FN,FD
      CHARACTER*4   CARD,FD4,CARINP(MINPUT),CAROUT(MOUTPT)
      CHARACTER*50  CPARA
      INTEGER       ACARD0
      INTEGER       ACARD3
      INTEGER       NAMFI(MINPUT),NRFI(MINPUT)
      LOGICAL LEX,FIRST
      SAVE
      DATA NAMFI/MINPUT*0/,NRFI/MINPUT*0/
      DATA FIRST/.TRUE./

C------------------------------------------------------------
C
      IF(FIRST) THEN
        FIRST=.FALSE.
C                   get ALEPH conventions for cards
        CALL AIOCAR(CARINP,MINPUT,CAROUT,MOUTPT)
        NPAR=2
      ENDIF
C                   loop over all posible input cards
      ISTRM = 1
      IRET = -1
      DO 10 IC=1,MINPUT
C                   get filename/alephtype from FILI,,,  card
        CALL ACDARG (CARINP(IC),'NATIVE','*',FN,FT,FD,IRC )
        IRET = IRC
        IF (IRC .EQ. -1) GOTO 10
        IF (IRC .NE. 0)  GO TO 9
        FNAME(ISTRM)=FN
        FTYPE(ISTRM)=FT
        FDEVI(ISTRM)=FD
        NAMFI(ISTRM) = ACARD0( NR )
        NRFI(ISTRM)  = NR
C                   does file exist ?
        FD4 = FDEVI( ISTRM )
        IF (FD4 .EQ. 'DISK')  THEN
          CALL AINQUI (0,FNAME(ISTRM),LEX)
          IF (.NOT.LEX) THEN
            IRET = 6
            GOTO 999
          ENDIF
        ENDIF
    9   ISTRM = ISTRM + 1
   10 CONTINUE

  999 RETURN
      ENTRY AFILI0( JSTRM, NAID,NUM )
      NAID = NAMFI(JSTRM)
      NUM  = NRFI(JSTRM)
      END
#endif
@


1.2
log
@ Modified Files:
	acdarg.F afilin.F afilou.F ainqui.F amount.F aoptap.F astage.F
	awrtap.F
@
text
@a0 1
*DK afilin
@


1.1
log
@Initial revision
@
text
@d12 2
a13 2
C             VAX, APOLLO, and DEC
C  'filetype' means 'ft' on IBM ,'ext' on VAX, APOLLO, and DEC.
@


1.1.1.1
log
@import alephio 4
@
text
@@
