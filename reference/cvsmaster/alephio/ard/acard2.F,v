head	1.4;
access;
symbols
	alio83:1.4
	alio82:1.4
	alio81:1.4
	alio80:1.4
	alio74:1.4
	alio73:1.4
	alio72:1.4
	alio71:1.4
	alio70:1.4
	alio68:1.4
	alio69:1.4
	alio67:1.4
	alio66:1.4
	alio65:1.4
	alio64:1.4
	alio63:1.2
	alio62:1.2
	alio61:1.2
	alio60:1.2
	alephio53:1.2
	v4:1.1.1.1
	flr:1.1.1;
locks; strict;
comment	@c @;


1.4
date	96.07.19.07.16.35;	author flr;	state Exp;
branches;
next	1.3;

1.3
date	96.07.19.07.05.03;	author flr;	state Exp;
branches;
next	1.2;

1.2
date	96.03.13.14.59.51;	author flr;	state Exp;
branches;
next	1.1;

1.1
date	94.12.07.13.52.34;	author flr;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	94.12.07.13.52.35;	author flr;	state Exp;
branches;
next	;


desc
@@


1.4
log
@restore old acard2.F
@
text
@      INTEGER FUNCTION ACARD2 (NPRM, COUT)
C----------------------------------------------------------------------
C!  Returns NPRM th parameter on Bos card
C!
C!   Author   :H.Albrecht               4-NOV-1988
C!   modified :F.Ranjard                5-AUG-1993
C!             rewrite it to remove ASSIGN statments
C!   Inputs: NPRM : Nth parameter on the card
C!
C!   Outputs: ACARD2 : 0 : less than NPRM parameters given
C!                     I (positive integer) : length of string COUT
C!        -   COUT : output string = NPRMth parameter on card NCRD
C!                   = string of blank spaces if ACARD2 .le. 0 .
C!                   Must be declared with proper length in the calling
C!                   routine. (If too short : ACARD2 is set to the
C!                   length of COUT without any notification).
C!
C!   Description
C!   ===========
C!
C?   ACARD2 returns the NPRMth parameter on AN BOS input card which
C?   has been defined by a previous CALL ACARD1 (...) (q.v).
C?
C?   Input cards may have no parameter at all or all parameters must
C?   be included in one pair of apostrophes.
C?
C?   The separator character | may be surrounded with blanks. Leading
C?   and trailing but no imbedded blank spaces of the parameters are
C?   removed. Two subsequent separators : the parameter inbetween
C?   corresponds to COUT = blank spaces and ACARD2 = 1 .
C?
C!======================================================================
C
#ifndef DOC
      SAVE
      COMMON /BCS/ IW(1000)
      CHARACTER *(*) COUT
      CHARACTER * 4 CBNK,CHAINT
      CHARACTER *120 STR
      PARAMETER (MXWORD=20)
      CHARACTER *80 CWORD(MXWORD)
      CHARACTER * 1 CSEP(2), C1
      DATA CSEP /'|',','/, LBNK /0/
C
      IF (NPRM .LE. 0)  THEN
        LBNK = - NPRM
        CALL ALSTIN (IW(LBNK+1),IW(LBNK),STR)
        CALL ALSTRI (STR,CSEP(1),MXWORD,CWORD,LWORD)
        GO TO 999
      ENDIF
C
      ACARD2 = 0
      COUT = ' '
      IF (NPRM.LE.LWORD) THEN
         LW = LNBLNK(CWORD(NPRM))
         ACARD2 = MIN (LEN(COUT),LW)
         IF (LW.GT.0) COUT = CWORD(NPRM)(1:ACARD2)
      ENDIF
C
  999 RETURN
      END
#endif
@


1.3
log
@replace Call SYSTEM with IST=SYSTEM
@
text
@a62 55
# 1 "acard1.F"
      INTEGER FUNCTION ACARD1 (CLAB)
C----------------------------------------------------------------------
C!  Return index for the next card bank
CKEY ALREAD CARD
C   Author     :Hartwig Albrecht         4-NOV-88
C   modified by D.Schlatter                APR-89
C
C        get bank index of next CLAB bank number. start at
C        CLAB,NR=0.
C        The next call will get CLAB,NR=1 ect..
C        To restart from NR=0 call ACARD1 with CLAB=' '
C
C!   Inputs: CLAB : bank label (character * 4)
C!                  = 1st...4th character on the input card
C                   = '    ' reset counter and start with 1. card
C!
C!   Outputs: ACARD1 > 0 : card ( = BOS bank with label CLAB) exists
C!                   = 0 : no (more) cards with label CLAB given.
C!
C    Calls:              AIOCAR
C!   Libraries required: BOS77
C
C    ENTRY:      ACARD0(NR)       returns name-index and number of
C                                 last used card
C!
C!   Description
C!   ===========
C!
C?   Simple minded card interpreter.
C?   ACARD1 checks the existence of the first (next) BOS bank CLAB
C?          which is assumed to be created by an input card.
C?          For every bank label CLAB, the cards are interpreted in
C?          their proper order. Bank numbers are not allowed to be
C?          given on input cards.
C?          The content of this bank can be interpreted by subsequent
C?          calls to ACARD2.
C?   Example : Fortran program :
C?          CHARACTER * 20 CPARA          ; must be sufficiently long !
C?      10  IF (ACARD1 ('ABCD') .EQ. 0)  GO TO 30       ; get next card
C?          NPARA = 1                       ; init loop over parameters
C?      20  IF (ACARD2 (NPARA,CPARA) .EQ. 0)  GO TO 10  ; more parm's ?
C?          ...                           ;  interprete parameter CPARA
C?          NPARA = NPARA + 1                          ; next parameter
C?          GO TO 20
C?      30  CONTINUE ...                 ; all 'ABCD' cards interpreted
C?   Example : card syntax (text starts in column 1 !) :
C?   ABCD 'PARM1 | XYZ   | PARM3 | | PARM5|PARM6   '
C?   The syntactical separator | may be surrounded by blank spaces.
C?   For the time being, numbers on input cards are NOT supported by
C?   ACARD1/2 : This would require major changes in some BOS routines.
C?======================================================================
C
# 103 "acard1.F"

@


1.2
log
@import alephio 52 from historian. Modify aclose.F to NOT call brwnd twice
for the same file. update version.h to 5.3
@
text
@d63 55
@


1.1
log
@Initial revision
@
text
@a0 1
*DK acard2
@


1.1.1.1
log
@import alephio 4
@
text
@@
