head     1.1;
branch   1.1.1;
access   ;
symbols  uphy1-0:1.1.1.1 flr:1.1.1;
locks    ; strict;
comment  @c @;


1.1
date     96.08.16.13.38.26;  author flr;  state Exp;
branches 1.1.1.1;
next     ;

1.1.1.1
date     96.08.16.13.38.27;  author flr;  state Exp;
branches ;
next     ;


desc
@@



1.1
log
@Initial revision
@
text
@      SUBROUTINE setshad(itk,ifl)
C ..........................................................
C! Discards muon candidates if they are suspected to be    .
C  created by muon chamber noise.                          .
C                                                          .
C For any problem or questions contact ABBANEO@@mail.cern.ch.
C                                                          .
C                                                          .
C  INPUT  : ITK alpha index of the track                   .
C                                                          .
C  OUTPUT : IFL muon identification flag                   .
C           = KMUIIF(itk) in most cases                    .
C           = -KMUIIF(itk) if the candidate is discarded   .
C ..........................................................
C
C
#include "qcde.h"
#include "qmacro.h"
      if(xmui(itk).and.xhma(itk).and.xmca(itk)) then
        idf1=kmuiif(itk)
        ifl=idf1
        if(idf1.lt.2.or.idf1.eq.11) return
        do i = kfcht,klcht
          if(i.ne.itk) then
C
C - search for shadowing tracks
            if((kmuist(itk).eq.ktn(i)).and.
     ~           (kmuist(i).eq.ktn(itk))) then
              if(xmui(i).and.xhma(i).and.xmca(i)) then
                idf2 = kmuiif(i)
                if(idf2.gt.1.and.idf2.ne.11) then
                  qual = 0.
                  res1 = qmuisr(itk)
                  res2 = qmuisr(i)
                  dl1  = qmcadh(itk,1)
                  dh1  = qmcadh(itk,2)
                  dl2  = qmcadh(i,1)
                  dh2  = qmcadh(i,2)
                  mdis1= qmuidm(itk)
                  mdis2= qmuidm(i)
C
C - check HCAL residuals
                  if(res1.lt.100.and.res2.lt.100) then
                    wei=max(res1,res2)
                    qual=qual+(res1-res2)*wei
                  endif
C
C - hit-to-track distance in the muon chambers
                  if((dl1*dl2).gt.0) then
                    wei=max(dl1,dl2)
                    qual=qual+(dl1-dl2)/200*wei
                  endif
                  if((dh1*dh2).gt.0) then
                    wei=max(dh1,dh2)
                    qual=qual+(dh1-dh2)/200*wei
                  endif
                  if((dl1*dl2).eq.0.and.(dh1*dh2).eq.0) then
                    if(mdis1.gt.0.and.mdis2.gt.0) then
                      wei=max(mdis1,mdis2)
                      qual=qual+(mdis1-mdis2)/200*wei
                    endif
                  endif
C
C - give a bonus if one is a gold-plated muon (flag 14)
C   and the other is not
                  if(idf1.ne.idf2) then
                    if(idf1.eq.14) qual = qual-10.
                    if(idf2.eq.14) qual = qual+10.
                  endif
                  if(qual.gt.0) ifl=-idf1
                endif
              endif
            endif
          endif
        enddo
      else
        ifl=0
      endif
      return
      end
@


1.1.1.1
log
@2nd try to import uphy
@
text
@@
