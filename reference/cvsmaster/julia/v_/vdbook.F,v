head	1.3;
access;
symbols
	jul313_3:1.3
	jul313_2:1.3
	jul313_1:1.3
	jul313:1.3
	jul312_1:1.3
	jul312:1.3
	jul311:1.3
	jul310_1:1.3
	jul310:1.3
	jul309_1:1.3
	jul309:1.3
	jul308_6:1.3
	jul308_5:1.3
	jul308_4:1.3
	jul308_3:1.3
	jul308_2:1.3
	jul308_1:1.3
	jul308:1.3
	jul307_4:1.3
	jul307_3:1.3
	jul307_2:1.3
	jul307_1:1.3
	jul307:1.3
	jul306_3:1.3
	jul306_2:1.3
	jul306_1:1.3
	jul306:1.3
	jul305_4:1.3
	jul305_3:1.3
	jul305_2:1.3
	jul305_1:1.3
	jul305:1.3
	jul304_3:1.3
	jul304_2:1.3
	jul304_1:1.3
	jul304:1.3
	jul303_7:1.3
	jul303_6:1.3
	jul303_5:1.3
	jul303_4:1.3
	jul303_3:1.3
	jul303_2_mc1:1.3
	jul303_2:1.3
	jul303_1_mc1:1.3
	jul303_1:1.3
	jul303_v:1.3
	jul303:1.3
	jul302_6:1.3
	jul302_5:1.3
	jul302_4:1.3
	jul302_3:1.3
	jul302_2:1.3
	jul302_1:1.3
	jul302:1.3
	jul285_1:1.3
	jul285:1.3
	jul284_1:1.3
	jul284:1.3
	jul283_1:1.3
	jul283:1.3
	jul282_1:1.3
	jul282:1.3
	jul281_3:1.3
	jul281_2:1.3
	jul281_1:1.3
	jul281:1.3
	jul280_1:1.3
	jul280:1.3
	jul279:1.2
	v300:1.1.1.1
	flr:1.1.1;
locks; strict;
comment	@c @;


1.3
date	96.03.12.15.48.08;	author flr;	state Exp;
branches;
next	1.2;

1.2
date	95.11.29.17.21.01;	author flr;	state Exp;
branches;
next	1.1;

1.1
date	94.12.07.14.20.31;	author aljul;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	94.12.07.14.20.32;	author aljul;	state Exp;
branches;
next	;


desc
@@


1.3
log
@import jul280 from historian
Modified Files:
	aamain.F aboldr.F ajmmcl.F almmcl.F altime.F aulpol.F
	bccrun.F bcpack.F binijo.F biniru.F bmsum.F bpreda.F bprsum.F
	bslowc.F
	cabook.F calrec.F calrel.F calrep.F calsup.F cashet.F casmp.F
	casneu.F casnmp.F cclorl.F cctrmi.F ccutpe.F cdang.F cdths.F
 	cegclu.F cencch.F cencne.F cesclu.F cexcob.F cexhis.F cfpass.F
 	cfpmip.F cfpnmp.F cgrunc.F chclu.F chgclu.F chsclu.F cinijo.F
 	cinirl.F cinpar.F cinsrl.F cisgam.F cishit.F cludis.F cmoni.F
 	cnighb.F coslst.F cpadwr.F cparad.F cpotcr.F cpoteh.F cpotlc.F
 	cptcom.F crcalo.F crchrl.F crcjob.F crcpar.F crhclu.F cthclu.F
 	ctkchg.F ctrmip.F ctrpar.F ctrtoc.F cvrify.F
 	e1bpei.F e2bpei.F e3bpei.F e4bary.F e4cosz.F e4dead.F e4deij.F
 	e4fdij.F e4fide.F e4find.F e4fnec.F e4frac.F e4gtbr.F e4gtpl.F
 	e4gtso.F e4gtst.F e4gttw.F e4indi.F e4lea1.F e4ovrl.F e4pal.F
 	e4r1r2.F e4r2r3.F e4r3r4.F e4radc.F e4res2.F e4res3.F e4tstl.F
 	e4xyz0.F eautop.F ebegid.F eboxki.F ecalig.F ecblda.F ecboba.F
	ecbook.F eccaob.F ecchkb.F ecclco.F ecclus.F ecdamp.F ecdebg.F
 	ecdete.F ecdigi.F ecener.F eceras.F ecfclu.F ecfils.F ecfmip.F
 	ecfobj.F ecgflw.F ecgmix.F echarg.F echcgl.F echedc.F echiba.F
 	echist.F echtag.F ecinit.F ecinrv.F eclamp.F eclana.F ecleib.F
 	eclgeo.F eclope.F eclorl.F eclost.F ecltag.F ecltrk.F ecltyp.F
 	ecluar.F ecmesp.F ecmod.F ecmopl.F ecncob.F ecobnk.F ecoent.F
 	ecoidp.F ecos.F ecpasr.F ecplm.F ecprin.F ecprlo.F ecrcob.F
 	ecre4d.F ecreib.F ecrmip.F ecrndx.F ecrpei.F ecrtr.F ecrunq.F
 	ecscmd.F ecst.F ecsupp.F ecsw1093.F ecsw94.F ectemp.F ecthre.F
 	ectopo.F ectpc.F ectrap.F ectrea.F ecxmod.F edisal.F edlist.F
 	efaxe.F efbook.F eferrr.F eficlp.F eficv.F efiecp.F efieib.F
 	efijob.F efix.F efixi94.F eflcst.F efolmk.F efpard.F eftiel.F
 	egacst.F egaest.F egetds.F egfcst.F egttks.F ehcflo.F ehlix.F
 	ehreg.F eidedx.F eident.F eieffl.F einhlx.F einijo.F einirl.F
 	einiru.F einitk.F einsrl.F eipard.F eithr.F eknewb.F eknewe.F
 	elecid.F elongi.F emfill.F emskei.F emskev.F emskf.F emski.F
 	emskji.F emskmu.F enfmsk.F enighb.F enoise.F enprox.F enstat.F
 	epadcl.F epatrn.F epcalo.F epchg.F epneu.F epreda.F eproba.F
 	eprsto.F eprsum.F eprtpc.F ereset.F eroad.F escdef.F escoun.F
 	esfil.F eslas.F eslct.F eslctf.F eslowc.F estag.F esveto.F
 	eswpst.F etdifp.F ethres.F etrdev.F ewdifp.F ewircl.F ex3ijk.F
 	fawian.F ffield.F fidhea.F fidrot.F finiru.F fitall.F fitwri.F
 	fkink.F fkkpar.F floweh.F flowfi.F flowtr.F fmuid.F fpiden.F
 	frefit.F ftpcer.F ftrack.F
 	gambnk.F gapeco.F gasteer.F
 	hcalib.F hcalrd.F hcatow.F hcbhis.F hcfclu.F hchist.F hclcra.F
 	hcltst.F hclufi.F hcos.F hcsimm.F hdgdeb.F hdgfil.F hdgpot.F
 	hdgsum.F hdprec.F hdspre.F hflnoi.F hinijo.F hiniru.F hmener.F
 	hmfind.F hmroad.F hnoise.F hnoisy.F hpatco.F hphnoi.F hplink.F
 	hprana.F hpranp.F hprdig.F hpreda.F hprpot.F hprsum.F hprunc.F
 	hrcomp.F hrcpat.F hrdcal.F hroad.F hslink.F hslowc.F hspare.F
 	hsptre.F hstofi.F htrack.F htubfi.F htwcr.F
 	iasign.F iattma.F ibnkin.F icaswt.F icftoi.F iclimb.F icrcco.F
 	ideadw.F idigpr.F ienang.F ifind1.F ifind2.F ifitp.F iftrak.F
 	igetti.F igettp.F igicha.F iheler.F iinijo.F iiniru.F iintrk.F
 	imatch.F inigap.F insect.F intrak.F ipakdi.F ipdsti.F iphcor.F
 	ipreda.F iprsum.F ipstat.F irefin.F ireopd.F isave.F ishuff.F
 	ishufl.F islowc.F isrch.F itbook.F itccut.F itcopr.F itcrec.F
 	itcrep.F itctpc.F itctrk.F itcxng.F iterr.F itextn.F ithist.F
 	itidy1.F itidy2.F itlnk1.F itlnk2.F itpcan.F itrak.F itrecf.F
 	itreci.F itree.F itrkci.F itrkeq.F itrkzr.F itrmca.F
@
text
@      SUBROUTINE  VDBOOK
C----------------------------------------------------------------------
C!  - book VDET histograms
C!
C!
C!    by Hans-Guenther Moser
C!
C!    created:           10/04/88
C!
C!    last modification: 15-4-91
C!    Rewrite for 1991 VDET, Dave Brown
C!
C!  Modified March 1995 A. Bonissent, M. Thulasidas
C!                 reorganise and debug
C!======================================================================
#ifndef DOC
C
C  Here, I have to declare all the variables in RPARAC if I want to use
C  implicit none.  Also a few in RFLAGS.  What a bunch of turkeys.
C
      INTEGER JULVD,JULIT,JULTP,JULEC,JULLC
      INTEGER JULSA,JULHC,JULMU,JULCA,JULSK
      INTEGER JULYR,JULYT,JULEF,JULBC,JULFA,JULBO
      INTEGER MODEND,MODREA,MODPRV,MODPRI,MODPRT
      INTEGER MODPRE,MODPRL,MODPRS,MODPRH,MODPRM
      INTEGER MODTPT,MODTPW,MODDEX,MODITC,MODVDE
      INTEGER MODFIT,MODFTR,MODECL,MODMIP,MODEID
      INTEGER MODFEO,MODFEP,MODHCL,MODHDP,MODEHG
      INTEGER MODMUF,MODMUA,MODLCA,MODSAT,MODLTR
      INTEGER MODPID,MODYMA,MODYTO,MODYV0,MODHIS
      INTEGER MODPOT,MODMIN,MODWRI
      INTEGER MODCOM,MODBCA,MODMUO,MODMON,MODENF
      INTEGER MODGAM,MODEDI
      INTEGER LASTMO
      INTEGER JCMORF,JEBIRF,JFBIRF
      INTEGER NWAF
C
      INTEGER VNTWAF
C
#include "rparac.h"
#include "rflags.h"
#include "vprtnc.h"
C
C  Local variables
C
      INTEGER ILAY,IWAF,IPHI,IVIEW,IBNUM
      REAL MINPH,MAXPH,MINSM,MAXSM,MAXCM
      CHARACTER*60 TITLE
C -----------------------------------------------------------
C  Setup the wafer index common
C
C  Get the histogram level and offset from JULIA.  Also set the
C  print level here.
C
      HISTLV = JHISRF(JULVD)
      PRNTLV = JPRSRF(JULVD)
      HISOFF  = JULVD * 1000
C
C As a temporary fix, we put the maximum  possible number of
C wafers, since the geometry package is not yet initialised
C A better solution might be found
C A. Bonissent January 1995
C
C      NWAF = VNTWAF()
C (9 faces first layer, 15 second layer)
C  *2 modules/face
C  *3 r/o modules/module
       NWAF = (9+15)*2*3
C
C
C  Interpret the histogram level as a bit flag
C
      IF(IAND(HISTLV,1).EQ.1)THEN
C
C  generic hit-reconstruction histograms
C
        MINPH = -500.
        MAXPH = 1000.
        MINSM = -200.
        MAXSM = 2000.
        MAXCM = 500.
C
        CALL HBOOK1(HISOFF+10,'Raw strip PH, no flag',
     &  150,MINPH,MAXPH,0.)
        CALL HBOOK1(HISOFF+11,'Raw strip PH, noisy flag',
     &  150,MINPH,MAXPH,0.)
        CALL HBOOK1(HISOFF+12,'Raw strip PH, overflow flag',
     &  150,MINPH,MAXPH,0.)
        CALL HBOOK1(HISOFF+15,'# of strips in raw cluster',
     &  50,-.5,49.5,0.)
        CALL HBOOK1(HISOFF+20,'Final sum PH',100,MINSM,MAXSM,0.)
        CALL HBOOK1(HISOFF+21,'Sum PH after separation',
     &  100,MINSM,MAXSM,0.)
        CALL HBOOK1(HISOFF+31,'# of strips in position, Phi',
     &  10,-.5,9.5,0.)
        CALL HBOOK1(HISOFF+32,'# of strips in position, Z',
     &  10,-.5,9.5,0.)
        CALL HBOOK1(HISOFF+40,'CM value',100,-MAXCM,MAXCM,0.0)
        CALL HBOOK1(HISOFF+41,'CM RMS',100,0.,MAXCM,0.0)
        CALL HBOOK1(HISOFF+42,'# of CM strips',50,-.5,49.5,0.0)
        CALL HBOOK1(HISOFF+43,'# of CM strips after cuts',
     &  50,-.5,49.5,0.0)
        CALL HBOOK2(HISOFF+51,'Online flags by ROM Z',
     &  NWAF,.5,FLOAT(NWAF)+.5,3,-.5,2.5,0.0)
        CALL HBOOK2(HISOFF+52,'Online flags by ROM PHI',
     &  NWAF,.5,FLOAT(NWAF)+.5,3,-.5,2.5,0.0)
      END IF
      IF(IAND(HISTLV,2).EQ.2)THEN
C
C  Hit-track matching histograms
C
      END IF
      IF(IAND(HISTLV,4).EQ.4)THEN
C
C  Some special histograms for the hot channel matching
C
        CALL HBOOK1(HISOFF+211,' Z-Strips Occupancy',100,0.,0.1,0.)
        CALL HBOOK1(HISOFF+212,' Z-Strips Occupancy',100,0.,1.0,0.)
        CALL HBOOK1(HISOFF+213,' Phi-Strips Occupancy',100,0.,0.1,0.)
        CALL HBOOK1(HISOFF+214,' Phi-Strips Occupancy',100,0.,1.0,0.)
        CALL HBPROF(HISOFF+215,'# Z hot channels/readout module',
     &       NWAF,0.5,FLOAT(NWAF)+.5,0.0,1024.,' ')
        CALL HBPROF(HISOFF+216,'# PHI hot channels/readout module',
     &       NWAF,0.5,FLOAT(NWAF)+.5,0.0,1024.,' ')
      END IF
      IF(IAND(HISTLV,8).EQ.8)THEN
C
C  Check charge division linearity
C
        CALL HBOOK1(HISOFF+111,'Eta r-phi LD1 no corr',
     &       100,0.0,1.0,0.0)
        CALL HBOOK1(HISOFF+112,'Eta r-phi LD1 corr',
     &       100,0.0,1.0,0.0)
        CALL HBOOK1(HISOFF+121,'Eta r-phi LD2 no corr',
     &       100,0.0,1.0,0.0)
        CALL HBOOK1(HISOFF+122,'Eta r-phi LD2 corr',
     &       100,0.0,1.0,0.0)
        CALL HBOOK1(HISOFF+130,'Eta Z',
     &       100,0.0,1.0,0.0)
      END IF

      RETURN
      END
#endif
@


1.2
log
@julia version 279
@
text
@a0 1
*DK vdbook
@


1.1
log
@Initial revision
@
text
@d13 3
d37 3
a43 1
#include "vindex.h"
d47 1
a47 1
      INTEGER ILAY,IWAF,IPHI,IVIEW,IBNUM,NPHI(2)
d50 1
a50 2
      DATA NPHI/12,15/
C
a52 2
      CALL VDINDX(IINDEX,IINDXY,NWAFER,ILAYND,IPHIND,IWAFND)
C
d60 12
d78 5
a82 1
        IF(IAND(HISTLV,16).EQ.16)THEN
a83 15
C  Crude flag to distinguish TPD from SCIROCCO readout; default is Sciro
C
          MINPH = -50.
          MAXPH = 160.
          MINSM = -50.
          MAXSM = 500.
          MAXCM = 75.
        ELSE
          MINPH = -500.
          MAXPH = 1000.
          MINSM = -200.
          MAXSM = 2000.
          MAXCM = 500.
        END IF

a89 2
        CALL HBOOK1(HISOFF+13,'Good strip PH (after CM)',
     &  150,MINPH,MAXPH,0.)
a91 1
        CALL HBOOK1(HISOFF+19,'Initial sum PH',100,MINSM,MAXSM,0.)
d95 1
a95 1
        CALL HBOOK1(HISOFF+30,'# of strips in position, Phi',
d97 1
a97 3
        CALL HBOOK1(HISOFF+31,'# of strips in position, Z1',
     &  10,-.5,9.5,0.)
        CALL HBOOK1(HISOFF+32,'# of strips in position, Z2',
d104 4
a107 2
        CALL HBOOK2(HISOFF+50,'Online strip flags by wafer',
     &  MAXIND,.5,MAXIND+.5,3,-.5,2.5,0.0)
d118 8
a125 6
        CALL HBOOK1(HISOFF+211,' Z-Strips Occupancy',100,0.,.1,0.)
        CALL HBOOK1(HISOFF+212,' Z-Strips Occupancy',100,0.,1.,0.)
        CALL HBOOK1(HISOFF+213,' Phi-Strips Occupancy',100,0.,.1,0.)
        CALL HBOOK1(HISOFF+214,' Phi-Strips Occupancy',100,0.,1.,0.)
        CALL HBPROF(HISOFF+215,'# hot channels/wafer',162,0.5,162.5,
     &  0.,512.,0.0)
d129 1
a129 1
C  Here some VERY LARGE histograms for special debugging of bonding maps
d131 10
a140 22
        DO 1001 ILAY=1,2
          DO 1002 IWAF=1,4
            DO 1003 IPHI=1,NPHI(ILAY)
              CALL VAENWA(IBNUM,ILAY,IWAF,IPHI,1)
              WRITE(TITLE,'(A,I6)')'Z PH',IBNUM
              CALL HBOOK1(HISOFF+300+IINDEX(ILAY,IWAF,IPHI),
     &          TITLE,512,-.5,511.5,3.)
               WRITE(TITLE,'(A,I6)')'Z flag2',IBNUM
              CALL HBOOK1(HISOFF+600+IINDEX(ILAY,IWAF,IPHI),
     &          TITLE,512,-.5,511.5,1.)
              IF(IWAF .EQ. 1 .OR. IWAF .EQ. 4)THEN
                CALL VAENWA(IBNUM,ILAY,IWAF,IPHI,2)
                WRITE(TITLE,'(A,I6)')'Phi PH',IBNUM
                CALL HBOOK1(HISOFF+450+IINDEX(ILAY,IWAF,IPHI),
     &          TITLE,512,-.5,511.5,3.)
                WRITE(TITLE,'(A,I6)')'Phi flag2',IBNUM
                CALL HBOOK1(HISOFF+750+IINDEX(ILAY,IWAF,IPHI),
     &          TITLE,512,-.5,511.5,1.)
              END IF
 1003       CONTINUE
 1002     CONTINUE
 1001   CONTINUE
d142 1
@


1.1.1.1
log
@import julia 300
@
text
@@
