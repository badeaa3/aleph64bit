head	1.1;
access;
symbols
	jul313_3:1.1
	jul313_2:1.1
	jul313_1:1.1
	jul313:1.1
	jul312_1:1.1
	jul312:1.1
	jul311:1.1
	jul310_1:1.1
	jul310:1.1
	jul309_1:1.1
	jul309:1.1
	jul308_6:1.1
	jul308_5:1.1
	jul308_4:1.1
	jul308_3:1.1
	jul308_2:1.1
	jul308_1:1.1
	jul308:1.1
	jul307_4:1.1
	jul307_3:1.1
	jul307_2:1.1
	jul307_1:1.1
	jul307:1.1
	jul306_3:1.1
	jul306_2:1.1
	jul306_1:1.1
	jul306:1.1
	jul305_4:1.1
	jul305_3:1.1
	jul305_2:1.1
	jul305_1:1.1
	jul305:1.1
	jul304_3:1.1
	jul304_2:1.1
	jul304_1:1.1
	jul304:1.1
	jul303_7:1.1
	jul303_6:1.1
	jul303_5:1.1
	jul303_4:1.1
	jul303_3:1.1
	jul303_2_mc1:1.1
	jul303_2:1.1
	jul303_1_mc1:1.1
	jul303_1:1.1
	jul303_v:1.1
	jul303:1.1
	jul302_6:1.1
	jul302_5:1.1
	jul302_4:1.1
	jul302_3:1.1
	jul302_2:1.1
	jul302_1:1.1
	jul302:1.1
	jul285_1:1.1
	jul285:1.1
	jul284_1:1.1
	jul284:1.1
	jul283_1:1.1
	jul283:1.1
	jul282_1:1.1
	jul282:1.1
	jul281_3:1.1
	jul281_2:1.1
	jul281_1:1.1
	jul281:1.1
	jul280_1:1.1
	jul280:1.1;
locks; strict;
comment	@c @;


1.1
date	96.05.06.15.52.56;	author flr;	state Exp;
branches;
next	;


desc
@@


1.1
log
@re-installed jul280 from the historian source because some routines were missing.
@
text
@      SUBROUTINE VDBGCL(IBEG)
C
C----------------------------------------------------------------------
C!  - Find where clustering should start
C!    Used only for VET95
C!    If first and last strips are fired, start after the first
C!    non fired strip. The beginning will be attached to the
C!    last cluster at the end
C!
C! Author A. Bonissent March 1995
C?
C!======================================================================
#ifndef DOC
#include "vdflgs.h"
C PARAMETERS-
C MSKIP = mask for defining generic 'unbonded' strip
C MSGOOD = ANTI-mask for defining generic good strip
C
      INTEGER NAMIND
C
      INTEGER IBEG
C
      INTEGER MGOOD,MSKIP
      PARAMETER (MSKIP = VBSUPP+VBHOTC+VBNOIS+VBUNBD+VBUNUS)
      PARAMETER (MGOOD = VBSUPP+VBHOTC+VBNOIS+VBUNBD+VBUNUS)
      INTEGER KVFHL,KVFPH,KVFLG,KVCOM,NAVCSG,NVCSG,NSKL
      INTEGER IVCSG,IPH,IFL,IFLG,NGAPL,NSKH,NSKIP,ICURR,NGAP
#include "vrecon.h"
      LOGICAL FIRST,SSKIP,SGOOD
      DATA FIRST /.TRUE./
#include "vcsgjj.h"
#include "bcs.h"
#include "bmacro.h"
      SGOOD(IFLG) = IFLG.GT.0.AND.IAND(IFLG,MGOOD).EQ.0
      SSKIP(IFLG) = IAND(IFLG,MSKIP).GT.0
C
      IF(FIRST)THEN
        FIRST=.FALSE.
        NAVCSG=NAMIND('VCSG')
      ENDIF
      KVCSG=IW(NAVCSG)
      NVCSG=LROWS(KVCSG)
      NSKL=0
C
C Find first fired strip, and count number of skipped strips
C from the beginning
C
      DO 10 IVCSG=1,NVCSG
        IPH=RTABL(KVCSG,IVCSG,JVCSMP)
        IFL=ITABL(KVCSG,IVCSG,JVCSMF)
        IF(SSKIP(IFL))NSKL=NSKL+1
        IF(SGOOD(IFL).AND.IPH.GE.MNPULS)THEN
          IBEG=IVCSG
          NGAPL=IVCSG-1
          GO TO 11
        ENDIF
 10   CONTINUE
 11   CONTINUE
      NSKH=0
C
C Find last fired strip, and count number of skipped strips
C to the end
C
      DO 20 IVCSG=1,NVCSG
        ICURR=NVCSG+1-IVCSG
        IPH=RTABL(KVCSG,ICURR,JVCSMP)
        IFL=ITABL(KVCSG,ICURR,JVCSMF)
        IF(SSKIP(IFL))NSKH=NSKH+1
        IF(SGOOD(IFL).AND.IPH.GE.MNPULS)THEN
          NGAPH=IVCSG-1
          GO TO 21
        ENDIF
 20   CONTINUE
 21   CONTINUE
      NSKIP=NSKL+NSKH
      NGAP=NGAPL+NGAPH
C
C if the cluster which would connect the last to first
C strips does not contain only dead channels,
C or is too long, then clustering should start at first
C strip
      IF((NGAP-NSKIP).NE.0.OR.NSKIP.GT.MXUNBD)IBEG=1
      RETURN
      END
#endif
@
