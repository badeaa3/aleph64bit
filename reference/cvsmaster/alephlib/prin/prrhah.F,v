head	1.4;
access;
symbols
	aleph316_2:1.4
	aleph316_1:1.4
	aleph316:1.4
	aleph315_7:1.4
	aleph315_6:1.4
	aleph315_5:1.4
	aleph315_4:1.4
	aleph315_3:1.4
	aleph315_2:1.4
	aleph315_1:1.4
	aleph315:1.4
	aleph314_2:1.4
	aleph314_1:1.4
	aleph314:1.4
	aleph313_1:1.1.1.1
	aleph313:1.1.1.1
	aleph312_1:1.1.1.1
	aleph312:1.1.1.1
	aleph311_1:1.1.1.1
	aleph311:1.1.1.1
	aleph310_3:1.1.1.1
	aleph310_2:1.1.1.1
	aleph310_1:1.1.1.1
	aleph310:1.1.1.1
	aleph309_1:1.1.1.1
	aleph309:1.1.1.1
	aleph308_3:1.1.1.1
	aleph308_2:1.1.1.1
	aleph308_1:1.1.1.1
	aleph308:1.1.1.1
	aleph307_6:1.1.1.1
	aleph307_5:1.1.1.1
	aleph307_4:1.1.1.1
	aleph307_2:1.1.1.1
	aleph307_1:1.1.1.1
	aleph307:1.1.1.1
	aleph306:1.1.1.1
	aleph305_4:1.1.1.1
	aleph305_3:1.1.1.1
	aleph305_2:1.1.1.1
	aleph305_1:1.1.1.1
	aleph305:1.1.1.1
	aleph304_5:1.1.1.1
	aleph304_4:1.1.1.1
	aleph304_3:1.1.1.1
	aleph304_2:1.1.1.1
	aleph304_1:1.1.1.1
	aleph304:1.1.1.1
	aleph303_3:1.1.1.1
	aleph303_2:1.1.1.1
	aleph303_1_mc1:1.1.1.1
	aleph303_1:1.1.1.1
	aleph303:1.1.1.1
	aleph302_9:1.1.1.1
	aleph302_8:1.1.1.1
	aleph302_7:1.1.1.1
	aleph302_6:1.1.1.1
	aleph302_5:1.1.1.1
	aleph302_4:1.1.1.1
	aleph302_3:1.1.1.1
	aleph302_2:1.1.1.1
	aleph302_1:1.1.1.1
	aleph302:1.1.1.1
	aleph216:1.1.1.1
	aleph215_3:1.1.1.1
	aleph215_2:1.1.1.1
	aleph215:1.1.1.1
	aleph214:1.1.1.1
	aleph213:1.1.1.1
	aleph212:1.1.1.1
	ALEPH212:1.1.1;
locks; strict;
comment	@c @;


1.4
date	99.12.10.12.43.34;	author cattanem;	state Exp;
branches;
next	1.3;

1.3
date	99.12.08.16.28.40;	author cattanem;	state Exp;
branches;
next	1.2;

1.2
date	99.12.07.17.05.39;	author flr;	state Exp;
branches;
next	1.1;

1.1
date	96.02.07.11.43.18;	author flr;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	96.02.07.11.43.19;	author flr;	state Exp;
branches;
next	;


desc
@@


1.4
log
@Fix format statement
@
text
@      SUBROUTINE PRRHAH
C ----------------------------------------------------------------------
C! Prints bank RHAH in Readable Format
CKEY PRINT RHAH RUN HEADER / USER
C Author     J. Boucrot     26-Sep-1988    modified  02-Feb-1989
C Modified   F. Ranjard     06-Dec-1999    y2k fix
C Called from USER
C Input bank : RHAH  ( Run Header Analysis History )
C ----------------------------------------------------------------------
#ifndef DOC
      SAVE
#include "bcs.h"
#include "runrjj.h"
#include "rhahjj.h"
      EXTERNAL CHAINT,INTCHA,NAMIND
      CHARACTER*4 CHAINT,PRNAM,COMPE
      CHARACTER*6 CALDA(4),FILCA(6)
      CHARACTER*12 CINOU(2)
      INTEGER ICHN(2,3)
      DATA FILCA /'  None','  Kine','   Raw','   POT','   DST',
     +            '  Mdst' /
      DATA CALDA / '      ','MCarlo','  Data' , 'S Data' /
      DATA IONC / 0 /
#include "bmacro.h"
C ----------------------------------------------------------------------
      IF (IONC.EQ.0) THEN
         LOUT=IW(6)
         NAMRH=NAMIND('RHAH')
         NRUNR=NAMIND('RUNR')
         IONC=1
      ENDIF
      JRHAH=IW(NAMRH)
      JRUNR=IW(NRUNR)
      IF (JRHAH.EQ.0.OR.JRUNR.EQ.0) THEN
         WRITE (LOUT,'(''  +++ PRRHAH : no RHAH/RUNR bank - RETURN'')')
         GO TO 999
      ENDIF
C
      NRUN=IW(JRUNR+JRUNRN)
      WRITE (LOUT,1020) NRUN
 1020 FORMAT(/1X,'+++ PRRHAH +++ Run Header Analysis History Bank',
     &   ' for RUN Number : ',I8//,
     &   T3,'Program',T16,'Date and hour',T34,'Program',
     &   T44,'Correction',T57,'Alephlib',
     &   T70,'Database',T87,'Input File',T103,'Output File',
     &   T117,'Computer',/
     &   T5,'Name',T16,'of processing',T34,'Vers. #',T44,'Vers. #',
     &   T57,'Vers. #',T68,'Vers. #',T79,'Date'/)
C
      NROWS=LROWS(JRHAH)
      IMCAR=2
      DO 10 I=1,NROWS
         KRHAH=KROW(JRHAH,I)
         ISDIN=0
         NATIN=IW(KRHAH+JRHANI)
         IF (NATIN.GT.10) THEN
            ISDIN=1
            NATIN=MOD(NATIN,10)
         ENDIF
         ISDOU=0
         NATOU=IW(KRHAH+JRHANO)
         IF (NATOU.GT.10) THEN
            ISDOU=1
            NATOU=MOD(NATOU,10)
         ENDIF
         PRNAM=CHAINT(IW(KRHAH+JRHAPN))
         IF (PRNAM.EQ.'GALE') IMCAR=1
         IF (NATOU.EQ.1) THEN
            CINOU(2)=CALDA(1)//FILCA(2)
         ELSE
            IMOU=IMCAR
            IF (ISDOU.EQ.1) IMOU=3
            CINOU(2)=CALDA(IMOU+1)//FILCA(NATOU+1)
         ENDIF
         IF (NATIN.LE.1) THEN
            CINOU(1)=CALDA(1)//FILCA(NATIN+1)
         ELSE
            IMIN=IMCAR
            IF (ISDIN.EQ.1) IMIN=3
            CINOU(1)=CALDA(IMIN+1)//FILCA(NATIN+1)
         ENDIF
         IF (CHAINT(IW(KRHAH+JRHAPN+1)).EQ.'ALPH'.
     +       AND.MOD(NATIN,10).EQ.5)   GO TO 10
         DO 2 II=1,2
            DO 1 LL=1,3
               LLL=4*(LL-1)+1
 1          ICHN(II,LL)=INTCHA(CINOU(II)(LLL:LLL+3))
 2       CONTINUE
C
         COMPE=' '
         IF (LCOLS(JRHAH).GT.JRHACV) THEN
            IF (IW(KRHAH+JRHANU).NE.0) COMPE=CHAINT(IW(KRHAH+JRHANU))
         ENDIF
         WRITE (LOUT,1005)   IW(KRHAH+JRHAPN),IW(KRHAH+JRHAPN+1),
     +         (IW(KRHAH+LI),LI=JRHAPD,JRHAPV),IW(KRHAH+JRHACV),
     +         (IW(KRHAH+LL),LL=JRHAAV,JRHADD),(ICHN(1,K),K=1,3),
     +         (ICHN(2,L),L=1,3),COMPE
C +y2k
 1005    FORMAT (2X,2A4,T14,I8,T23,I9,T33,I6,T42,I6,T58,I4,T69,I4,
     &           T77,I8,T87,3A4,T103,3A4,T120,A4)
C -y2k
C
 10   CONTINUE
C
 999  RETURN
      END
#endif




@


1.3
log
@Alephlib 314, including y2k fixes
@
text
@d100 1
a100 1
     &           T77,I6,T87,3A4,T103,3A4,T120,A4)
@


1.2
log
@alephlib 314 - Y2K compliant
@
text
@d5 2
a6 1
C Author     J. Boucrot     26-Sept-1988    modified  02-Feb-1989
d98 1
d101 1
@


1.1
log
@Initial revision
@
text
@d97 1
a97 1
 1005    FORMAT (2X,2A4,T14,I6,T23,I9,T33,I6,T42,I6,T58,I4,T69,I4,
d105 4
@


1.1.1.1
log
@import aleph212 from alws
@
text
@@
