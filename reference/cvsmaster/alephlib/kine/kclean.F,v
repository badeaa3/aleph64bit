head	1.5;
access;
symbols
	aleph316_2:1.5
	aleph316_1:1.5
	aleph316:1.5
	aleph315_7:1.5
	aleph315_6:1.5
	aleph315_5:1.5
	aleph315_4:1.5
	aleph315_3:1.5
	aleph315_2:1.5
	aleph315_1:1.5
	aleph315:1.5
	aleph314_2:1.5
	aleph314_1:1.5
	aleph314:1.5
	aleph313_1:1.5
	aleph313:1.5
	aleph312_1:1.5
	aleph312:1.5
	aleph311_1:1.5
	aleph311:1.5
	aleph310_3:1.4
	aleph310_2:1.4
	aleph310_1:1.4
	aleph310:1.4
	aleph309_1:1.4
	aleph309:1.4
	aleph308_3:1.4
	aleph308_2:1.4
	aleph308_1:1.4
	aleph308:1.4
	aleph307_6:1.4
	aleph307_5:1.4
	aleph307_4:1.4
	aleph307_2:1.4
	aleph307_1:1.4
	aleph307:1.4
	aleph306:1.4
	aleph305_4:1.4
	aleph305_3:1.4
	aleph305_2:1.4
	aleph305_1:1.4
	aleph305:1.4
	aleph304_5:1.4
	aleph304_4:1.4
	aleph304_3:1.4
	aleph304_2:1.4
	aleph304_1:1.4
	aleph304:1.4
	aleph303_3:1.4
	aleph303_2:1.4
	aleph303_1_mc1:1.4
	aleph303_1:1.3
	aleph303:1.3
	aleph302_9:1.3
	aleph302_8:1.3
	aleph302_7:1.3
	aleph302_6:1.3
	aleph302_5:1.3
	aleph302_4:1.3
	aleph302_3:1.3
	aleph302_2:1.3
	aleph302_1:1.3
	aleph302:1.3
	aleph216:1.3
	aleph215_3:1.3
	aleph215_2:1.3
	aleph215:1.2
	aleph214:1.2
	aleph213:1.2
	aleph212:1.1.1.1
	ALEPH212:1.1.1;
locks; strict;
comment	@c @;


1.5
date	99.04.06.11.44.03;	author cattanem;	state Exp;
branches;
next	1.4;

1.4
date	97.06.02.08.49.27;	author cattanem;	state Exp;
branches;
next	1.3;

1.3
date	96.09.03.13.05.46;	author cattanem;	state Exp;
branches;
next	1.2;

1.2
date	96.05.24.18.14.02;	author cattanem;	state Exp;
branches;
next	1.1;

1.1
date	96.02.07.11.42.28;	author flr;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	96.02.07.11.42.29;	author flr;	state Exp;
branches;
next	;


desc
@@


1.5
log
@Prepare alephlib 311
@
text
@      SUBROUTINE KCLEAN(IOK)
C -----------------------------------------------------------------
C -  B.Bloch September 92
C! Clean up data cards from Data Base overwritten by possible user's
C! cards
CKEY KINE KINGAL INIT  /   INTERNAL
C    IOK = 0  ok
C    IOK = 1  error occured
C ------------------------------------------------------------------
#include "bcs.h"
C----------------------------------------------------------------------
C  Banks input to KINGAL are of different types:
C
C   Banks with an explicit NR : MSTJ,PARJ,... for JETSET 7.3
C   -------------------------   MSTA,PARA     for ARIADNE
C                               GMAS          for HERWIG
C   the last one read in from  user input  wins!
C
C   Banks with no explicit NR : GMOB,GADM,GRPL for JETSET modifications
C   --------------------------
C   The last one is taken into account but you may copy many arrays
C   before getting through.Better drop those which are overwritten
C
C   Banks with no explicit NR : GHVF,GDYM,GMIX....  for HVFL02
C   --------------------------  GARI                for Ariadne
C                               GHRW,GGSW,GBDE,GPAR for Herwig
C                               GKOR,GBEA,GTAU,GKBR for Koralz
C                               SVRT,XVRT           for general use
C   There should be only one bank with a given name , better drop the
C   first one if another has been provided by the user .Rename it to
C   NR = 0 , in case the generator makes an explicit link to it instead
C   of using NAMIND.
C----------------------------------------------------------------------
#ifndef DOC
      CHARACTER*4 BLAST,BSING
      PARAMETER ( NSING = 21 , NLAST = 3 )
      DIMENSION BLAST(NLAST),BSING(NSING)
      DIMENSION NRDRP(10)
      DATA BLAST /'GADM','GRPL','GMOB'/
      DATA BSING /'GHVF','GDYM','GMIX','GCPV','GSTA','GVBU','GSEM',
     $            'GPHO','GDSS','GBUS','SVRT','GARI','GHRW','GGSW',
     $            'GBDE','GPAR','GKOR','GBEA','GTAU','GKBR','XVRT'/
      IOK = 0
C   Single copy banks
      DO 10  I = 1,NSING
         NAMI = NAMIND(BSING(I))
C   Bank exists?
         IF ( IW(NAMI).LE.0 ) GO TO 10
         ND = 0
         IND = NAMI+1
C   Loop on banks with same name
    8    IND = IW(IND-1)
C   Count and record extra copies
         IF ( IND.NE.0 ) THEN
            ND = ND + 1
            NRDRP(ND) = IW(IND-2)
            GO TO 8
         ENDIF
         IF ( ND.LE.1) GO TO 10
C  Drop undesired banks
         DO 9 J = 1 ,ND-1
             WRITE ( IW(6) ,100) BSING(I),NRDRP(J)
             JIND = NDROP(BSING(I),NRDRP(J))
    9    CONTINUE
   10 CONTINUE
      DO 11  I = 1,NSING
         NAMI = NAMIND(BSING(I))
         IND = IW(NAMI)
         IF ( IND.GT.0) THEN
            NR = IW(IND-2)
            IF ( NR.NE.0) THEN
              WRITE( IW(6),300) BSING(I),NR
              IW(IND-2) = 0
            ENDIF
         ENDIF
   11 CONTINUE
C   Multi- copy banks to be reduced to single copy
      DO 20  I = 1,NLAST
         NAMI = NAMIND(BLAST(I))
C   Bank exists?
         IF ( IW(NAMI).LE.0 ) GO TO 20
         ND = 0
         IND = NAMI+1
C   Loop on banks with same name  and KF code
   18    IND = IW(IND-1)
C   Count and record extra copies
         IF ( IND.NE.0 ) THEN
            KF =  IW(IND+1)
            CALL KKDROP( BLAST(I),KF)
            GO TO 18
         ENDIF
   20 CONTINUE
      CALL KKMOVE
  999 WRITE( IW(6),200)
      RETURN
  100 FORMAT ( 1X,'++++KCLEAN : DROPPING  Bank ',A10,'  NR = ',I5,
     $       '  From KREF ...superseded by user INPUT')
  300 FORMAT ( 1X,'++++KCLEAN : RENAMING  Bank ',A10,'  NR = ',I5,
     $       '  To NR = 0    ')
 200  FORMAT(1X,/,'============= End of section  to handle user',
     $            ' input superseding KREF defaults ==============')
      END
#endif
@


1.4
log
@Modifs from Brigitte to /kine
@
text
@d28 1
d36 1
a36 1
      PARAMETER ( NSING = 20 , NLAST = 3 )
d42 1
a42 1
     $            'GBDE','GPAR','GKOR','GBEA','GTAU','GKBR'/
@


1.3
log
@add missing #ifdef DOCs
@
text
@d27 1
a27 1
C                               GKOR,GBEA,GTAU      for Koralz
d41 1
a41 1
     $            'GBDE','GPAR','GKOR','GBEA','GTAU','    '/
@


1.2
log
@kclean.F: suppress character string on two lines
@
text
@d33 1
d102 1
@


1.1
log
@Initial revision
@
text
@d98 2
a99 2
 200  FORMAT(1X,/,'============= End of section  to handle user input su
     $perseding KREF defaults ==============')
@


1.1.1.1
log
@import aleph212 from alws
@
text
@@
