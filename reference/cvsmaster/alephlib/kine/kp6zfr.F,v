head	1.1;
access;
symbols
	aleph316_2:1.1
	aleph316_1:1.1
	aleph316:1.1
	aleph315_7:1.1
	aleph315_6:1.1
	aleph315_5:1.1
	aleph315_4:1.1
	aleph315_3:1.1
	aleph315_2:1.1
	aleph315_1:1.1
	aleph315:1.1
	aleph314_2:1.1
	aleph314_1:1.1
	aleph314:1.1
	aleph313_1:1.1
	aleph313:1.1
	aleph312_1:1.1
	aleph312:1.1
	aleph311_1:1.1
	aleph311:1.1
	aleph310_3:1.1
	aleph310_2:1.1
	aleph310_1:1.1
	aleph310:1.1
	aleph309_1:1.1
	aleph309:1.1
	aleph308_3:1.1
	aleph308_2:1.1
	aleph308_1:1.1
	aleph308:1.1
	aleph307_6:1.1
	aleph307_5:1.1
	aleph307_4:1.1
	aleph307_2:1.1
	aleph307_1:1.1;
locks; strict;
comment	@c @;


1.1
date	98.02.06.14.26.59;	author cattanem;	state Exp;
branches;
next	;


desc
@@


1.1
log
@New interface routines to Pythia 6.1
@
text
@      subroutine KP6ZFR(IST)
C--------------------------------------------------------------------
C!  BOOK and fill bank KZFR with fragmentation info
C      B. Bloch -Devaux November 1998 for PYTHIA 6.1
C     structure : subroutine
C
C     input     : none
C
C     output    : IST status flag ( 0 means ok)
C     comdecks referenced : PYT6COM
C--------------------------------------------------------------------
#ifndef DOC
#include "pyt6com.h"
C
      REAL*4 ZB(LJNPAR)
      Integer ALTABL
      External ALTABL
      IST = 0
C  Reset ZB storage
      CALL VZERO(ZB,LJNPAR)
C keep fragmentation info
      IF (N7LU.GT.0) CALL KPYZET(ZB)
C
C   Set the ZB value according to KINE numbering, i.e. remove beam part.
C   and transmit z of mother to subsequent heavy baryons and mesons
      IBEA = 0
      DO 27 ITR=1,N7LU
      KS = K7LU(ITR,1)
      KM = K7LU(ITR,3)
C  Give same z to all daughters  of a mother
      IF (KM.GT.IBEA .AND. ZB(KM-IBEA).GT.0. ) ZB(ITR) = ZB(KM-IBEA)
      IF ( KS.EQ.21 .AND. ABS(K7LU(ITR,2)).EQ.11 ) THEN
       IBEA = IBEA +1
      ELSE
       ZB(ITR-IBEA) = ZB (ITR)
      ENDIF
 27   CONTINUE
C
C   Book & fill the bank KZFR with info on fragmentation
C
      NP = N7LU-IBEA
      JKZFR = ALTABL('KZFR',1,NP,ZB,'2I,(F)','E')
      IF(JKZFR.LE.0) IST = -100
      RETURN
      END
#endif
@
