head	1.2;
access;
symbols
	aleph316_2:1.2
	aleph316_1:1.2
	aleph316:1.2
	aleph315_7:1.2
	aleph315_6:1.2
	aleph315_5:1.2
	aleph315_4:1.2
	aleph315_3:1.2
	aleph315_2:1.2
	aleph315_1:1.2
	aleph315:1.2
	aleph314_2:1.2
	aleph314_1:1.2
	aleph314:1.2
	aleph313_1:1.2
	aleph313:1.2
	aleph312_1:1.2
	aleph312:1.2
	aleph311_1:1.2
	aleph311:1.2
	aleph310_3:1.2
	aleph310_2:1.2
	aleph310_1:1.2
	aleph310:1.2
	aleph309_1:1.2
	aleph309:1.2
	aleph308_3:1.2
	aleph308_2:1.2
	aleph308_1:1.2
	aleph308:1.2
	aleph307_6:1.2
	aleph307_5:1.2
	aleph307_4:1.2
	aleph307_2:1.2
	aleph307_1:1.2
	aleph307:1.1
	aleph306:1.1
	aleph305_4:1.1
	aleph305_3:1.1
	aleph305_2:1.1
	aleph305_1:1.1
	aleph305:1.1
	aleph304_5:1.1
	aleph304_4:1.1
	aleph304_3:1.1
	aleph304_2:1.1
	aleph304_1:1.1
	aleph304:1.1
	aleph303_3:1.1
	aleph303_2:1.1
	aleph303_1_mc1:1.1;
locks; strict;
comment	@c @;


1.2
date	98.01.15.10.40.59;	author cattanem;	state Exp;
branches;
next	1.1;

1.1
date	97.06.02.08.49.36;	author cattanem;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Mods to kine routines, alephlib 307.1
@
text
@      subroutine KZFRBK(IST)
C--------------------------------------------------------------------
C!  BOOK bank KZFR with fragmentation info
C      B. Bloch -Devaux November 1994 IMPLEMENTATION OF HVFL05 
C      modified December 97 : take booking of bank out of do loop
C     structure : subroutine 
C 
C     input     : none 
C 
C     output    : IST status flag ( 0 means ok)
C     comdecks referenced : LUN7COM 
C--------------------------------------------------------------------
#ifndef DOC
      SAVE
#include "lun7com.h"
      REAL*4 ZB(LJNPAR)
      Integer ALTABL
      External ALTABL
      IST = 0
C  Reset ZB storage
      CALL VZERO(ZB,LJNPAR)
C keep fragmentation info
      IF (N7LU.GT.0) CALL KLUZET(ZB)
C
C   Set the ZB value according to KINE numbering, i.e. remove beam part.
C   and transmit z of mother to subsequent heavy baryons and mesons
      IBEA = 0
      DO 27 ITR=1,N7LU
      KS = K7LU(ITR,1)
      KM = K7LU(ITR,3)
C  Give same z to all daughters  of a mother
      IF (KM.GT.IBEA .AND. ZB(KM-IBEA).GT.0. ) ZB(ITR) = ZB(KM-IBEA)
      IF ( KS.EQ.21 .AND. ABS(K7LU(ITR,2)).EQ.11 ) THEN
       IBEA = IBEA +1
      ELSE
       ZB(ITR-IBEA) = ZB (ITR)
      ENDIF
 27   CONTINUE
C
C   Book & fill the bank KZFR with info on fragmentation
C
      NP = N7LU-IBEA
      JKZFR = ALTABL('KZFR',1,NP,ZB,'2I,(F)','E')
      IF(JKZFR.LE.0) IST = -100
      RETURN
      END 
#endif
@


1.1
log
@Modifs from Brigitte to /kine
@
text
@d5 1
d38 1
a44 1
 27   CONTINUE
@
