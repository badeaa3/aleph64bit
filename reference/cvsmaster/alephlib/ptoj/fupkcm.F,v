head	1.3;
access;
symbols
	aleph316_2:1.3
	aleph316_1:1.3
	aleph316:1.3
	aleph315_7:1.3
	aleph315_6:1.3
	aleph315_5:1.3
	aleph315_4:1.3
	aleph315_3:1.3
	aleph315_2:1.3
	aleph315_1:1.3
	aleph315:1.3
	aleph314_2:1.3
	aleph314_1:1.3
	aleph314:1.3
	aleph313_1:1.3
	aleph313:1.3
	aleph312_1:1.2
	aleph312:1.2
	aleph311_1:1.2
	aleph311:1.2
	aleph310_3:1.2
	aleph310_2:1.2
	aleph310_1:1.2
	aleph310:1.2
	aleph309_1:1.2
	aleph309:1.2
	aleph308_3:1.2
	aleph308_2:1.2
	aleph308_1:1.2
	aleph308:1.2
	aleph307_6:1.2
	aleph307_5:1.2
	aleph307_4:1.2
	aleph307_2:1.2
	aleph307_1:1.2
	aleph307:1.2
	aleph306:1.2
	aleph305_4:1.2
	aleph305_3:1.2
	aleph305_2:1.2
	aleph305_1:1.2
	aleph305:1.2
	aleph304_5:1.2
	aleph304_4:1.2
	aleph304_3:1.2
	aleph304_2:1.2
	aleph304_1:1.2
	aleph304:1.2
	aleph303_3:1.2
	aleph303_2:1.2
	aleph303_1_mc1:1.2
	aleph303_1:1.2
	aleph303:1.2
	aleph302_9:1.2
	aleph302_8:1.2
	aleph302_7:1.2
	aleph302_6:1.2
	aleph302_5:1.2
	aleph302_4:1.2
	aleph302_3:1.2
	aleph302_2:1.2
	aleph302_1:1.2
	aleph302:1.2
	aleph216:1.2
	aleph215_3:1.2
	aleph215_2:1.2
	aleph215:1.1.1.1
	aleph214:1.1.1.1
	aleph213:1.1.1.1
	aleph212:1.1.1.1
	ALEPH212:1.1.1;
locks; strict;
comment	@c @;


1.3
date	99.10.26.09.32.51;	author cattanem;	state Exp;
branches;
next	1.2;

1.2
date	96.09.03.13.06.07;	author cattanem;	state Exp;
branches;
next	1.1;

1.1
date	96.02.07.11.43.21;	author flr;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	96.02.07.11.43.22;	author flr;	state Exp;
branches;
next	;


desc
@@


1.3
log
@for Alephlib 313
@
text
@      SUBROUTINE FUPKCM (CIN,COUT)
C-----------------------------------------------------------------------
C!  Unpack covariance matrix of a track
C!
CKEY PTOJ UNPACK/INTERNAL
C!
C!   AUTHOR  :- JUERGEN SPIEKERMANN     8-AUG-1991
C!              THOMAS LOHSE
C!   Modified:  D.Smith  991026  Double precision fixes for Linux
C!
C!   INPUTS: COUT
C!        -  CONVERTED COVARIANCE MATRIX IN TRIANGULAR FORM
C!                     EIGENVALUES ON DIAGONAL
C!                     10 ANGLES DIVIDED BY PI ON OFF DIGONAL PLACES
C!
C!   OUTPUTS: CIN
C!         -  COVARIANCE MATRIX IN TRIANGULAR FORM
C!
C!
C!   DESCRIPTION
C!   ===========
C!   THIS SUBROUTINE RECONSTRUCTS THE COVARIANCE MATRIX CONVERTED BY
C!   SUBROUTINE FPKCM.
C?
C!======================================================================
#ifndef DOC
C
#include "alcons.h"
C
C     ----------------- N: DIMENSION OF COVARIANCE-MATRIX
C     ----------------- M:=N*(N+1)/2  DIMENSION OF VECTORS CIN,COUT
C
      SAVE
      INTEGER N,M,I,J,K
      PARAMETER (N=5,M=N*(N+1)/2)
C
      REAL CIN(M),COUT(M)
C
      DOUBLE PRECISION A(N,N),F(N),CO,SI,A1,A2,PHI
      DOUBLE PRECISION SQF(N,N)
      LOGICAL FIRST
      DATA    FIRST / .TRUE. /
C     ----------------- EMPIRICAL FACTORS (SAME AS IN FPKCM)
      DATA F/0.266213086238216270D-09,
     &       0.111459714704705784D-04,
     &       0.520405078704231984D-05,
     &       0.170197042982578003D-02,
     &       0.211312784985526782D-01/
C
      IF ( FIRST ) THEN
C
C?   Compute once the DSQRT of the product of the constants
C
        FIRST = .FALSE.
        DO 41 I = 1 , N
          DO 51 J = 1 , N
            SQF(I,J) = DSQRT( F(I)*F(J) )
   51     CONTINUE
   41   CONTINUE
      ENDIF
C     ----------------- CREATE UNITY MATRIX IN A
      DO 30 I=1,N
       A(I,I)=1.D0
       DO 40 J=I+1,N
        A(I,J)=0.D0
        A(J,I)=0.D0
   40  CONTINUE
   30 CONTINUE
C     ----------------- RECONSTRUCT A
      DO 50 I=N-1,1,-1
       DO 60 J=I+1,N
        PHI=CIN(I+J*(J-1)/2)*PI
        CO=DCOS(PHI)
        SI=DSIN(PHI)
        DO 70 K=1,N
         A1=CO*A(K,J-1)-SI*A(K,J)
         A2=SI*A(K,J-1)+CO*A(K,J)
         A(K,J-1)=A1
         A(K,J)=A2
   70   CONTINUE
   60  CONTINUE
   50 CONTINUE
C     ----------------- CALCULATE A*LAMDA*AT
      DO 80 I=1,N
       DO 90 K=I,N
        A1=0.D0
        DO 100 J=1,N
         A1=A1+A(I,J)*A(K,J)*CIN(J*(J+1)/2)
  100   CONTINUE
        COUT(I+K*(K-1)/2)=A1*SQF(I,K)
   90  CONTINUE
   80 CONTINUE
      END
#endif
@


1.2
log
@add missing #ifdef DOCs
@
text
@d9 2
d46 3
a48 3
     &       0.520405078704231984E-05,
     &       0.170197042982578003E-02,
     &       0.211312784985526782E-01/
@


1.1
log
@Initial revision
@
text
@d24 1
d92 1
@


1.1.1.1
log
@import aleph212 from alws
@
text
@@
