head	1.1;
branch	1.1.1;
access;
symbols
	aleph316_2:1.1.1.1
	aleph316_1:1.1.1.1
	aleph316:1.1.1.1
	aleph315_7:1.1.1.1
	aleph315_6:1.1.1.1
	aleph315_5:1.1.1.1
	aleph315_4:1.1.1.1
	aleph315_3:1.1.1.1
	aleph315_2:1.1.1.1
	aleph315_1:1.1.1.1
	aleph315:1.1.1.1
	aleph314_2:1.1.1.1
	aleph314_1:1.1.1.1
	aleph314:1.1.1.1
	aleph313_1:1.1.1.1
	aleph313:1.1.1.1
	aleph312_1:1.1.1.1
	aleph312:1.1.1.1
	aleph311_1:1.1.1.1
	aleph311:1.1.1.1
	aleph310_3:1.1.1.1
	aleph310_2:1.1.1.1
	aleph310_1:1.1.1.1
	aleph310:1.1.1.1
	aleph309_1:1.1.1.1
	aleph309:1.1.1.1
	aleph308_3:1.1.1.1
	aleph308_2:1.1.1.1
	aleph308_1:1.1.1.1
	aleph308:1.1.1.1
	aleph307_6:1.1.1.1
	aleph307_5:1.1.1.1
	aleph307_4:1.1.1.1
	aleph307_2:1.1.1.1
	aleph307_1:1.1.1.1
	aleph307:1.1.1.1
	aleph306:1.1.1.1
	aleph305_4:1.1.1.1
	aleph305_3:1.1.1.1
	aleph305_2:1.1.1.1
	aleph305_1:1.1.1.1
	aleph305:1.1.1.1
	aleph304_5:1.1.1.1
	aleph304_4:1.1.1.1
	aleph304_3:1.1.1.1
	aleph304_2:1.1.1.1
	aleph304_1:1.1.1.1
	aleph304:1.1.1.1
	aleph303_3:1.1.1.1
	aleph303_2:1.1.1.1
	aleph303_1_mc1:1.1.1.1
	aleph303_1:1.1.1.1
	aleph303:1.1.1.1
	aleph302_9:1.1.1.1
	aleph302_8:1.1.1.1
	aleph302_7:1.1.1.1
	aleph302_6:1.1.1.1
	aleph302_5:1.1.1.1
	aleph302_4:1.1.1.1
	aleph302_3:1.1.1.1
	aleph302_2:1.1.1.1
	aleph302_1:1.1.1.1
	aleph302:1.1.1.1
	aleph216:1.1.1.1
	aleph215_3:1.1.1.1
	aleph215_2:1.1.1.1
	aleph215:1.1.1.1
	aleph214:1.1.1.1
	aleph213:1.1.1.1
	aleph212:1.1.1.1
	ALEPH212:1.1.1;
locks; strict;
comment	@c @;


1.1
date	96.02.07.11.43.22;	author flr;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	96.02.07.11.43.23;	author flr;	state Exp;
branches;
next	;


desc
@@



1.1
log
@Initial revision
@
text
@      SUBROUTINE PCPATQ(IER)
C----------------------------------------------------------------------
CKEY PTOJ PCPA PCQA / USER
C----------------------------------------------------------------------
C!  - prepare PARLOC array ready to fill PCQA bank from PCPA bank.
C!
C!     IER =  0 OK
C!         = -1 banks missing
C!   Author   :-J. Carr    8 May 1991
C!    modified:-J. Carr    20 June 1991
C!
C!======================================================================
#ifndef DOC
      SAVE
#include "bcs.h"
#include "pcqajj.h"
#include "pcpajj.h"
C
      PARAMETER (NMLINE=50)
      DIMENSION LINEPC(NMLINE)
      PARAMETER ( MXNEUT=300 )
      DIMENSION PARLOC(MXNEUT,5)
      DIMENSION IPEPC(MXNEUT),IPCOB(MXNEUT),ITYPE(MXNEUT)
      LOGICAL PARGON(MXNEUT)
C
      LOGICAL FIRST
      LOGICAL HADRO,GAMMA,GAMEX,GARBA,LCALO
      DATA FIRST/.TRUE./
#include "bmacro.h"
      HADRO(IY) = IY.GE.13.AND.IY.LE.20
      GAMMA(IY) = IY.LT.13.AND.IY.NE.5
      GAMEX(IY) = IY.EQ.5
      GARBA(IY) = IY.EQ.21
      LCALO(IY) = IY.EQ.22
C ------------------------------------------------------------------
C
      IF(FIRST) THEN
        MPCPA = NAMIND ('PCPA')
        MPECO = NAMIND ('PECO')
        MPCOB = NAMIND ('PCOB')
        MNEMO = NAMIND ('NEMO')
        FIRST=.FALSE.
      ENDIF
C
      JPCPA = IW(MPCPA)
      IF(JPCPA.EQ.0)GOTO 999
      LPCPA = IW(JPCPA-1)
      NMAXP = MIN(IW(JPCPA+LMHLEN),MXNEUT)
C
      DO 30 I=1,NMAXP
        EN = RTABL(JPCPA,I,JPCPEN)
        TH = RTABL(JPCPA,I,JPCPTE)
        PH = RTABL(JPCPA,I,JPCPFI)
        IY = ITABL(JPCPA,I,JPCPNA)
        ITYPE(I)=IY
        IPEPC(I)=0
        IPCOB(I)=0
        IF(IY.EQ.19.OR.IY.EQ.20)THEN
           PSUM = RTABL(JPCPA,I,JPCPR2)
           PN = RTABL(JPCPA,I,JPCPR1)
        ELSE
           PSUM=0.
           PN = EN
        ENDIF
        CP = COS (PH)
        SP = SIN (PH)
        CT = COS (TH)
        ST = SIN (TH)
        PT = PN * ST
        PARLOC(I,1) = PT * CP
        PARLOC(I,2) = PT * SP
        PARLOC(I,3) = PN * CT
        PARLOC(I,4) = EN
        PARLOC(I,5) = PSUM
        PARGON(I)=.FALSE.
        IF(GARBA(IY)) PARGON(I)=.TRUE.
  30    CONTINUE
C
C   store PECO and PCOB if want to merge PCPA particles later in PCMECU
C       ( no merge if CARD NEMO included )
C
      IF(IW(MNEMO).NE.0) GO TO 42
C
C   Now get rid of some particles
C
      KPECO  = IW (MPECO)
      IF (KPECO .EQ. 0) goto 999
C
C Find which PCPA objects are from same PECO object
      LPECO = LROWS (KPECO)
      DO 40 IPECO=1,LPECO
C
         CALL NVPECO(IPECO, LINEPC, NLINE, NMLINE, IER)
         IF(IER.LT.0) GO TO 999
C
         DO 21 I=1,NLINE
           IF(LINEPC(I).LE.MXNEUT) IPEPC(LINEPC(I))=IPECO
  21     CONTINUE
  40  CONTINUE
  42  CONTINUE
C
C Find which PCPA objects are from same PCOB object
      KPCOB  = IW (MPCOB)
      IF (KPCOB .EQ. 0) goto 999
      LPCOB = LROWS (KPCOB)
      IMERGE=0
      DO 41 IPCB=1,LPCOB
C
         CALL NVPCOB(IPCB, LINEPC, NLINE, NMLINE, IER)
         IF(IER.LT.0) GO TO 999
C
         DO 23 I=1,NLINE
            IF(LINEPC(I).LE.MXNEUT) IPCOB(LINEPC(I))=IPCB
  23     CONTINUE
  41  CONTINUE
C
      CALL PCMECU(NMAXP,MXNEUT,PARLOC,IPEPC,IPCOB,ITYPE,PARGON)
C
      IER=0
      RETURN
  999 CONTINUE
      IER=-1
      RETURN
      END
#endif
@


1.1.1.1
log
@import aleph212 from alws
@
text
@@
