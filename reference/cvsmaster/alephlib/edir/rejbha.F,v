head	1.1;
branch	1.1.1;
access;
symbols
	aleph316_2:1.1.1.1
	aleph316_1:1.1.1.1
	aleph316:1.1.1.1
	aleph315_7:1.1.1.1
	aleph315_6:1.1.1.1
	aleph315_5:1.1.1.1
	aleph315_4:1.1.1.1
	aleph315_3:1.1.1.1
	aleph315_2:1.1.1.1
	aleph315_1:1.1.1.1
	aleph315:1.1.1.1
	aleph314_2:1.1.1.1
	aleph314_1:1.1.1.1
	aleph314:1.1.1.1
	aleph313_1:1.1.1.1
	aleph313:1.1.1.1
	aleph312_1:1.1.1.1
	aleph312:1.1.1.1
	aleph311_1:1.1.1.1
	aleph311:1.1.1.1
	aleph310_3:1.1.1.1
	aleph310_2:1.1.1.1
	aleph310_1:1.1.1.1
	aleph310:1.1.1.1
	aleph309_1:1.1.1.1
	aleph309:1.1.1.1
	aleph308_3:1.1.1.1
	aleph308_2:1.1.1.1
	aleph308_1:1.1.1.1
	aleph308:1.1.1.1
	aleph307_6:1.1.1.1
	aleph307_5:1.1.1.1
	aleph307_4:1.1.1.1
	aleph307_2:1.1.1.1
	aleph307_1:1.1.1.1
	aleph307:1.1.1.1
	aleph306:1.1.1.1
	aleph305_4:1.1.1.1
	aleph305_3:1.1.1.1
	aleph305_2:1.1.1.1
	aleph305_1:1.1.1.1
	aleph305:1.1.1.1
	aleph304_5:1.1.1.1
	aleph304_4:1.1.1.1
	aleph304_3:1.1.1.1
	aleph304_2:1.1.1.1
	aleph304_1:1.1.1.1
	aleph304:1.1.1.1
	aleph303_3:1.1.1.1
	aleph303_2:1.1.1.1
	aleph303_1_mc1:1.1.1.1
	aleph303_1:1.1.1.1
	aleph303:1.1.1.1
	aleph302_9:1.1.1.1
	aleph302_8:1.1.1.1
	aleph302_7:1.1.1.1
	aleph302_6:1.1.1.1
	aleph302_5:1.1.1.1
	aleph302_4:1.1.1.1
	aleph302_3:1.1.1.1
	aleph302_2:1.1.1.1
	aleph302_1:1.1.1.1
	aleph302:1.1.1.1
	aleph216:1.1.1.1
	aleph215_3:1.1.1.1
	aleph215_2:1.1.1.1
	aleph215:1.1.1.1
	aleph214:1.1.1.1
	aleph213:1.1.1.1
	aleph212:1.1.1.1
	ALEPH212:1.1.1;
locks; strict;
comment	@c @;


1.1
date	96.02.07.11.41.39;	author flr;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	96.02.07.11.41.40;	author flr;	state Exp;
branches;
next	;


desc
@@



1.1
log
@Initial revision
@
text
@       SUBROUTINE REJBHA(XTOW,EWTOT,IQQT1,IQQT2,IOK)
C----------------------------------------------------------------------
CKEY EDIR BHABHA REJECTION
C! Subroutine to reject Bhabhas keeping hadrons and most of qqbars.
C! 2 rejections available: 1 based on PECO
C!                         2 based on wires
C-
C   Input  : XTOW(1-7) = Parameters of the 2 most energetic cluster
C            EWTOT     = Wire energy
C   Output : IQQT1     = 1 qqbar candidate if IOK = 0
C            IQQT2     = 1 qqbar candidate if IOK = 0
C            IOK       = 1 not a qqbar
C-
C   Called by   : SELCAL
C   Calls  : None
C   Input banks : None
C-
C                                    Author: S. Dugey - 910400
C----------------------------------------------------------------------
#ifndef DOC
      SAVE
C --
      DIMENSION XTOW (7)
C --
       IOK = 0
       IQQT1  = 0
       IQQT2  = 0
       EHIGH1 = XTOW(1)
       EHIGH2 = XTOW(2)
       TH1    = XTOW(3)
       TH2    = XTOW(4)
       EMAX1  = XTOW(6)
       EMAX2  = XTOW(7)
       NMOD   = INT(XTOW(6))
C --
C   Angular selection
C --
       L1 = 0
       L2 = 0
       IF( TH1.GT.20..AND.TH1.LT.160. )  L1 = 1
       IF( TH1.GT.38..AND.TH1.LT.42. )   L1 = 0
       IF( TH1.GT.138..AND.TH1.LT.142. ) L1 = 0
       IF( TH2.GT.20..AND.TH2.LT.160. )  L2 = 1
       IF( TH2.GT.38..AND.TH2.LT.42. )   L2 = 0
       IF( TH2.GT.138..AND.TH2.LT.142. ) L2 = 0
C --
C   Ratio (EMAXI + EMAXI2) / EWTOT
C --
       RAT = 0.
       IF(EWTOT.GT.0.) RAT = (EMAX1 + EMAX2 ) / EWTOT
       RATT= 0.
       IF(EWTOT.GT.0.) RATT= (EHIGH1+ EHIGH2) / EWTOT
C --
       IF(EWTOT.LT.80.) THEN
C --
C   Selection using the 2 most energetic ECAL objects
C --
          IF(EHIGH1.LT.35..AND.EHIGH2.LT.25.) THEN
             IF(L1.EQ.1.AND.L2.EQ.1) THEN
               IQQT1= 1
             ELSE
               IF(EHIGH2.LT.20.0.AND.RAT.LT.0.84) IQQT1= 1
             ENDIF
          ENDIF
C --
C   Selection using the 2 most energetic ECAL modules
C --
          IF(EMAX1.LT.35..AND.EMAX2.LT.25.) THEN
             IF(L1.EQ.1.AND.L2.EQ.1) THEN
              IQQT2= 1
             ELSE
              IF(RAT.LT.0.84) IQQT2= 1
             ENDIF
          ENDIF
       ENDIF
C --
C Bhabha selection
C --
       IF(EMAX1.GT.38..AND.EMAX2.GT.25.) THEN
         IF(RAT.GT.0.95) IOK = 1
       ELSE
         IF(L1.EQ.0.AND.L2.EQ.0) THEN
           IF(EWTOT.GT.55..AND.RAT.GT.0.90) IOK = 1
         ENDIF
       ENDIF
C --
       IF(NMOD.GT.3..AND.IOK.EQ.0) THEN
         IQQT1 = 1
         IQQT2 = 1
       ENDIF
C --
       RETURN
       END
#endif
@


1.1.1.1
log
@import aleph212 from alws
@
text
@@
