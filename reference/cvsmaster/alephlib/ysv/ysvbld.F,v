head	1.3;
access;
symbols
	aleph316_2:1.3
	aleph316_1:1.3
	aleph316:1.3
	aleph315_7:1.3
	aleph315_6:1.3
	aleph315_5:1.3
	aleph315_4:1.3
	aleph315_3:1.3
	aleph315_2:1.3
	aleph315_1:1.3
	aleph315:1.3
	aleph314_2:1.3
	aleph314_1:1.3
	aleph314:1.3
	aleph313_1:1.3
	aleph313:1.3
	aleph312_1:1.3
	aleph312:1.3
	aleph311_1:1.3
	aleph311:1.3
	aleph310_3:1.3
	aleph310_2:1.3
	aleph310_1:1.3
	aleph310:1.3
	aleph309_1:1.3
	aleph309:1.3
	aleph308_3:1.3
	aleph308_2:1.3
	aleph308_1:1.3
	aleph308:1.3
	aleph307_6:1.3
	aleph307_5:1.3
	aleph307_4:1.3
	aleph307_2:1.3
	aleph307_1:1.3
	aleph307:1.3
	aleph306:1.3
	aleph305_4:1.3
	aleph305_3:1.3
	aleph305_2:1.3
	aleph305_1:1.3
	aleph305:1.3
	aleph304_5:1.2
	aleph304_4:1.2
	aleph304_3:1.2
	aleph304_2:1.2
	aleph304_1:1.2
	aleph304:1.2
	aleph303_3:1.2
	aleph303_2:1.2
	aleph303_1_mc1:1.2
	aleph303_1:1.2
	aleph302:1.2
	aleph303:1.2
	aleph302_9:1.2
	aleph302_8:1.2
	aleph302_7:1.1
	aleph302_6:1.1
	aleph302_5:1.1;
locks; strict;
comment	@c @;


1.3
date	97.08.20.07.13.14;	author cattanem;	state Exp;
branches;
next	1.2;

1.2
date	97.04.17.07.28.28;	author flr;	state Exp;
branches;
next	1.1;

1.1
date	97.04.04.07.58.59;	author flr;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Alephlib 305
@
text
@      SUBROUTINE YSVBLD(IER)
C-----------------------------------------------------------------------
C! Find secondary charged and neutral vertices
C  IER = 0 if successful
C
C   Input banks:    FRFT    Track fits
C                   YLV0    High-purity long V0s (if any)
C                   PYER    Primary vertex
C       
C   Output banks:   YSVX    Reconstructed vertex candidates;
C                           NR = 0 contains the primary vertex
C                           NR = 1 contains a fit of each track and
C                                  V0 to the primary
C                           NR < 0 contains all vertices with a number
C                                  of constituents = ABS(NR); hence NR=-2
C                                  contains all two-track vertices, NR=-3
C                                  contains all three-track vertices, etc
C                                  (negative number is done so that a loop
C                                  starting with IW(NAMIND('YSVX')) begins
C                                  with the highest multiplicity vertices
C                                  (which are built from lower multiplicity
C                                  vertices).
C                   
C
C   Author   :- D. Casper   30-jun-1996
C=========================================
#ifndef DOC
C
#include "bcs.h"
#include "bosext.h"
#include "frftjj.h"
#include "ysvwrk.h"
#include "alcons.h"
C Initialize work bank indices
      DATA INDYSVW,INDYSEW,INDYSTW,INDYS0W,
     &      INDYSTL,INDYSTM,INDYS0L,INDYS0M,
     &      INDHXOU,INDVHOU,INDHXNU,INDVHNU,
     &      INDYSCW,INDYSCL,INDYSCM,INDCXOU,
     &      INDVCOU,INDYSKL/18*0/
C
      DATA NFRFT/0/
      SAVE NFRFT
C
#include "bmacro.h"
C --------------------------------------------------------------

      IF (NFRFT.EQ.0) THEN
        NFRFT = NAMIND('FRFT')
      ENDIF

C+  Drop old vertex banks

      CALL BDROP(IW,'YSVX')

C+ bank pointer

      KFRFT = IW(NFRFT)
      IF (KFRFT.EQ.0) GOTO 999

C+ find magnetic field

      FIELM = ALFIEL(DUM)
      IF (FIELM .EQ. 0) GOTO 999

C+ load primary vertex in YSVX/0

      CALL YSVX0L(IER)
      IF (IER.NE.0) GOTO 999

C+  Load the charged tracks to be used into YSTL

      CALL YSTLLD(IER)
      IF (IER.NE.0) GOTO 999

C+  Flag combinations already identified as kinks

      CALL YSKLLD(IER)
      IF (IER.NE.0) GOTO 999

C+  Load the V0s to be used into YS0L

      CALL YS0LLD(IER)
      IF (IER.NE.0) GOTO 999

C+  Load ITC tracks into YSCL

      CALL YSCLLD(IER)
      IF (IER.NE.0) GOTO 999

C+  Fit good charged tracks to the primary vertex

      CALL YSPVFT(IER)
      IF (IER.NE.0) GOTO 999

C+  Fit good pairs of tracks and/or V0 to a common vertex

      CALL YSPAIR(NPAIR,IER)
      IF (IER.NE.0) GOTO 999

C+  Merge vertices sharing tracks

      CALL YSVMRG(NPAIR,IER)
      IF (IER.NE.0) GOTO 999

C+  Try to add tracks to existing vertices

      CALL YSVTRK(IER)
      IF (IER.NE.0) GOTO 999
C
      IER = 0
 999  CONTINUE
C+  Drop some useless banks

C      JYSVX0 = NDROP('YSVX',0)
C      JYSVX1 = NDROP('YSVX',1)

C+  Put YSVX banks on the T-list

      CALL BLIST(IW,'T+','YSVX')

C+  Resize vertex banks

      CALL AUBPRS('YSVX')

C+  Drop all work banks used by this package

      IW(1) = 18
      CALL WDROP(IW,INDYSVW)

      RETURN
      END
#endif
@


1.2
log
@aleph302_8 corr. in uftkal and trddaf
@
text
@d114 2
a115 2
      JYSVX0 = NDROP('YSVX',0)
      JYSVX1 = NDROP('YSVX',1)
@


1.1
log
@aleph302 corr.file no.5 add ysv package
@
text
@d114 2
a115 2
      CALL NDROP('YSVX',0)
      CALL NDROP('YSVX',1)
@
