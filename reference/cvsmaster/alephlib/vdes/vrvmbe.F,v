head	1.1;
branch	1.1.1;
access;
symbols
	aleph316_2:1.1.1.1
	aleph316_1:1.1.1.1
	aleph316:1.1.1.1
	aleph315_7:1.1.1.1
	aleph315_6:1.1.1.1
	aleph315_5:1.1.1.1
	aleph315_4:1.1.1.1
	aleph315_3:1.1.1.1
	aleph315_2:1.1.1.1
	aleph315_1:1.1.1.1
	aleph315:1.1.1.1
	aleph314_2:1.1.1.1
	aleph314_1:1.1.1.1
	aleph314:1.1.1.1
	aleph313_1:1.1.1.1
	aleph313:1.1.1.1
	aleph312_1:1.1.1.1
	aleph312:1.1.1.1
	aleph311_1:1.1.1.1
	aleph311:1.1.1.1
	aleph310_3:1.1.1.1
	aleph310_2:1.1.1.1
	aleph310_1:1.1.1.1
	aleph310:1.1.1.1
	aleph309_1:1.1.1.1
	aleph309:1.1.1.1
	aleph308_3:1.1.1.1
	aleph308_2:1.1.1.1
	aleph308_1:1.1.1.1
	aleph308:1.1.1.1
	aleph307_6:1.1.1.1
	aleph307_5:1.1.1.1
	aleph307_4:1.1.1.1
	aleph307_2:1.1.1.1
	aleph307_1:1.1.1.1
	aleph307:1.1.1.1
	aleph306:1.1.1.1
	aleph305_4:1.1.1.1
	aleph305_3:1.1.1.1
	aleph305_2:1.1.1.1
	aleph305_1:1.1.1.1
	aleph305:1.1.1.1
	aleph304_5:1.1.1.1
	aleph304_4:1.1.1.1
	aleph304_3:1.1.1.1
	aleph304_2:1.1.1.1
	aleph304_1:1.1.1.1
	aleph304:1.1.1.1
	aleph303_3:1.1.1.1
	aleph303_2:1.1.1.1
	aleph303_1_mc1:1.1.1.1
	aleph303_1:1.1.1.1
	aleph303:1.1.1.1
	aleph302_9:1.1.1.1
	aleph302_8:1.1.1.1
	aleph302_7:1.1.1.1
	aleph302_6:1.1.1.1
	aleph302_5:1.1.1.1
	aleph302_4:1.1.1.1
	aleph302_3:1.1.1.1
	aleph302_2:1.1.1.1
	aleph302_1:1.1.1.1
	aleph302:1.1.1.1
	aleph216:1.1.1.1
	aleph215_3:1.1.1.1
	aleph215_2:1.1.1.1
	aleph215:1.1.1.1
	aleph214:1.1.1.1
	aleph213:1.1.1.1
	aleph212:1.1.1.1
	ALEPH212:1.1.1;
locks; strict;
comment	@c @;


1.1
date	96.02.07.11.44.37;	author flr;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	96.02.07.11.44.38;	author flr;	state Exp;
branches;
next	;


desc
@@



1.1
log
@Initial revision
@
text
@       SUBROUTINE VRVMBE
C ----------------------------------------------------
CKEY VDETDES INDEX / USER
C!  Read and unpack bonding error banks  VMBE
C
C - Joe Rothberg, August 1995
C
C ---------------------------------------------------------------
#ifndef DOC
      IMPLICIT NONE
C ------------------------------------------------------------
#include "vglobl.h"
#include "vduefc.h"
#include "bcs.h"
C ----------------------------------------------
      INTEGER kvuec, nfirstz, nfirstp

      INTEGER nami, kvmbe, nvmbe, ivmbe, iad
      INTEGER ivmad, ivcod, ivtemp
      INTEGER ivad1, ivad2, ivview, ivbond, ivfault, ivparam
      INTEGER ismod
C
      INTEGER ten4, ten6, ten8
      PARAMETER(ten4=10000)
      PARAMETER(ten6=10**6)
      PARAMETER(ten8=10**8)
C
      INTEGER nump, numz, nume, ix, iv, ie, j, igarb

      CHARACTER*4 bname
      INTEGER lnvmbu, ihvmbu
C number of columns
      INTEGER nvmbur
      PARAMETER (nvmbur = 6)
      INTEGER NLINK
#include "bmacrod.h"
C ------------------------------------------------------------
#include "bmacro.h"
C ------------------------------------------------------------------
C bank VMBE
      DO ismod = 1, 80
         kvmbe  = 0
         kvmbe = NLINK('VMBE',ismod)

         IF(kvmbe .GT. 0) THEN
            nvmbe = LROWS(kvmbe)
            IF(nvmbe .GT. 0) THEN

C create bank for unpacked values
              bname = 'VMBU'
              lnvmbu = nvmbe*nvmbur + 2
              CALL AUBOS(bname,ismod,lnvmbu,ihvmbu,igarb)
              IW(ihvmbu+1)= nvmbur
              IW(ihvmbu+2)= nvmbe

C------------------------------------------------
              nump = 0
              numz = 0
              nume = 0
C -----------------------------------------------
              DO  ivmbe = 1, nvmbe
                ivmad = ITABL(kvmbe,ivmbe,1)
                ivcod = ITABL(kvmbe,ivmbe,2)

C unpack code word
                ivfault = MOD(ivcod,ten6)
                ivparam = ivcod/ten6

C unpack address word
C        original bank is given in terms of electronics channels
C          starting from 0
C
               ivad2 =  MOD(ivmad,ten4)
               ivad1 =  MOD(ivmad/ten4,ten4)

               ivtemp = ivmad/ten8

               ivbond = MOD(ivtemp,10)
               ivview = 1+(ivtemp-ivbond)/10
C -------------------------------------------------------
C store unpacked values
               IF(ivview .EQ. vviewp) THEN
                  nump = nump + 1
                  ix  = nump
               ELSE IF (ivview .EQ. vviewz) THEN
                  numz = numz + 1
                  ix = numz
               ELSE
                  GOTO 990
               ENDIF

C -------------------------------------------------
C fill new bank
             nume = nume + 1
             iad = ihvmbu + 2 + (nume-1)*nvmbur
             IW(iad +1) = ivview
             IW(iad +2) = ivad1
             IW(iad +3) = ivad2
             IW(iad +4) = ivbond
             IW(iad +5) = ivfault
             IW(iad +6) = ivparam

C -------------------------------------------------

 990         CONTINUE
C loop over rows in bank
          ENDDO
C ------------------------------------------------
          ENDIF
        ENDIF
      ENDDO

      RETURN
      END
#endif
@


1.1.1.1
log
@import aleph212 from alws
@
text
@@
