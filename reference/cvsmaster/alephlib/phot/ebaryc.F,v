head	1.1;
branch	1.1.1;
access;
symbols
	aleph316_2:1.1.1.1
	aleph316_1:1.1.1.1
	aleph316:1.1.1.1
	aleph315_7:1.1.1.1
	aleph315_6:1.1.1.1
	aleph315_5:1.1.1.1
	aleph315_4:1.1.1.1
	aleph315_3:1.1.1.1
	aleph315_2:1.1.1.1
	aleph315_1:1.1.1.1
	aleph315:1.1.1.1
	aleph314_2:1.1.1.1
	aleph314_1:1.1.1.1
	aleph314:1.1.1.1
	aleph313_1:1.1.1.1
	aleph313:1.1.1.1
	aleph312_1:1.1.1.1
	aleph312:1.1.1.1
	aleph311_1:1.1.1.1
	aleph311:1.1.1.1
	aleph310_3:1.1.1.1
	aleph310_2:1.1.1.1
	aleph310_1:1.1.1.1
	aleph310:1.1.1.1
	aleph309_1:1.1.1.1
	aleph309:1.1.1.1
	aleph308_3:1.1.1.1
	aleph308_2:1.1.1.1
	aleph308_1:1.1.1.1
	aleph308:1.1.1.1
	aleph307_6:1.1.1.1
	aleph307_5:1.1.1.1
	aleph307_4:1.1.1.1
	aleph307_2:1.1.1.1
	aleph307_1:1.1.1.1
	aleph307:1.1.1.1
	aleph306:1.1.1.1
	aleph305_4:1.1.1.1
	aleph305_3:1.1.1.1
	aleph305_2:1.1.1.1
	aleph305_1:1.1.1.1
	aleph305:1.1.1.1
	aleph304_5:1.1.1.1
	aleph304_4:1.1.1.1
	aleph304_3:1.1.1.1
	aleph304_2:1.1.1.1
	aleph304_1:1.1.1.1
	aleph304:1.1.1.1
	aleph303_3:1.1.1.1
	aleph303_2:1.1.1.1
	aleph303_1_mc1:1.1.1.1
	aleph303_1:1.1.1.1
	aleph303:1.1.1.1
	aleph302_9:1.1.1.1
	aleph302_8:1.1.1.1
	aleph302_7:1.1.1.1
	aleph302_6:1.1.1.1
	aleph302_5:1.1.1.1
	aleph302_4:1.1.1.1
	aleph302_3:1.1.1.1
	aleph302_2:1.1.1.1
	aleph302_1:1.1.1.1
	aleph302:1.1.1.1
	aleph216:1.1.1.1
	aleph215_3:1.1.1.1
	aleph215_2:1.1.1.1
	aleph215:1.1.1.1
	aleph214:1.1.1.1
	aleph213:1.1.1.1
	aleph212:1.1.1.1
	ALEPH212:1.1.1;
locks; strict;
comment	@c @;


1.1
date	96.02.07.11.42.47;	author flr;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	96.02.07.11.42.48;	author flr;	state Exp;
branches;
next	;


desc
@@



1.1
log
@Initial revision
@
text
@      SUBROUTINE EBARYC( NUST,INDX,ESTO,IKOD,BARY )
C ----------------------------------------------------
C   AUTHOR   : J. Badier     05/10/89
C! Barycenter calculation.
CKEY PHOTONS BARYCENTER / INTERNAL
C
C   The storeys are weighted with the raw signal.
C
C   Input     : NUST    Number of storeys of the cluster ICLN.
C               INDX(1,IST) Theta index of the storey IST.
C               INDX(2,IST) Phi index of the storey IST.
C               INDX(3,IST) Stack number of the storey IST.
C               ESTO(IST)   Raw content of the storey IST.
C                           IST = 1 , NUST
C
C   Output    : IKOD(9)
C               1   Theta index of the barycenter tower.
C               2   Phi index of the barycenter tower.
C               3   Subcomponent number( 1 to 3 ).
C               4   Module number( 1 to 12 ).
C               5   Region number( 1 to 4 ).
C               6   1 or 2 if limit of region.
C               7   1 if endcap crack in the overlap.
C               8   1 , 2 , 3 or 4 if near a crack.
C               9   1 to 6:barrel/endcap overlap, 7:endcap/luminometer.
C
C               BARY(1) Theta of the barycenter in radians.
C               BARY(2) Phi of the barycenter in radians.
C
C
C   BANKS :
C     INPUT   : NONE
C     OUTPUT  : NONE
C
C ----------------------------------------------------
#ifndef DOC
      SAVE
      DIMENSION INDX(3,*) , ESTO(*) , BARY(*) , IKOD(*)
      DIMENSION CENT(3) , EBAR(3)
#include "alcons.h"
C   Initialisation
      EBAR(1) = 0.
      EBAR(2) = 0.
      EBAR(3) = 0.
C   Loop over storeys.
      DO 1 IST = 1 , NUST
C   Storey barycenter.
        CALL ESRBC('ALEPH',INDX(1,IST),INDX(2,IST),INDX(3,IST),CENT)
        DO 2 J = 1 , 3
C   Weighted sum.
          EBAR(J) = EBAR(J) + ESTO(IST) * CENT(J)
    2   CONTINUE
    1 CONTINUE
C   Cluster barycenter direction.
      RD = SQRT( EBAR(1)**2 + EBAR(2)**2 )
C   Polar angle.
      BARY(1) = ATAN2( RD , EBAR(3) )
C   Azimuth.
      BARY(2) = ATAN2( EBAR(2) , EBAR(1) )
      IF( BARY(2) .LT. 0. ) BARY(2) = BARY(2) + TWOPI
C   Central tower region code.
      CALL EBCDRG(BARY(1),BARY(2),IKOD(1),IKOD(2),IKOD(6),IKOD(3),IER)
      IF( IER .NE. 0 ) IKOD(1) = 0
      RETURN
      END
#endif
@


1.1.1.1
log
@import aleph212 from alws
@
text
@@
