      SUBROUTINE LUPAIN
C----------------------------------------------------------------------
C! LUPA initialization
C!
C!    Author:     H. Meinhard       14-Mar-1990
C!    Modified:   M. Cattaneo       06-Nov-1997
C!                Suppress filling of x1namc COMMON due to clash with
C!                Alephlib in definition of same common
C!
C!    Description
C!    ===========
C!    Fill common LUPACM
C----------------------------------------------------------------------
#ifndef DOC
#include "bcs.h"
#include "lupacm.h"
      INTEGER IMAP(16,15)
      REAL SCX(16,15)
#include "bosext.h"
      DATA IMAP/  0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
     &            1, 1, 1, 3, 3, 3, 3, 1, 1, 1, 0, 0, 0, 0, 0, 0,
     &            1, 3, 3, 3, 3, 3, 3, 3, 3, 1, 1, 0, 0, 0, 0, 0,
     &            1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1, 1, 0, 0, 0, 0,
     &            1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1, 1, 0, 0, 0,
     &            1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1, 0, 0, 0,
     &            1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1, 1, 0, 0,
     &            1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1, 1, 0,
     &            1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1, 0,
     &            1, 1, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1, 0,
     &            0, 1, 1, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1, 1,
     &            0, 0, 1, 1, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1,
     &            0, 0, 0, 1, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1,
     &            0, 0, 0, 1, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1,
     &            0, 0, 0, 1, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 1/
      DATA SCX /
     &  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
     &  0., 0., 1., 1., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0., 0., 0.,
     &  1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 0., 0., 0., 0., 0., 0.,
     &  1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 0., 0., 0., 0., 0.,
     &  1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 0., 0., 0., 0.,
     &  1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 0., 0., 0.,
     &  1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 0., 0., 0.,
     &  1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 0., 0.,
     &  1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 0.,
     &  0., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 0.,
     &  0., 0., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 0.,
     &  0., 0., 0., 0., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 0.,
     &  0., 0., 0., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 0.,
     &  0., 0., 0., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 0.,
     &  0., 0., 0., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 0./
C----------------------------------------------------------------------
      CALL VZERO(ACPTLU,NMET)
      DO 320 I=1,NM
        DO 310 J=1,NR
          IF(J.GT.15) THEN
            IY=1
            NY=J-15
            NJ=31-J
          ELSE
            IY=2
            NY=16-J
            NJ=J
          ENDIF
          DO 300 K=1,NC
            IF(MOD(I,2).EQ.0) THEN
              ISTOLU(I,J,K)=IMAP(K,NJ)
              ISCALU(I,J,K)=NINT(100.*SCX(K,NJ))
            ELSE
              ISTOLU(I,J,K)=IMAP(17-K,NJ)
              ISCALU(I,J,K)=NINT(100.*SCX(17-K,NJ))
            ENDIF
  300     CONTINUE
  310   CONTINUE
  320 CONTINUE
      END
#endif
