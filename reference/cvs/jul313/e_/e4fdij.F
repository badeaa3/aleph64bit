      SUBROUTINE E4FDIJ
C----------------------------------------------------------------------
C!  - R2 ESTIMATOR GIVE I J K FOR 3X4 STOREYS CENTERED ON TRACK EXTRAPOL
C!
C!    AUTHOR  : D. PALLIN
C!    MODIFIED:
C!
C!
C!
C?
C!======================================================================
#ifndef DOC
#include "e4com0.h"
#include "e4com1.h"
#include "rlunit.h"
#include "rflags.h"
#include "rparac.h"
      COMMON/EIJDEU/ICOL1,ICOL2,ICOL3,ICOL4,JROW1,JROW2,JROW3,JROW4
      DIMENSION X1(3)
      CHARACTER*23 WRONG
      INTEGER DUMMY
C
      NT=NTOW(ITRCL)/2
      DO 1 KJ=1,NT
      X1(1)=XTOW(ITRCL,2*KJ-1,1)+(XTOW(ITRCL,2*KJ,1)
     &-XTOW(ITRCL,2*KJ-1,1))/2.
      X1(2)=XTOW(ITRCL,2*KJ-1,2)+(XTOW(ITRCL,2*KJ,2)
     &-XTOW(ITRCL,2*KJ-1,2))/2.
      X1(3)=XTOW(ITRCL,2*KJ-1,3)+(XTOW(ITRCL,2*KJ,3)
     &-XTOW(ITRCL,2*KJ-1,3))/2.
      CALL EFNCRS(X1,ROWJ,COLI,STK,WRONG)
      KSS=INT(STK)
C
C
C
      IBAR=0
      CALL E4DEIJ(IFLAG,IBAR,COLI,ROWJ)

C
CXXXXXXXXXXXXXXX
C
C   WE KEPT SELECTED STOREYS
      IF(JDBDRF(JULEC).GT.8)
     & WRITE(LDEBRL,*)'E4FDIJ I J K W',COLI,ROWJ,STK,WRONG
CXX IFLAG GIVE THE COMBINATION TO CONSIDERED
CXX FLAG=0 (I1,J1)(I1,J2)(I2,J1)(I2,J2)               NORMAL
CXX      1 IDEM FALG 0 +(I3,J3)(I3,J4)(I4,J3)(I4,J4)  OVERLAP
CXX      2 (I3,J1)(I3,J2)(I4,J3)(I4,J4)               REGIONS LIMITS
CXX      3 (I3,J1)(I3,J2)(I3,J5)(I4,J3)    PATHOLOGICAL LIMIT R1-R2
C
      IF(IFLAG.EQ.0)THEN
      IF(JDBDRF(JULEC).GT.7)
     &WRITE(LDEBRL,10)ICOL1,JROW1,ICOL1,JROW2,ICOL2,JROW1,ICOL2,JROW2
      CALL E4GTST(ICOL1,ICOL2,JROW1,JROW2,KSS)
      ENDIF
      IF(IFLAG.EQ.2)THEN
      IF(JDBDRF(JULEC).GT.7)
     &WRITE(LDEBRL,10)ICOL3,JROW1,ICOL3,JROW2,ICOL4,JROW3,ICOL4,JROW4
      CALL E4GTST(ICOL3,DUMMY,JROW1,JROW2,KSS)
      CALL E4GTST(ICOL4,DUMMY,JROW3,JROW4,KSS)
      ENDIF
      IF(IFLAG.EQ.3)THEN
      IF(JDBDRF(JULEC).GT.7)
     &WRITE(LDEBRL,10)ICOL3,JROW1,ICOL3,JROW2,ICOL3,JROW4,ICOL4,JROW3
      CALL E4GTST(ICOL3,DUMMY,JROW1,JROW2,KSS)
      CALL E4GTST(ICOL3,DUMMY,JROW4,DUMMY,KSS)
      CALL E4GTST(ICOL4,DUMMY,JROW3,DUMMY,KSS)
      ENDIF
 1    CONTINUE
 10   FORMAT(1X,4('(',I3,1X,I3,')'))
      RETURN
      END
#endif
