      SUBROUTINE TPPADD(PRIAD,ISLOT,IERR)
C-------------------------------------------------------------------------
C!Kludge function to give TPP primary address - sector number correspondence
C!WARNING: this routine depends on the hardware setup, which is not
C!         expected to change (but changes cannot be ruled out).  It
C!         is only used offline to interpret the TERR bank, which for
C!         some perverse reason gives us the fastbus address instead of
C!         the sector number.  Called by TCPTST.
C INPUT :
C   PRIAD - integer containing the fastbus primary address of the TPP
C OUTPUT :
C   ISLOT - sector number of the TPP
C   IERR - error flag. = 1 if address error problem detected.
C?
C!======================================================================
#ifndef DOC
C
      INTEGER PRIAD,ISLOT,IERR,NSECT
      PARAMETER (NSECT=36)
      LOGICAL FIRST
      INTEGER PADDR(NSECT),WADDR(NSECT)
      INTEGER IPADR(32,NSECT),IWADR(32,NSECT)
      DATA FIRST / .TRUE. /
      DATA (IPADR(K,1),K=1,32)
     &/0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,1,0/
      DATA (IPADR(K,2), K=1,32)
     &/1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,1,0/
      DATA (IPADR(K,3), K=1,32)
     &/0,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,1,0/
      DATA (IPADR(K,4), K=1,32)
     &/0,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,1,0/
      DATA (IPADR(K,5), K=1,32)
     &/1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,1,0/
      DATA (IPADR(K,6), K=1,32)
     &/0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,1,0/
      DATA (IPADR(K,7), K=1,32)
     &/0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,1,0/
      DATA (IPADR(K,8), K=1,32)
     &/1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,1,0/
      DATA (IPADR(K,9), K=1,32)
     &/1,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,1,0/
      DATA (IPADR(K,10), K=1,32)
     &/0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,1,0/
      DATA (IPADR(K,11), K=1,32)
     &/0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,1,0/
      DATA (IPADR(K,12), K=1,32)
     &/1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,1,0/
      DATA (IPADR(K,13), K=1,32)
     &/0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,1,0/
      DATA (IPADR(K,14), K=1,32)
     &/1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,1,0/
      DATA (IPADR(K,15), K=1,32)
     &/1,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,1,0/
      DATA (IPADR(K,16), K=1,32)
     &/0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,1,0/
      DATA (IPADR(K,17), K=1,32)
     &/0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,1,0/
      DATA (IPADR(K,18), K=1,32)
     &/1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,1,0/
      DATA (IPADR(K,19), K=1,32)
     &/0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,0,1/
      DATA (IPADR(K,20), K=1,32)
     &/1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,0,1/
      DATA (IPADR(K,21), K=1,32)
     &/0,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,0,1/
      DATA (IPADR(K,22), K=1,32)
     &/0,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1/
      DATA (IPADR(K,23), K=1,32)
     &/1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1/
      DATA (IPADR(K,24), K=1,32)
     &/0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1/
      DATA (IPADR(K,25), K=1,32)
     &/0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,0,1/
      DATA (IPADR(K,26), K=1,32)
     &/1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,0,1/
      DATA (IPADR(K,27), K=1,32)
     &/1,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,0,1/
      DATA (IPADR(K,28), K=1,32)
     &/0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,0,1/
      DATA (IPADR(K,29), K=1,32)
     &/0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,0,1/
      DATA (IPADR(K,30), K=1,32)
     &/1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,0,1/
      DATA (IPADR(K,31), K=1,32)
     &/0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1/
      DATA (IPADR(K,32), K=1,32)
     &/1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1/
      DATA (IPADR(K,33), K=1,32)
     &/1,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1/
      DATA (IPADR(K,34), K=1,32)
     &/0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1/
      DATA (IPADR(K,35), K=1,32)
     &/0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1/
      DATA (IPADR(K,36), K=1,32)
     &/1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1/
      DATA (IWADR(K,1), K=1,32)
     &/1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,1,0/
      DATA (IWADR(K,2), K=1,32)
     &/0,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,1,0/
      DATA (IWADR(K,3), K=1,32)
     &/1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,1,0/
      DATA (IWADR(K,4), K=1,32)
     &/1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,1,0/
      DATA (IWADR(K,5), K=1,32)
     &/0,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,1,0/
      DATA (IWADR(K,6), K=1,32)
     &/1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,1,0/
      DATA (IWADR(K,7), K=1,32)
     &/1,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,1,0/
      DATA (IWADR(K,8), K=1,32)
     &/0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,1,0/
      DATA (IWADR(K,9), K=1,32)
     &/0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,1,0/
      DATA (IWADR(K,10), K=1,32)
     &/1,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,1,0/
      DATA (IWADR(K,11), K=1,32)
     &/1,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,1,0/
      DATA (IWADR(K,12), K=1,32)
     &/0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,1,0/
      DATA (IWADR(K,13), K=1,32)
     &/1,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,1,0/
      DATA (IWADR(K,14), K=1,32)
     &/0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,1,0/
      DATA (IWADR(K,15), K=1,32)
     &/0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,1,0/
      DATA (IWADR(K,16), K=1,32)
     &/1,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,1,0/
      DATA (IWADR(K,17), K=1,32)
     &/1,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,1,0/
      DATA (IWADR(K,18), K=1,32)
     &/0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,1,0/
      DATA (IWADR(K,19), K=1,32)
     &/1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,0,1/
      DATA (IWADR(K,20), K=1,32)
     &/0,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,0,1/
      DATA (IWADR(K,21), K=1,32)
     &/1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,0,1/
      DATA (IWADR(K,22), K=1,32)
     &/1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1/
      DATA (IWADR(K,23), K=1,32)
     &/0,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1/
      DATA (IWADR(K,24), K=1,32)
     &/1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1/
      DATA (IWADR(K,25), K=1,32)
     &/1,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,0,1/
      DATA (IWADR(K,26), K=1,32)
     &/0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,0,1/
      DATA (IWADR(K,27), K=1,32)
     &/0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,0,1/
      DATA (IWADR(K,28), K=1,32)
     &/1,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,0,1/
      DATA (IWADR(K,29), K=1,32)
     &/1,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,0,1/
      DATA (IWADR(K,30), K=1,32)
     &/0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,0,1/
      DATA (IWADR(K,31), K=1,32)
     &/1,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1/
      DATA (IWADR(K,32), K=1,32)
     &/0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1/
      DATA (IWADR(K,33), K=1,32)
     &/0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1/
      DATA (IWADR(K,34), K=1,32)
     &/1,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1/
      DATA (IWADR(K,35), K=1,32)
     &/1,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1/
      DATA (IWADR(K,36), K=1,32)
     &/0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1/
C--- ELN 02/09/92 just to remember
C      DATA PADDR/ Z73000010, Z73000011, Z73000016,
C     &             Z63000016, Z63000011, Z63000010,
C     & Z7300000E, Z7300000F, Z73000013, Z73000012,
C     & Z73000014, Z73000015,
C     & Z63000014, Z63000015, Z63000013, Z63000012,
C     & Z6300000E, Z6300000F,
C     &            Z93000010, Z93000011, Z93000016,
C     &            Z83000016, Z83000011, Z83000010,
C     & Z9300000E, Z9300000F, Z93000013, Z93000012,
C     & Z93000014, Z93000015,
C     & Z83000014, Z83000015, Z83000013, Z83000012,
C     & Z8300000E, Z8300000F/
C      DATA WADDR/ Z73000019, Z7300001A, Z7300001F,
C     &              Z6300001F, Z6300001A, Z63000019,
C     & Z73000017, Z73000018, Z7300001C, Z7300001B,
C     & Z7300001D, Z7300001E,
C     & Z6300001D, Z6300001E, Z6300001C, Z6300001B,
C     & Z63000017, Z63000018,
C     &              Z93000019, Z9300001A, Z9300001F,
C     &              Z8300001F, Z8300001A, Z83000019,
C     & Z93000017, Z93000018, Z9300001C, Z9300001B,
C     & Z9300001D, Z9300001E,
C     & Z8300001D, Z8300001E, Z8300001C, Z8300001B,
C     & Z83000017, Z83000018/
C--- ELN 02/09/92 just to remember
C -----------------------------------------------------------------
      DO IS =  1, NSECT
        PADDR (IS) = 0
        WADDR (IS) = 0
        DO IB =  1, 32
          IF ( IPADR(IB,IS).GT.0 )
     &      PADDR (IS) = IBSET (PADDR(IS),IB-1)
          IF ( IWADR(IB,IS).GT.0 )
     &      WADDR (IS) = IBSET (WADDR(IS),IB-1)
        ENDDO
      ENDDO
C
C First test address to see if it is a pad TPP
C
      IERR=0
      DO 10 ISLOT = 1, NSECT
         IF (PRIAD.EQ.PADDR(ISLOT))  RETURN
   10 CONTINUE
C
C It is not a pad TPP.
C Test address to see which wire TPP it is.
C
      DO 20 ISLOT = 1, NSECT
         IF (PRIAD.EQ.WADDR(ISLOT))  RETURN
   20 CONTINUE
C
C The address is not in out list if we are here.  Set error flag.
C
      IERR = 1
C
      END
#endif
