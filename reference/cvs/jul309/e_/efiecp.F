      SUBROUTINE EFIECP
C---------------------------------------------------------------------
C!  COMPUTES THE POSITION OF SENSITIVE PLANES HIT (IN X0 UNIT)
C!
C!  AUTHOR: A. FALVARD
C!  MODIFIED :
C!
C?
C!======================================================================
#ifndef DOC
#include "ecmode.h"
C
C  FILL ECBAPL: POSITIONS OF SENSITIVE PLANS IN THE ECAL BARREL
C  IN X0 UNITS.
C  INPUT BARREL BEGINS BY A LEAD SHEET
C
#include "bcs.h"
C
      IGALEF=0
      IGAL=IW(NAMIND('AJOB'))
      IF(IGAL.NE.0)IGALEF=1
      ECBAPL(1)=0.2+0.382
      IF(IGALEF.EQ.1)ECBAPL(1)=ECBAPL(1)-0.1-0.21
      DO 1 I=2,LECMOD
      IF(I.LT.11)ECBAPL(I)=ECBAPL(I-1)+0.382
      IF(I.EQ.11)ECBAPL(I)=ECBAPL(I-1)+0.027+0.382
      IF(I.GT.11.AND.I.LT.34)ECBAPL(I)=ECBAPL(I-1)+0.382
      IF(I.EQ.34)ECBAPL(I)=ECBAPL(I-1)+0.027+0.739
      IF(I.GT.34)ECBAPL(I)=ECBAPL(I-1)+0.739
 1    CONTINUE
C
C  FILL  ECENPL: POSITIONS OF SENSITIVE PLANS IN THE ECAL-END CAP.
C  TPC END PLATE IN NOT INCLUDED SINCE IT DOESN'T COVER THE
C  SURFACE OF ALL THE DETECTOR (OVERLAP).
C
      ECENPL(1)=0.2
      ECENPL(1)=ECENPL(1)+0.7
      IF(IGALEF.EQ.1)ECENPL(1)=ECENPL(1)-0.4-0.35
      DO 2 I=2,LECMOD
      IF(I.LT.11)ECENPL(I)=ECENPL(I-1)+0.396
      IF(I.EQ.11)ECENPL(I)=ECENPL(I-1)+0.056+0.396
      IF(I.GT.11.AND.I.LT.34)ECENPL(I)=ECENPL(I-1)+0.396
      IF(I.EQ.34)ECENPL(I)=ECENPL(I-1)+0.056+0.753
      IF(I.GT.34)ECENPL(I)=ECENPL(I-1)+0.753
 2    CONTINUE
      RETURN
      END
#endif
