      SUBROUTINE ECTOPO(IT)
C---------------------------------------------------------------------
C!    LOOKS FOR THE ECAL REGION WHERE IS THE CHARGED CLUSTER
C!
C!    AUTHOR : A. FALVARD
C!    MODIFIED:
C?
C!======================================================================
#ifndef DOC
#include "e4com1.h"
#include "etopos.h"
#include "esubco.h"
      DIMENSION POINT(3)
      INTEGER EFNDMD
      EXTERNAL EFNDMD
C  ONE LOOKS FOR THE REGION WHERE THE SHOWER IS:
C  (BARREL=.TRUE. ; ENDCAP=TRUE ; OVERLR=.TRUE. ; OVERLD=.TRUE.;
C   CRACKR=.TRUE.; CRACKD=.TRUE.)
C
      BARREL=.TRUE.
      ENDCAP=.TRUE.
      OVERLR=.TRUE.
      OVERLD=.FALSE.
      CRACKR=.FALSE.
      CRACKD=.FALSE.
      NCRACK=0
      DO 1 I=1,NBE4ST(IT)
      ISUBCO(I)=2
      IF(ISTO(IT,I).LE.50)ISUBCO(I)=1
      IF(ISTO(IT,I).GE.179)ISUBCO(I)=3
      CALL ESRPT('ALEPH',FLOAT(ISTO(IT,I)),FLOAT(JSTO(IT,I)),
     *FLOAT(KSTO(IT,I)),POINT)
      IMODUL(I)=EFNDMD(ISUBCO(I),POINT)
      IF(ISUBCO(I).NE.2)BARREL=.FALSE.
      IF(ISUBCO(I).EQ.2)ENDCAP=.FALSE.
C
C  LOOKING FOR OVERLAP REGION
C
       IF(ISTO(IT,I).GE.46.AND.ISTO(IT,I).LE.55
     *.OR.ISTO(IT,I).GE.174.AND.ISTO(IT,I).LE.183)OVERLD=.TRUE.
C
C ROUGH CRACK FINDING
C
      IF(I.EQ.1)GOTO 2
      IF(ISUBCO(I).EQ.ISUBCO(I-1).AND.IMODUL(I).NE.IMODUL(I-1))CRACKR
     *=.TRUE.
 2    CONTINUE
C
C DETAILED CRACK FINDING
C
      IF(ISUBCO(I).EQ.2)MODULO=32
C  ZONES IN POSITIVE END-CAP
      IF(ISUBCO(I).EQ.1.AND.ISTO(IT,I).LE.50)MODULO=32
      IF(ISUBCO(I).EQ.1.AND.ISTO(IT,I).LE.40)MODULO=24
      IF(ISUBCO(I).EQ.1.AND.ISTO(IT,I).LE.24)MODULO=16
      IF(ISUBCO(I).EQ.1.AND.ISTO(IT,I).LE.8)MODULO=8
C  ZONES IN NEGATIVE END-CAP
      IF(ISUBCO(I).EQ.3.AND.ISTO(IT,I).GE.179)MODULO=32
      IF(ISUBCO(I).EQ.3.AND.ISTO(IT,I).GE.189)MODULO=24
      IF(ISUBCO(I).EQ.3.AND.ISTO(IT,I).GE.205)MODULO=16
      IF(ISUBCO(I).EQ.3.AND.ISTO(IT,I).GE.221)MODULO=8
      IOFF=0
      IF(ISTO(IT,I).LE.50.OR.ISTO(IT,I).GE.179)IOFF=2
      IF(ISTO(IT,I).LE.24.OR.ISTO(IT,I).GE.189)IOFF=1
      ISST=ISTO(IT,I)-IOFF
      IF(ISST.LE.0)ISST=384+ISST
C********************  WARNING*****************************
C  HAS TO BE DEFINED MORE PRECISELY
C**********************************************************
      IF(MOD(ISST,MODULO).EQ.0.OR.MOD(ISST
     *,MODULO).EQ.1)NCRACK=NCRACK+1
 1    CONTINUE
      IF(NCRACK.GT.1)CRACKD=.TRUE.
      BARB=.NOT.BARREL
      ENDB=.NOT.ENDCAP
      OVERLR=BARB.AND.ENDB
      RETURN
      END
#endif
