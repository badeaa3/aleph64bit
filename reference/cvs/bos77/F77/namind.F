      FUNCTION NAMIND(NAME)
#include "boscom.h"
#include "param.h"
#include "mparam.h"
#include "namcha.h"
      IF(IW(ICK).NE.12345) CALL BBNOT(IW,'NAMIND')
   10 NWNAM=IW(IDNAM)
      IW(IDNAM)=NAMA
C
C     CALCULATE HASH INDEX FROM NAME
C
      INAM=IW(IDNAM-2)+MOD(IABS(NAMA),NPRIM)-3
    1 JNAM=INAM
      INAM=IW(IDPTR+INAM)
C
C     COMPARE WITH ENTRY IN BANK OF NAMES
C
      IF(IW(IDNAM+INAM).NE.NAMA) GOTO 1
      IW(IDNAM)=NWNAM
      IF(INAM.EQ.0) THEN
C
C        ADD NEW ENTRY INTO BANK OF NAMES
C
         IF(NWNAM+4.GE.IW(IDNAM-2)) THEN
C
C           TOO MANY NAMES USED
C
            NUSED=IW(IDNAM-2)-4
            IF(IW(LUP).NE.0) THEN
               WRITE(IW(LUP),1001)
               CALL BBUFM(IW(IDNAM+1),1,NUSED,IW(LUP))
            END IF
            CALL BABEND('NAMIND')
         END IF
         INAM=NWNAM+1
         IW(IDNAM)=INAM
         IW(IDNAM+INAM)=NAMA
         IW(IDPTR+JNAM)=INAM
      END IF
      NAMIND=INAM+NSYST
      IW(1)=0
      IW(2)=0
      GOTO 100
C
C
C
      ENTRY NAMINC(NAMAA)
      NAMA=NAMAA
      GOTO 10
  100 RETURN
 1001 FORMAT('BOS++NAMIND+  TOO MANY DIFFFERENT NAMES USED - STOP'/
     +14X,'USER RESPONSE: CALL BNAMES(NMAX) BEFORE INITIALIZATION',
     2  ' FOR A MAXIMUM OF NMAX DIFFERENT NAMES'/
     3  14X,'LIST OF ALL USED NAMES FOLLOWS'/)
      END
